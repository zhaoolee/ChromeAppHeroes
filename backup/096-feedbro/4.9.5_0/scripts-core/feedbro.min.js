var feedbro=feedbro||{};feedbro.ActionHandler=function(){var f=new feedbro.Strings();var a;var c;var b;var d=[];this.setSoundPlayer=function(g){a=g};this.setNotifications=function(g){b=g};this.setBackground=function(g){c=g};this.init=function(){};function e(){if(d.length>0){var g=d.shift();$.ajax({type:"POST",url:g.url,data:g.postData,timeout:(30*1000),processData:false,cache:false,contentType:"application/json; charset=UTF-8",error:function(i,h,j){feedbro.log(g.type+" remote call FAILED with URL: "+g.url+" for "+g.link+" HTTP Status: "+h)}})}}this.processActions=function(r,l,n,o){var q,g,m,s=false,j={},h;if(o==undefined){o={}}for(m=0;m<l.length;m++){var k=l[m];q=k.type;g=(j[q]==1);if(o[q]){continue}if(q==1&&!g){if(b!=undefined){s=true}}else{if(q==2&&!g){if(n!=undefined){n.css({display:"none"});n.removeClass("entry item")}c.markUnread(r.id,0)}else{if(q==3&&!g){if(n!=undefined){n.css({display:"none"});n.removeClass("entry item")}c.markUnread(r.id,0);c.markDeleted(r.id,1)}else{if(q==4&&!g){if(r.starred!=1){r.starred=1;c.setItemStarred(r.id,1)}}else{if(q==5&&!g){if(r.unread!=0){r.unread=0;c.markUnread(r.id,0)}}else{if(q==6&&!g){a.queue("sound/"+k.value)}else{if(q==7&&!g){if(n!=undefined){n.css({"border-left":"2px solid "+k.value})}}else{if(q==8){if(n!=undefined&&k.value!=undefined&&k.value!=""){try{f.highlightItemContent(r,k.value,"highlight-text")}catch(p){feedbro.log("highlight text with regexp failed",p)}}}else{if(q==9){if(k.value!=undefined&&k.value!=""){c.addTag(r.id,k.value)}}else{if(q==11){h=JSON.stringify({value1:r.link,value2:r.title,value3:r.author});d.push({url:k.value+"",postData:h,link:r.link+"",type:"IFTTT"});e()}else{if(q==12){var t=parseInt(k.value,10);if(!isNaN(t)){c.addPoints(r.id,t)}}else{if(q==13&&!g){a.queue(k.value)}else{if(q==15&&!g){h=JSON.stringify({content:r.title+": "+r.link});d.push({url:k.value+"",postData:h,link:r.link+"",type:"Discord"});e()}else{if(q==16&&!g){h=JSON.stringify({username:"Feedbro",text:r.title+": "+r.link});d.push({url:k.value+"",postData:h,link:r.link+"",type:"Slack"});e()}}}}}}}}}}}}}}j[q]=1}if(s){b.createItemNotification(r)}}};var feedbro=feedbro||{};feedbro.Background=function(){var n;var g=[];var o=new feedbro.FeedTree();var S=new feedbro.Settings();var p=new feedbro.FeedEntryManager("feedbro");var C;var i=new Date().getTime();var G=new Date().getTime();var l=this;var R=new feedbro.RuleEngine();var D=new feedbro.Notifications();var t=new feedbro.SoundPlayer();var k=new feedbro.ActionHandler();var d;var u;var X=-1;var T;var e;var v=false;var c="id";var y="license";var V="https://cloud.nodetics.com/shop/validate.php";var O="https://cloud.nodetics.com/shop/feedbro/";var U=new feedbro.Strings();var J=false;var h=14*24*60*60*1000;var Y;function x(aa,Z){if(!J){return}if(Z){console.log(aa,Z)}else{console.log(aa)}}function P(Z){return new feedbro.FeedParser(Z)}this.engineUnload=function(){console.log("Engine unload!")};this.installLocale=function(aa,Z,ab){Locale.download(aa,function(ac){l.getSettings().setLocaleMeta(ac.meta);l.getSettings().setLocale("custom");l.saveSettings();Locale.locales.custom=ac;Locale.selectLocale("custom");feedbro.Persistence.saveValue("locale",ac,function(){console.log("Saved custom locale");Z(200)})},ab)};this.selectLocale=function(Z){Locale.selectLocale(Z);l.getSettings().setLocale(Z);l.saveSettings()};this.getDefaultLocaleMap=function(){return Locale.defaultLocale};this.getActiveLocaleMap=function(){return Locale.activeMap};this.getFeedQueue=function(){return g};this.getFeedEntryManagerErrorStatus=function(){return p.getErrorStatus()};this.setDebugMode=function(Z){J=Z};this.getDbIndex=function(){return p.getDbIndex()};this.setLastFolderId=function(Z){u=Z};this.getLastFolderId=function(){return u};this.debug=function(aa,Z){x(aa,Z)};this.getSettings=function(){return S};this.getFeedEntries=function(){return n};this.getFeedTree=function(){return o};this.getNotificationEngine=function(){return D};this.terminate=function(){if(C){clearInterval(C);x("unreadScan terminated")}};this.getEntry=function(Z){p.getEntry(Z,function(aa){console.log(JSON.stringify(aa))})};this.clearAll=function(Z){g=[];p.clear(Z);o=new feedbro.FeedTree();l.notifyEngine("reloaddata");l.invalidateTagCloudCache();this.updateTotalUnread();this.saveData()};this.setFeedScanInterval=function(Z){if(C){clearInterval(C)}console.log("setFeedScanInterval: "+Z+" s");C=setInterval(l.scanUnread,Z*1000);setTimeout(l.scanUnread,2*1000)};function I(ae,ad){if(S.getDisableAutoScan()==true){return false}var aa=new Date().getTime();var Z=l.getFeedScanDelay(ae.data.id);var ac=!ae.data.lastupdate;var ab=(aa-ae.data.lastupdate)>Z;var ag=(ae.data.status==398||ae.data.status==403);var af=((aa-ae.data.lastupdate)>(1*60*1000));return(ae.data.type==feedbro.FeedTree.FEED&&(ac||ab||(ag&&af)))}this.escapeHtml=function(Z){return Z?Z.replace(/[&<>"'`]/g,function(aa){return"&#"+aa.charCodeAt(0)+";"}):Z};function Q(ad){var ae=ad.htmlUrl?' htmlUrl="'+ad.htmlUrl.replace(/&/g,"&amp;").replace(/"/g,"%22")+'"':"";var ac=ad.url?ad.url.replace(/&/g,"&amp;").replace(/"/g,"%22"):"";var Z=ad.maxitems?' maxItems="'+ad.maxitems+'"':"";var ab=ad.entrycontent&&ad.entrycontent!=1?' entryContent="'+ad.entrycontent+'"':"";var aa=ad.scandelay?' scanDelay="'+ad.scandelay+'"':"";return'      <outline text="'+l.escapeHtml(ad.name)+'" title="'+l.escapeHtml(ad.realname||ad.name)+'" type="rss" \n            xmlUrl="'+ac+'"'+ae+Z+ab+aa+"/>\n"}this.exportOpml=function(){var Z='<?xml version="1.0" encoding="UTF-8"?>\n<opml version="1.0">\n<head>\n<title>Feed Subscriptions</title>\n</head>\n<body>\n';o.processNodes(o.getRoot(),function aa(ac,ae){var ab,ad=ac.data;if(ad.type==feedbro.FeedTree.FOLDER){Z+='  <outline title="'+l.escapeHtml(ad.name)+'" text="'+l.escapeHtml(ad.name)+'">\n';for(ab=0;ab<ac.children.length;ab++){Z+=Q(ac.children[ab].data)}Z+="  </outline>\n"}else{if(ad.type==feedbro.FeedTree.FEED){Z+=Q(ad)}else{console.log("exportOpml: Unidentified node type: "+ad.type)}}},feedbro.FeedTree.MODE_TOPNODES);Z+="</body>\n</opml>";return Z};this.getTreeData=function(){return o.getData()};this.getFolderUnreadCount=function(ad){var ac=o.getNode(ad);var ab=ac.children;var Z=0;var aa;for(aa=0;aa<ab.length;aa++){if(ab[aa].data.purge!=1){Z+=ab[aa].data.unread}}ac.data.unread=Z;return Z};this.moveNode=function(ae,ab,aa){var af;if(aa=="before"){af=feedbro.FeedTree.BEFORE}else{if(aa=="after"){af=feedbro.FeedTree.AFTER}else{if(aa=="inside"){af=feedbro.FeedTree.INSIDE_FIRST}else{if(aa=="inside-last"){af=feedbro.FeedTree.INSIDE_LAST}else{x("moveNode: Invalid position for move: "+aa)}}}}var Z=o.getNode(ae);var ad=o.getNode(ab);o.moveNode(Z,ad!==undefined?ad:o.getRoot(),af);if(Z.data.type==1){var ac=Z.parent.data?Z.parent.data.id:-1;p.moveFeed(Z.data.id,ac)}};function a(Z){var aa=Z>=10000?9999:Z;chrome.browserAction.setBadgeText({text:aa>0?String(aa):""})}this.updateTotalUnread=function(){var Z=0;o.processNodes(o.getRoot(),function(aa){if(aa.data.type==feedbro.FeedTree.FEED&&aa.data.purge!=1){Z+=aa.data.unread}},feedbro.FeedTree.MODE_DEPTHFIRST);a(Z)};this.getFolders=function(){var Z=[];o.processNodes(o.getRoot(),function(aa){if(aa.data.type==feedbro.FeedTree.FOLDER){Z.push(aa.data)}},feedbro.FeedTree.MODE_TOPNODES);return Z};this.addFeed=function(ab,aa,ae,Z){if(!aa){aa=ae}var af={url:ab,realname:ae,name:aa,lastread:0,lastupdate:0,unread:0,type:feedbro.FeedTree.FEED};var ad=o.getNode(Z);var ac=o.addNode(af,ad);return ac.data.id};this.getFeedMaxItems=function(Z){var aa=o.getNode(Z);var ab=0;if(aa&&aa.data.maxitems){ab=aa.data.maxitems}return ab>0?ab:S.getFeedMaxEntries()};this.getFeedScanDelay=function(Z){var ab=o.getNode(Z);var aa;if(ab&&ab.data.scandelay){aa=ab.data.scandelay*60*1000}else{aa=S.getPollDelay()*60*1000}return aa>=60000?aa:60000};this.processNodes=function(aa,Z){o.processNodes(o.getRoot(),function(ab){aa(ab)},Z||feedbro.FeedTree.MODE_TOPNODES)};this.markAllAsRead=function(){var Z=new Date();o.processNodes(o.getRoot(),function(aa){aa.data.unread=0},feedbro.FeedTree.MODE_DEPTHFIRST);p.markRead({});l.saveData();l.notifyEngine("reloaddata");a(0)};this.markAsRead=function(ad){var ab=o.getNode(ad);var aa,ac,Z=new Date();if(ab&&ab.data.type==1){ab.data.unread=0;p.markRead({feedid:ad});l.saveData();l.notifyEngine("updatenode",ad,-1)}else{if(ab&&ab.data.type==2){for(aa=0;aa<ab.children.length;aa++){ac=ab.children[aa].data;ac.unread=0}ab.data.unread=0;p.markRead({folderid:ad});l.saveData();l.notifyEngine("reloaddata");l.updateTotalUnread()}else{x("markAsRead: Unidentified feed or folder id: "+ad)}}};this.markUnread=function(ae,ab){var ac=p.getFeedEntryMeta(ae);var ad=false;if(ac&&ac.unread!=ab){ac.unread=ab;ac.dirty=1;var Z=o.getNode(ac.feedid);if(!Z){console.log("ERROR: markUnread: feed not found: "+ac.feedid+" coming from ID: "+ae+" and meta: "+JSON.stringify(ac));return false}var aa=Z.data;if(ab==0){aa.unread--;if(aa.unread<0){aa.unread=0}}else{aa.unread++}l.notifyEngine("updatenode",ac.feedid,-1);ad=true}else{if(!ac){console.log("ERROR: markUnread: no meta data for "+ae)}}return ad};this.markDeleted=function(ac,Z){var aa=p.getFeedEntryMeta(ac);var ab=false;if(aa){if(Z==true||Z==1){aa.purge=1}else{aa.purge=0}aa.dirty=1;l.invalidateTagCloudCache();ab=true}return ab};this.sortFolder=function(Z){if(o.sortChildren(Z)){l.notifyEngine("reloaddata",-1,-1);l.saveTreeData()}};this.getNodesWithUrl=function(Z){var aa=[];o.processNodes(o.getRoot(),function(ab){if(ab.data.url==Z){aa.push(ab)}},feedbro.FeedTree.MODE_RANDOM);return aa};this.addFolder=function(Z){var ab={name:Z,unread:0,type:feedbro.FeedTree.FOLDER};var aa=o.addNode(ab);return aa.data.id};this.updateTheme=function(){l.notifyEngine("updatetheme",-1,-1)};this.updateCss=function(){l.notifyEngine("updatecss",-1,-1)};this.notifyEngine=function(aa,ac,ab){try{chrome.tabs.query({title:"Feedbro"},function(af){if(af.length>0){try{var ad=af[0].id;chrome.tabs.sendMessage(ad,{action:aa,id:ac,parentid:ab},function(ag){})}catch(ae){x("notifyEngine: Could not notify Feedbro tab: "+ae)}}})}catch(Z){x("Unable to send notification to content scripts: "+Z)}};this.deleteFolder=function(Z){o.deleteNode(o.getNode(Z));p.deleteFeedEntries({folderid:Z})};this.deleteFeed=function(Z){o.deleteNode(o.getNode(Z));p.deleteFeedEntries({feedid:Z})};this.toggleItemStarred=function(aa){var Z=p.getFeedEntryMeta(aa);if(Z.starred==1){p.updateFeedEntryMeta(aa,{starred:0})}else{p.updateFeedEntryMeta(aa,{starred:1,purge:0})}};this.getFolderData=function(Z){return o.getNode(Z).data};this.getFeedUnreadCount=function(Z){return o.getNode(Z).data.unread};function r(Z){var ab,ac,ae=new feedbro.TagFilter();if(S.getFilterIframe()){ae.addTagFilter("iframe")}if(S.getFilterEmbed()){ae.addTagFilter("embed")}var ad;for(ab=0;ab<Z.length;ab++){ac=Z[ab];try{ad=o.getNode(ac.feedid);if(ad&&ad.data&&ad.data.name){ac.feed.title=ad.data.name}}catch(aa){}try{ac.content=ae.filter(ac.content||"");ac.title=ae.filter(ac.title||"");ac.author=ae.filter(ac.author||"");ac.feed.title=ae.filter(ac.feed.title||"")}catch(aa){console.log(" Could not filter "+ac.title)}try{if(ac.decoded!=1){ac.content=U.decodeHtmlEntities(ac.content||"");ac.title=U.decodeHtmlEntities(ac.title||"");ac.author=U.decodeHtmlEntities(ac.author||"")}}catch(aa){console.log(" Could not convert html entities properly for "+ac.title)}}n=Z}function E(aa,ad,ac){if(l.isUnreadSearch(aa)){aa.unread=1}var ab=S.getMaxItemAge();if(ab>0){var Z=new Date().getTime()-ab;if(!aa.mindate||Z>aa.mindate){aa.mindate=Z}}if(aa.sort==undefined){aa.sort=S.getItemSortOrder()}p.getFeedEntries(aa,function(ae){r(ae);ac(ad)})}function w(ad,aa){var ab=o.getNode(ad);if(ab){var ac=ab.data;var Z=false;if(ac.latestitem==undefined||ac.latestitem==0){Z=true}ac.lastModified=aa.lastModified!=undefined?(aa.lastModified)+"":undefined;ac.etag=aa.etag!=undefined?(aa.etag+""):undefined;ac.lastupdate=new Date().getTime();if(aa.feed.latestitemdate){ac.latestitem=aa.feed.latestitemdate.getTime()}if(aa.feed.link){ac.htmlUrl=aa.feed.link+""}if(ac.name=="Unnamed feed"){ac.name=aa.feed.title+"";ac.realname=aa.feed.title+""}ac.status=aa.status+0;ac.latency=aa.latency+0;return Z}else{x("updateFeedMap: non-existent node: "+ad);return false}}this.invalidateTagCloudCache=function(){d=undefined};this.getFeedManager=function(){return p};function b(aa){var ab=l.getFeedMaxItems(aa.feedid);p.deleteFeedEntries({feedid:aa.feedid,start:ab,starred:0});var Z=o.getNode(aa.feedid);Z.data.unread=p.queryIndex({feedid:aa.feedid,unread:1}).length;l.notifyEngine("updatenode",aa.feedid,-1);l.invalidateTagCloudCache()}function L(af,aa){var ae=g.shift();if(!ae){x("updateNextFeed: feedQueue is empty. Finished.");l.updateTotalUnread();l.saveData(true);return}var ab=o.getNode(ae);if(!ab){x("updateNextFeed: node with id "+ae+" was not found in the tree.");L(af,aa);return}if(!aa&&!I(ab)){x("Skipping feed "+ab.data.name+", no need to check");L(af,aa);return}var ad=ab.data;if(!ad.latestitem){ad.latestitem=0}var ac=P(U.createProxyURL(ad.url,ad.proxy));ac.setIndex(l.getDbIndex());var Z=ad.maxitems;if(Z==undefined||Z==""||Z<1){Z=S.getFeedMaxEntries()}ac.setMaxEntries(Z);ac.setTimeout(S.getFeedTimeout());ac.setLastModifiedHeader(ad.lastModified);ac.setETagHeader(ad.etag);ac.setEntryDateLimit(ad.lastread||0);if(ad.username&&ad.password){ac.setAuthentication(ad.username,ad.password)}if(ad.entrycontent>=2){ac.setFullFeed(true)}if(ad.entrycontent==3){ac.setAddMetaImage(false)}ac.load(function(ag){B(ag,ae,af,aa)})}function B(af,aa,an,ad){var ab=o.getNode(aa);var al=ab.data;var ao=ab.parent&&ab.parent.data?ab.parent.data.id:-1;if(af.status==304&&(al.status!==200&&al.status!==398&&al.status!==399&&al.status!==500&&al.status!==502&&al.status!==503&&al.status!==504&&al.status!==403&&al.status!==404)){af.status=al.status}var ag=w(aa,af);if(!af.error&&af.status==200){var am={title:af.feed.title,link:af.feed.link,author:af.feed.author};var ah=[];var ae,ak,Z,aj=0,ai=new Date().getTime();for(ae=0;ae<af.feed.entries.length;ae++){ak=af.feed.entries[ae];ak.feed=am;Z=ak.publishedDate.getTime();if(Z>aj&&Z<=ai){aj=Z}if(Z>al.lastread){ah.push(ak)}}if(aj>al.lastread){al.lastread=aj}if(ah.length>0){x("Saving "+ah.length+" entries for feed "+aa+" "+al.name+" in folder "+ao);p.saveFeedEntries(ah,aa,ao,ag,function ac(ap){b(ap);l.saveTreeData();L(an,ad)})}else{L(an,ad)}}else{L(an,ad)}}this.loadFeedItems=function(Z){g.unshift(Z);if(g.length==1){L(undefined,true)}};this.loadFolderFeeds=function(ac){var ab=o.getNode(ac);if(!ab){console.log("loadFolderFeeds: non-existing folder with id: "+ac);return}var aa=ab.children;if(!aa||aa.length==0){console.log("loadFolderFeeds: no children for folder with id: "+ac);return}var Z;for(Z=0;Z<aa.length;Z++){g.unshift(aa[Z].data.id)}if(g.length==aa.length){L(undefined,true)}};this.saveSettings=function(){x("Saving settings...");feedbro.Persistence.saveValue("feedSettings",S.toJson(),function(){x("Done.")})};function N(Z){feedbro.Persistence.loadValue("feedSettings",function(aa){if(aa!=undefined){S.fromJson(aa);x("Settings loaded.")}else{x("No stored settings yet.")}z(Z)})}function z(ab){var aa=S.getLocale();var Z=S.getLocaleMeta();if(Z!=undefined){feedbro.Persistence.loadValue("locale",function(ac){if(ac!=undefined){Locale.addLocale(ac,"custom");Locale.selectLocale(aa)}if(ab){ab()}})}else{Locale.selectLocale(aa);if(ab){ab()}}}this.saveDatabase=function(){x("Saving database data...");p.save()};this.saveData=function(aa){if(v==false){console.log("Feedbro was not properly initialized! saveData call skipped!");return}var Z=new Date().getTime();if(aa||(Z-i)>10000){l.saveTreeData();p.save();i=new Date().getTime();x("Saving data done.")}};this.isInitialized=function(){return v};this.saveTreeData=function(){if(v){feedbro.Persistence.saveValue("feedTree",o.toJson())}else{console.log("ERROR: Feed tree saving skipped! Feedbro did not initialize properly due to chrome.storage.local problems. Please restart the browser.")}};function m(Z){x("Loading feed subscription data...");feedbro.Persistence.loadValue("feedTree",function(aa){if(aa!=undefined){o.fromJson(aa);x("Done.")}else{x("No stored feed subscription data yet.")}if(Z){Z()}})}function A(Z,aa){Z.folderid=Z.id;if(!Z.count){Z.count=30}E(Z,Z.id,aa)}function W(aa,Z,ab){aa.feedid=aa.id;if(!aa.count){aa.count=30}E(aa,aa.id,ab)}function q(Z,aa){Z.starred=1;E(Z,Z.id,aa)}function f(Z,aa){if(!Z.count){Z.count=30}E(Z,Z.id,aa)}function F(Z,aa){p.getFeedEntries(Z,function(ab){r(ab);aa(Z.id)})}this.isUnreadSearch=function(Z){return S.getOnlyUnread()&&(!Z.starred||Z.starred==0)};this.handleMessageEvent=function(aa,Z,ac){var ab;if(aa.action=="loadgroupdao"){ab=o.getNode(aa.id);if(ab&&ab.data.type==feedbro.FeedTree.FOLDER){A(aa,ac)}}if(aa.action=="loadsingledao"){ab=o.getNode(aa.id);if(ab){W(aa,ab.data.url,ac)}}if(aa.action=="loadstarred"){q(aa,ac)}if(aa.action=="loadall"){f(aa,ac)}if(aa.action=="loadsingle"){F(aa,ac)}if(aa.action=="loadtag"){if(!aa.count){aa.count=30}E(aa,aa.id,ac)}if(aa.action=="getlicense"){ac({status:X,license:T,installDate:e})}return true};this.setPopupEnabled=function(Z){console.log("Popup enabled: "+Z);try{if(Z){chrome.browserAction.onClicked.removeListener(H);chrome.browserAction.setPopup({popup:"mainmenu.html"})}else{chrome.browserAction.setPopup({popup:""});chrome.browserAction.onClicked.addListener(H)}}catch(aa){console.log("setPopupEnabled, error: ",aa)}};function H(Z){j("Feedbro","reader.html")}function j(aa,Z){chrome.tabs.query({title:aa},function(ab){if(ab.length>0){chrome.tabs.update(ab[0].id,{active:true});if(l.getSettings().getIconClickReloads()){l.notifyEngine("updateview",-1,-1)}}else{chrome.tabs.create({url:chrome.runtime.getURL(Z)},function(ac){x("openTab")})}})}this.addTag=function(ac,Z){var aa,ab=p.getFeedEntryMeta(ac);if(ab==undefined){return false}if(ab.tags==undefined){ab.tags=[]}for(aa=0;aa<ab.tags.length;aa++){if(ab.tags[aa]==Z){return false}}ab.tags.push(Z);ab.dirty=1;l.invalidateTagCloudCache();return true};this.removeTag=function(ac,Z){var aa,ab=p.getFeedEntryMeta(ac);if(ab==undefined){return false}if(ab.tags==undefined){return false}for(aa=0;aa<ab.tags.length;aa++){if(ab.tags[aa]==Z){ab.tags.splice(aa,1);ab.dirty=1;l.invalidateTagCloudCache();return true}}console.log("removeTag: did not find tag "+Z+" for entry: "+ac);return false};this.addPoints=function(ab,Z){var aa=p.getFeedEntryMeta(ab);if(aa==undefined){return false}if(aa.points==undefined){aa.points=0}aa.points+=Z;aa.dirty=1;return aa.points};this.setItemStarred=function(ab,Z){var aa=p.getFeedEntryMeta(ab);if(aa!=undefined&&Z!=undefined){p.updateFeedEntryMeta(ab,{starred:Z})}};this.getRuleEngine=function(){return R};this.getSoundPlayer=function(){return t};this.getTagCloud=function(Z){if(d==undefined){d=p.getTagCloud(Z)}return d};this.scanUnread=function(ac){var ab=new Date().getTime();x("Time since last scanUnread: "+(ab-G)+" ms.");if(g.length==0||((ab-G)>(60*60*1000))||ac){g=[];if(ac){o.processNodes(o.getRoot(),function(af,ag){if(af.data.type==feedbro.FeedTree.FEED){g.push(af.data.id)}},feedbro.FeedTree.MODE_DEPTHFIRST)}else{o.processNodes(o.getRoot(),function(af,ag){if(I(af)){g.push(af.data.id)}},feedbro.FeedTree.MODE_DEPTHFIRST)}if(ab-i>(5*60*1000)){l.saveData()}if(g.length>0){x("eventScanUnread: feeds that need unread check: "+g.length);if(g.length>5){var aa=S.getUpdateThreads();x("Using "+aa+" threads to scan for updates...");var ad,ae=[];try{for(ad=0;ad<aa;ad++){ae.push(ad)}}catch(Z){console.log("Error in setting number of scanning threads to use. Defaulting to 2.");ae.push(0);ae.push(1)}jQuery.each(ae,function(af,ag){L(function(){},ac)})}else{L(function(){},ac)}}G=ab}};this.loadFeed=function(Z){if(g.length==0){g.push(Z);L()}};this.findFeeds=function(aa,ad,Z,ac){var ab=P(aa);ab.setTimeout(25000);ab.setIndex(l.getDbIndex());if(ad!=undefined&&ad!=""&&ad.length>0){ab.setAuthentication(ad,Z)}ab.findFeeds(ac)};this.previewFeed=function(ab,ac,ae,aa,ad){var Z=P(ab);if(ac==2){Z.setFullFeed(true);Z.setAddMetaImage(true)}if(ac==3){Z.setFullFeed(true);Z.setAddMetaImage(false)}Z.setTimeout(30000);if(ae!=undefined&&aa!=undefined&&ae.length>0){Z.setAuthentication(ae,aa)}Z.setMaxEntries(20);Z.setIndex(l.getDbIndex());Z.load(ad)};this.headerHandler=function(Z){var ad,ac;if(Z.type=="xmlhttprequest"&&Z.tabId==-1&&(Z.method=="GET"||Z.method=="HEAD"||Z.method=="POST")){try{var af=Z.originUrl||Z.initiator||Z.documentUrl;if(af&&af.length>30&&U.beginsWith(af,Y)){var aj=new URL(Z.url).hostname;var ai,ah,aa,ae,ab;if(aj=="api.twitter.com"){Z.requestHeaders.push({name:"Origin",value:"https://twitter.com"});Z.requestHeaders.push({name:"Referer",value:"https://twitter.com/home"})}else{Z.requestHeaders.push({name:"Referer",value:Z.url})}for(ac=0;ac<Z.requestHeaders.length;ac++){ad=Z.requestHeaders[ac];if(ad.name=="Cookie"||ad.name=="cookie"){if(aj=="vk.com"){M(ad,"remixlang");ad.value=ad.value+"; remixlang=3;"}else{if(aj=="www.linkedin.com"){aa=s(ad.value,"JSESSIONID");if(aa!=undefined){feedbro.LiPlugin.csrfToken=aa.substring(1,aa.length-1)}}}}else{if(ad.name=="Origin"||ad.name=="origin"){ae=ad}else{if(ad.name=="Referer"||ad.name=="Referer"){ab=ad}}}}if(aj=="www.facebook.com"){if(ae){ae.value="https://www.facebook.com"}else{Z.requestHeaders.push({name:"Origin",value:"https://www.facebook.com"})}}}}catch(ag){console.log("headerHandler failed: "+ag)}}return{requestHeaders:Z.requestHeaders}};function s(ac,ab){var Z,aa=ac.indexOf(ab+"=");if(aa!=-1){Z=ac.indexOf(";",aa);if(Z==-1){Z=ac.length}return ac.substring(aa+ab.length+1,Z)}else{return undefined}}function M(ad,ab){var ac=ad.value;var aa=ac.indexOf(ab+"=");var Z;if(aa!=-1){Z=ac.indexOf("; ",aa);if(Z==-1){Z=ac.length}ac=ac.substring(0,aa)+ac.substring(Z+1);ad.value=ac}}this.adjustHeaders=function(Z){var ad=false;try{var ae,af,aa,ai,ab,ac=Z.responseHeaders;var ag=Z.originUrl||Z.initiator||Z.documentUrl;if(ag&&ag.length>30&&U.beginsWith(ag,Y)){for(ae=0;ae<ac.length;ae++){af=ac[ae];aa=af.name;if(aa=="x-frame-options"||aa=="X-Frame-Options"||aa=="frame-options"||aa=="Frame-Options"){af.name=af.name+"-disabled";ad=true}if(aa=="link"||aa=="Link"){af.name=aa+"-disabled";ad=true}if(aa=="content-security-policy"||aa=="Content-Security-Policy"){af.value=af.value.replace(/frame-ancestors[^;]+(;|$)/,"");ad=true}if(aa=="set-cookie"||aa=="Set-Cookie"){if(ai==undefined){ai=new URL(Z.url).host}else{if(ai=="www.linkedin.com"){ab=s(af.value,"JSESSIONID");if(ab!=undefined){feedbro.LiPlugin.csrfToken=ab.substring(1,ab.length-1)}}}}}}}catch(ah){console.log("adjustHeaders error: "+ah)}if(ad){return{responseHeaders:Z.responseHeaders}}else{return{}}};this.initFeedbro=function(){Locale.start();N(function(){m(K)})};function K(){p.openConnection(function(){p.init(function(){l.setFeedScanInterval(30)})});D.setSettings(S);D.init();t.setSettings(S);k.setBackground(l);k.setSoundPlayer(t);k.setNotifications(D);k.init();R.setActionHandler(k);R.loadRules();R.setEnabled(true);chrome.runtime.onMessage.addListener(l.handleMessageEvent);chrome.browserAction.setBadgeBackgroundColor({color:"#0000FF"});l.updateTotalUnread();var ac=(S.getIconClickMode()==1);if(ac==false){l.setPopupEnabled(ac)}v=true;var ab=true;var aa=true;try{chrome.webRequest.onBeforeSendHeaders.addListener(l.headerHandler,{urls:["https://twitter.com/*","https://api.twitter.com/*","https://vk.com/*","https://www.linkedin.com/feed/","https://www.linkedin.com/voyager/api/*","https://www.facebook.com/api/*"]},["blocking","requestHeaders","extraHeaders"]);console.log("webRequest handlers with extraHeaders setup successful.")}catch(Z){ab=false}if(!ab){try{chrome.webRequest.onBeforeSendHeaders.addListener(l.headerHandler,{urls:["https://twitter.com/*","https://api.twitter.com/*","https://vk.com/*","https://www.linkedin.com/feed/","https://www.linkedin.com/voyager/api/*","https://www.facebook.com/api/*"]},["blocking","requestHeaders"]);console.log("webRequest handlers without extraHeaders setup successful.")}catch(Z){ab=false}}if(S.getDisableHeaderListener()==false){try{Y=U.getExtensionBaseUrl();chrome.webRequest.onHeadersReceived.addListener(l.adjustHeaders,{urls:["<all_urls>"]},["blocking","responseHeaders","extraHeaders"])}catch(Z){aa=false}if(aa==false){try{chrome.webRequest.onHeadersReceived.addListener(l.adjustHeaders,{urls:["<all_urls>"]},["blocking","responseHeaders"])}catch(Z){console.log("Failed to set adjustHeader handler")}}}console.log("Feedbro initialized.")}};var feedbro=feedbro||{};feedbro.Bookmarks=function(){var m=this;var e='<?xml version="1.0" encoding="UTF-8"?>\n<opml version="1.0">\n<head>\n    <title>Firefox Bookmarks as OPML</title>\n</head>\n<body>';var k="</body>\n</opml>";var l;var n=new feedbro.Options();var h=new feedbro.FeedIconManager();function f(){return chrome.extension.getBackgroundPage().feedbrobg}this.init=function(){try{Locale.start();Locale.activeMap=f().getActiveLocaleMap();Locale.translate(true);alertify.set({labels:{cancel:Locale.i18n("dialog_cancel",false),ok:Locale.i18n("dialog_ok",false)}})}catch(o){feedbro.log("Locale init error",o)}document.getElementById("bookmarkfile").addEventListener("change",a,false);$("button#download").click(function(){var p=b();if(p){n.downloadFile(p,"firefox-subscriptions.opml","application/xml")}});$("button#import").click(function(){var p=b();if(p){n.importFeeds(p,l)}});$("div#left").click(function(){n.restoreView()});$("div#right").click(function(){n.restoreView()})};function c(p){var o=p;o=o.replace(/outline/g,"div");o=o.substring(o.indexOf("<body>")+"<body>".length,o.indexOf("</body>"));$("div#results").html(o);$("div#results div").each(function(s,r){var w=$(r);var t=w.attr("type")=="rss"?"feed":"folder";if(w.attr("data-type")){t=w.attr("data-type")}w.addClass(t);var q;if(t=="folder"){q="<img class='folder' src='images/folder-icon.png'>"+w.attr("title")}else{if(t=="livebookmark"){q="<a target='_blank' href='"+w.attr("xmlUrl")+"'><img title='Live Bookmark' class='livebookmark' src='images/feed-icon.png'>"+w.attr("title")+"</a>"}else{if(t=="feed"){var v=w.attr("xmlUrl")||"";var u=h.getIconFromGoogleCache(v);q="<a target='_blank' href='"+w.attr("xmlUrl")+"'><img class='feed' src='"+u+"'>"+w.attr("title")+"</a>"}}}w.prepend("<input type='checkbox' class='"+t+"'><span class='title'>"+q+"</span>")});$("div#results input.folder").change(function(t){var q=$(this);var s=q.parent();var r=q.prop("checked");s.find("input").each(function(u,w){var v=$(w);v.prop("checked",r);v.parent().attr("data-checked",r)});i(s,r)});$("div#results input.feed").change(j);$("div#results input.livebookmark").change(j);$("input#file").val(null)}function j(r){var o=$(this);var q=o.parent();var p=o.prop("checked");q.attr("data-checked",p);i(q,p)}function b(){if($("div#results div[data-checked='true']").length==0){alertify.alert(Locale.i18n("options_error_bookmarks_noselection",false));return false}var o=$("div#results").clone();o.find("div[data-checked!='true']").remove();o.find("input").remove();o.find("span").remove();o.find("div").removeAttr("data-checked class");var p=o[0].innerHTML;p=p.replace(new RegExp("<div","g"),"<outline");p=p.replace(new RegExp("</div","g"),"</outline");p=p.replace(new RegExp("xmlurl=","g"),"xmlUrl=");p=p.replace(new RegExp("htmlurl=","g"),"htmlUrl=");return e+p+k}function i(p,o){p=p.parent();while(true){if(p.hasClass("folder")==false){break}if(p&&p.find("> input").prop("checked")==false&&o){p.find("> input").prop("checked",true);p.attr("data-checked",true)}p=p.parent()}}function d(o){if(o.indexOf("<!DOCTYPE NETSCAPE-Bookmark-file-1>")!=0){alertify.alert(Locale.i18n("options_error_bookmarks_invalidfile",false,l.name));return e+k}o=o.substring("<DL><p>".length+o.indexOf("<DL><p>"),o.length-"</DL>".length-1);o=o.replace(new RegExp("<DD>[^<]+<","g"),"<");o=o.replace(new RegExp("<HR>","g"),"");o=o.replace(new RegExp('<A FEEDURL="([^"]+)" HREF="([^"]+)">',"g"),function(p,r,q){return'<A xmlUrl="'+g(r)+'" htmlUrl="'+g(q)+'" data-type="livebookmark">'});o=o.replace(new RegExp("<DT><H3[^>]+>([^<]+)</H3>[\n ]+<DL><p>","g"),'<outline title="$1" text="$1">');o=o.replace(new RegExp("<DT><A ([^>]+)>([^<]+)</A>","g"),'<outline type="rss" title="$2" text="$2" $1/>');o=o.replace(new RegExp("</DL><p>","g"),"</outline>");o=o.replace(new RegExp(' (ICON|ICON_URI|ADD_DATE|LAST_MODIFIED|LAST_CHARSET|PRIVATE|TAGS)="[^"]+"',"g"),"");o=o.replace(new RegExp('<outline[^>]+HREF="(about|place|moz-extension|view-source):[^>]+/>',"g"),"");o=o.replace(new RegExp('HREF="([^"]+)"',"g"),function(p,q){return'xmlUrl="'+g(q)+'"'});return e+o+k}function a(p){var q=p.target.files;var o=new FileReader();l=q[0];o.onload=function(r){c(d(r.target.result))};o.readAsText(l)}function g(o){return o.replace(/&/g,"&amp;")}};var feedbro=feedbro||{};feedbro.Chrome={};feedbro.Chrome.openTab=function(b,a){chrome.tabs.query({title:b},function(d){if(d.length>0){try{chrome.windows.update(d[0].windowId,{focused:true})}catch(c){}if(a==undefined){chrome.tabs.update(d[0].id,{active:true})}else{chrome.tabs.update(d[0].id,{active:true,url:a})}}else{chrome.tabs.create({url:chrome.runtime.getURL(a)})}})};function fetchTimeout(c,b,f){var a=new AbortController();if(f==null){f={method:"GET"}}f.signal=a.signal;var e=fetch(c,f);var d=setTimeout(function(){a.abort()},b);return e["finally"](function(){clearTimeout(d)})}feedbro.FetchWrapper=function(a){this.status=a};feedbro.FetchWrapper.prototype.getResponseHeader=function(a){return null};var feedbro=feedbro||{};feedbro.ClearBody=function(){this.linkConverter=/<([^<>]*) (src|href)=["'](?!http|data|magnet|mailto)([^"']+)["']([^<>]*)>/gi;this.removeHeader=true;this.addmetaimageMode=true;this.timeout=30000;this.dataCache=new WeakMap();this.strings=new feedbro.Strings()};feedbro.ClearBody.makeMap=function(d){var c={},a=d.split(",");for(var b=0;b<a.length;b++){c[a[b]]=true}return c};feedbro.ClearBody.tagFlipMap={audio:"x-audio",video:"x-video",source:"x-source",svg:"x-svg",style:"x-style",canvas:"x-canvas"};feedbro.ClearBody.bannedExtensions=/\.pdf|doc|docx|png|jpg|xls|xlsx|gif|ppt|pptx|rtf$/i;feedbro.ClearBody.killTags=feedbro.ClearBody.makeMap("SCRIPT,META,LINK,NOSCRIPT,STYLE,X-STYLE,BUTTON,TEXTAREA,NAV,SELECT,LABEL,HEAD,FOOTER,ASIDE,HR,TIME,FIGURE,CANVAS,X-CANVAS");feedbro.ClearBody.killClasses=new RegExp("(comment|twitter|facebook|linkedin|email|slide|video|gallery|tag\\s|playlist|actions|footer|label-more|summaPremiumLinks|oembed-asset|cnn_strylceclbtn|advert|share|storyTools|xcContainer|linked-articles|kainalo|googleAd)","i");feedbro.ClearBody.killMainClasses=new RegExp("(hidden|banner|related|read-more|readAlso|subscribe|sponsor|byline|social-media|sharing|pagination|paywall|googleArticleAd|teaser|article-ad)| ad$|^ad $","i");feedbro.ClearBody.killIds=new RegExp("(comment|actions|footer|author|share|headlines|toolbar|hsonfb-links|bpr-guid)","i");feedbro.ClearBody.keepTags=feedbro.ClearBody.makeMap("ARTICLE");feedbro.ClearBody.boostClasses=new RegExp("content|main|primary|article|body|post","i");feedbro.ClearBody.boostTags=feedbro.ClearBody.makeMap("ARTICLE,ISENSE");feedbro.ClearBody.CHARCOUNT=0;feedbro.ClearBody.PCOUNT=1;feedbro.ClearBody.HCOUNT=2;feedbro.ClearBody.VISITED=3;feedbro.ClearBody.prototype.getNodeData=function(a){if(a==undefined){return undefined}var b=this.dataCache.get(a);if(b==undefined){b=[0,0,0,0];this.dataCache.set(a,b)}return b};feedbro.ClearBody.prototype.setTimeout=function(a){if(a<30000){a=30000}this.timeout=a};feedbro.ClearBody.prototype.setAddMetaImage=function(a){this.addmetaimageMode=a};feedbro.ClearBody.prototype.setRemoveHeader=function(a){this.removeHeader=a};feedbro.ClearBody.prototype.loadFeedEntries=function(b,e){var d,c=[];if(b==undefined||b.length<1){e();return}var a=this;for(d=0;d<b.length;d++){a.load(b[d].link,(function(f){return function(g){if(g!=undefined&&g!="undefined"){f.content=g}c.push(0);if(c.length==b.length){e()}}})(b[d]))}};feedbro.ClearBody.prototype.isValidExtension=function(a){return feedbro.ClearBody.bannedExtensions.test(a)==false};feedbro.ClearBody.prototype.load=function(b,d){var a=this;if(a.isValidExtension(b)==false){feedbro.log("  ClearBody: skipped link (banned file extension): "+b);d();return}var c=new XMLHttpRequest();c.onreadystatechange=function(f){var e=f.target;if(e.readyState==4){e.onreadystatechange=null;if(e.status==200){var g=e.getResponseHeader("Content-Type")||"";if(g.indexOf("text/html")!=-1){a.processHtmlText(b,e,d)}else{d()}}else{d()}}};c.open("GET",b,true);c.timeout=this.timeout;c.send()};feedbro.ClearBody.prototype.processHtmlText=function(c,f,h){var g=new DOMParser();try{var e=f.responseText;e=e.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"");e=e.replace(new RegExp(" (src|srcset|rel|onload|preload|autoplay)=","gi")," data-$1=");e=this.strings.switchTags(e,feedbro.ClearBody.tagFlipMap);var d=g.parseFromString(e,"text/html");e=null;var a=d.children[0];this.processDom(c,a,h)}catch(b){h()}};feedbro.ClearBody.prototype.getChildTag=function(a,d){var c,b=a.children;for(c=0;c<b.length;c++){if(b[c].tagName==d){return b[c]}}return undefined};feedbro.ClearBody.prototype.getMetadata=function(b){var e,g={},d=b.children,c;c=this.getChildTag(b,"HEAD");if(c==undefined){return g}d=c.children;for(e=0;e<d.length;e++){if(d[e].tagName=="META"){var h=d[e];var a=h.getAttribute("property")+"";var f=h.getAttribute("content")+"";if(a!=undefined&&f!=undefined){g[a]=f}}}return g};feedbro.ClearBody.prototype.processDom=function(a,h,m){var o=this.getMetadata(h);var e=this.getChildTag(h,"BODY");this.depthFirst(e,this.filter2,function(i){});var p=this;this.depthFirst(e,this.filter1,this.calculateWeight);var b=e;var g=1;var q=[];var l;while(true){b=this.findLargestTextNode(b);l=p.getNodeData(b);if(b==undefined||(l[feedbro.ClearBody.CHARCOUNT]/g<0.5||b.tagName=="P"||b.tagName=="A")){b=q.pop();break}q.push(b);g=l[feedbro.ClearBody.CHARCOUNT];if(g==0){g=1}}if(b==undefined){feedbro.log("  No content found");m()}var k=true;var j=o["og:image"];if(j){var f=this.getImages(b);var d;for(d=0;d<f.length;d++){if(f[d].getAttribute("src")==j){k=false;break}}}else{k=false}if(b!=undefined){var c;if(this.addmetaimageMode&&k&&b!=undefined&&b.firstChild){c=this.serializeNodeTree('<img class="fbarticlemainimage" src="'+j+'">',b)}else{c=this.serializeNodeTree("",b)}c=c.replace(new RegExp(" data-(src|srcset|rel|onload|preload|autoplay)=","gi")," $1=");c=this.strings.switchTags(c,this.strings.reverseMap(feedbro.ClearBody.tagFlipMap));c=this.convertRelativeLinks(c,undefined,a);m(c)}else{m(undefined)}};feedbro.ClearBody.prototype.calculateWeight=function(d,b){var g=1;var e=b.getNodeData(d);var a;if(d.parentNode){a=b.getNodeData(d.parentNode)}if(d.nodeType==3){var c=d.nodeValue.trim().length;if(c<20){g=0.1}if(c>80){g=2}if(c>200){g=4}if(c>0){e[feedbro.ClearBody.CHARCOUNT]+=c*g}}if(d.parentNode){var f=d.parentNode.tagName;if(d.tagName=="P"){g=2;a[feedbro.ClearBody.PCOUNT]++}if(f=="LI"){g=0.01}if(f=="A"){g=0.001}if(f=="IFRAME"){g=1e-7}a[feedbro.ClearBody.PCOUNT]+=e[feedbro.ClearBody.PCOUNT];a[feedbro.ClearBody.CHARCOUNT]+=(e[feedbro.ClearBody.CHARCOUNT]*g)}};feedbro.ClearBody.prototype.serializeNodeTree=function(d,c){try{var b=new XMLSerializer();return d+b.serializeToString(c)}catch(a){return d+c.innerHTML}};feedbro.ClearBody.prototype.getImages=function(b){var a=[];this.breadthFirst(b,function(c){if(c.tagName=="IMG"){a.push(c)}return false});return a};feedbro.ClearBody.prototype.getTitle=function(a){return this.breadthFirst(a,function(b){return(b.tagName=="H1"?b:false)})};feedbro.ClearBody.prototype.findLargestTextNode=function(b){var a=-1,d,g;for(var c=0;c<b.childNodes.length;c++){var f=b.childNodes[c];g=this.getNodeData(f);var e=g[feedbro.ClearBody.CHARCOUNT];if(g[feedbro.ClearBody.PCOUNT]>0){e=e*g[feedbro.ClearBody.PCOUNT]}if(f.className!=undefined&&feedbro.ClearBody.boostClasses.test(f.className)){e=e*3}if(f.tagName in feedbro.ClearBody.boostTags){e=e*3}if(e>a){a=e;d=f}}return d};feedbro.ClearBody.prototype.breadthFirst=function(b,f){var d,e,a=[];if(b!=undefined){a.push(b)}while(true){if(a.length==0){break}e=a.shift();var c=f(e);if(c!=undefined&&c!=false){return c}for(d=0;d<e.childNodes.length;d++){a.push(e.childNodes[d])}}return false};feedbro.ClearBody.prototype.filter1=function(b){if(b==undefined){return false}var a=b.tagName;if(b.nodeType==8||a in feedbro.ClearBody.killTags){return true}else{if(b.className!=undefined&&!(a in feedbro.ClearBody.keepTags)&&feedbro.ClearBody.killClasses.test(b.className)){return true}else{if(b.id!=undefined&&feedbro.ClearBody.killIds.test(b.id)){return true}else{if(b.nodeType==1&&b.getAttribute("aria-hidden")=="true"){return true}else{return false}}}}};feedbro.ClearBody.prototype.filter2=function(a){if(a.className!=undefined&&feedbro.ClearBody.killMainClasses.test(a.className)){return true}else{return false}};feedbro.ClearBody.prototype.depthFirst=function(b,f,g){var e,c,d,a=[];if(b!=undefined){a.unshift(b)}d=b;while(a.length>0){d=a[0];e=this.getNodeData(d);if(e[feedbro.ClearBody.VISITED]==1||d.childNodes.length==0){g(d,this);d=a.shift();e=this.getNodeData(d);e[feedbro.ClearBody.VISITED]=0;continue}else{for(c=d.childNodes.length-1;c>=0;c--){var h=d.childNodes[c];if(f(h)){d.removeChild(h)}else{a.unshift(h)}}}e[feedbro.ClearBody.VISITED]=1}};feedbro.ClearBody.prototype.convertRelativeLinks=function(b,g,d){var f=this.getProtocol(d);var c=this.getServer(d);var e=this.getBase(d);var a=this;return b.replace(a.linkConverter,function(o,n,k,j,i){var h=n;var p=k;var q=j;var m=i;var r="<"+h+" "+p+'="';var l='"'+m+">";if(q.indexOf("://")!=-1||q.indexOf("data:")==0){return r+q+l}if(q.indexOf("//")==0){return r+f+":"+q+l}if(q.length>0&&q.charAt(0)=="/"){if(g!=undefined){return r+a.getProtocol(g)+"://"+a.getServer(g)+q+l}else{return r+f+"://"+c+q+l}}else{if(g!=undefined){if(q.length>0&&g.length>0&&(q.charAt(0)=="#"||q.charAt(0)=="?")){return r+g.substring(0,g.length-1)+q+l}else{return r+g+q+l}}else{return r+e+q+l}}})};feedbro.ClearBody.prototype.getServer=function(e){var d=e.indexOf("://");if(d<0){d=0}else{d=d+3}var c=e.indexOf("/",d);if(c<0){c=e.length}return e.substring(d,c)};feedbro.ClearBody.prototype.getProtocol=function(a){if(!a){return"http"}var b=a.indexOf(":");return b>0?a.substring(0,b):"http"};feedbro.ClearBody.prototype.getBase=function(e){if(e==undefined){return undefined}var d=e.indexOf("://");var c=e.lastIndexOf("/");if(d!=-1&&c>(d+3)){return e.substring(0,c+1)}else{if(e.charAt(e.length-1)!="/"){return e+"/"}else{return e}}};var feedbro=feedbro||{};feedbro.DbIndex=function(b){var d=[];var a={};var c={};var e;this.add=function(g,k,f,p,j,h,q,m,n,l,i){var o={timestamp:k,unread:j,starred:h,feedid:f,folderid:p,id:g,tags:q,link:m,guid:l};if(i==1){o.purge=1}if(n&&n!=0){o.points=n}d.push(o);a[g]=o;if(l!=undefined){c[f+"|"+l]=o}e=undefined};this.size=function(){return d.length};this.clear=function(){d=[];a={};c={};e=undefined};this.remove=function(k){var f,j={};for(f=0;f<k.length;f++){j[k[f]]=1}var h,g=[];for(f=0;f<d.length;f++){h=d[f];if(j[h.id]){a[h.id]=undefined;if(h.guid!=undefined){c[h.feedid+"|"+h.guid]=undefined}}else{g.push(h)}}d=g};this.moveFeed=function(f,j){var g,h;for(g=0;g<d.length;g++){h=d[g];if(h.feedid==f&&h.folderid!=j){h.folderid=j;h.dirty=1}}};this.get=function(f){return a[f]};this.sort=function(f){if(f==feedbro.DbIndex.SORT_DESCENDING){d.sort(function(h,g){if(h.timestamp>g.timestamp){return -1}if(h.timestamp<g.timestamp){return 1}return 0});e=f}else{if(f==feedbro.DbIndex.SORT_ASCENDING){d.sort(function(h,g){if(h.timestamp<g.timestamp){return -1}if(h.timestamp>g.timestamp){return 1}return 0});e=f}else{if(f==feedbro.DbIndex.SORT_POINTS){d.sort(function(h,g){var i=h.points||0;var j=g.points||0;if(i>j){return -1}if(i<j){return 1}if(h.timestamp>g.timestamp){return -1}if(h.timestamp<g.timestamp){return 1}return 0});e=f}}}};this.getTagCloud=function(m){var l,k,n,f,h,g={};if(m==undefined){m={}}for(l=0;l<d.length;l++){n=d[l];if(n.purge==1){continue}if(m.mindate>n.timestamp){continue}if(m.maxdate<n.timestamp){continue}if(m.feedid!=undefined&&n.feedid!=m.feedid){continue}if(m.folderid!=undefined&&n.folderid!=m.folderid){continue}if(m.unread!=undefined&&n.unread!=m.unread){continue}h=n.tags;if(h==undefined||h.length<1){continue}for(k=0;k<h.length;k++){f=h[k];if(g[f]!=undefined){g[f]++}else{g[f]=1}}}return g};this.getGuid=function(f,g){return c[f+"|"+g]};this.findEntryWithLink=function(f){var g,j,h;for(g=0;g<d.length;g++){h=d[g].link;if(h&&h==f){return d[g]}}return undefined};this.query=function(q,f){var n=[];var g={};var l=0;var m=0;var j,h,p,o;if(!q.mindate){q.mindate=0}if(!q.maxdate){q.maxdate=Number.MAX_VALUE}if(!q.start){q.start=0}if(!q.count){q.count=10000000}if(!q.sort){q.sort=feedbro.DbIndex.SORT_DESCENDING}if(!e||e!=q.sort){this.sort(q.sort)}for(j=0;j<d.length;j++){p=d[j];if(q.skipUntil){if(p.id!=q.skipUntil){continue}else{q.skipUntil=undefined;continue}}if(q.feedid!=undefined&&p.feedid!=q.feedid){continue}if(q.folderid!=undefined&&p.folderid!=q.folderid){continue}if(q.unread!=undefined&&p.unread!=q.unread){continue}if(q.mindate>p.timestamp){continue}if(q.maxdate<p.timestamp){continue}if(q.starred!=undefined&&p.starred!=q.starred){continue}if(q.dirty!=undefined&&p.dirty!=q.dirty){continue}if((q.purge!=undefined&&p.purge!=q.purge)||(q.purge==undefined&&p.purge==1)){continue}if(q.articleid!=undefined&&p.id!=q.articleid){continue}if(q.link!=undefined&&p.link!=q.link){continue}if(q.tag!=undefined){if(p.tags==undefined||Array.isArray(p.tags)==false){continue}o=false;for(h=0;h<p.tags.length;h++){if(p.tags[h]==q.tag){o=true;break}}if(!o){continue}}if(m>=q.start){if(l<q.count){if(q.maxitemsperfeed){if(!g[p.feedid]){g[p.feedid]=0}if(g[p.feedid]<q.maxitemsperfeed){g[p.feedid]++}else{continue}}if(f){f(p)}n.push(p.id);l++}else{break}}m++}return n}};feedbro.DbIndex.SORT_DESCENDING=1;feedbro.DbIndex.SORT_ASCENDING=2;feedbro.DbIndex.SORT_POINTS=3;var feedbro=feedbro||{};feedbro.dndTable={};feedbro.dndTable.create=function(c,a){$("table#"+c+" > tbody").on("drop",function(f){f.preventDefault();var g=f.originalEvent.dataTransfer.getData("text");var d=document.getElementById(g);var e=$(f.target).parent();if(f.offsetY/e.height()<0.5){$(d).insertBefore(e)}else{$(d).insertAfter(e)}if(a){a(d)}});var b=$("table#"+c+" > tbody > tr");b.on("dragstart",function(d){d.originalEvent.dataTransfer.setData("text",d.target.id)});b.on("dragover dragenter dragleave",function(d){d.preventDefault()})};var feedbro=feedbro||{};feedbro.EnclosureHandler=function(){this.createTag=function(k,e){if(e==undefined){return"<span></span>"}var f="",i=e.type;var j,d,h=false,g;var c="<span class='enclosure-name'>"+b(e.url)+"</span>";if(i!=undefined){if(i!="null"){j="<span class='enclosure-type'>["+i+"]</span>"}else{j="<span class='enclosure-type'></span>";g=(e.url||"").match(/\.(png|gif|jpg|jpeg)/i);if(g){i="image/"+g[1];j="<span class='enclosure-type'>["+i+"]</span>"}}if(a(i,"audio/mpeg3")||a(i,"audio/mp3")||a(i,"audio/x-mpeg")||a(i,"audio/x-mpeg-3")||a(i,"audio/x-m4a")){i="audio/mp4"}if(a(i,"video/x-m4v")){i="video/mp4"}if(a(i,"image/")){f+='<div class="enclosure enclosure-image" data-url="'+e.url+'" data-type="'+e.type+'">'}else{if(a(i,"video/webm")||a(i,"video/ogg")||a(i,"video/mp4")||a(i,"video/mpeg")){f+='<div class="enclosure enclosure-video" data-url="'+e.url+'" data-type="'+e.type+'">'}else{if(a(i,"audio/webm")||a(i,"audio/mpeg")||a(i,"audio/ogg")||a(i,"audio/wav")){f+='<div class="enclosure enclosure-audio" data-url="'+e.url+'" data-type="'+e.type+'">'}else{f+='<div class="enclosure enclosure-other" data-url="'+e.url+'" data-type="'+e.type+'">';h=true}}}if(h==false){f+='<div class="enclosure-caption"><span class="enclosure-viewlink">'+Locale.i18n("article_action_enclosure_view",true)+"</span> "+Locale.i18n("article_action_enclosure_view_enclosure",true)+' <a class="enclosure-link" href="'+e.url+'">'+c+"</a> "+j+"</div></div>"}else{f+='<div class="enclosure-caption">'+Locale.i18n("article_action_enclosure_label",true)+' <a class="enclosure-link" href="'+e.url+'">'+c+"</a> "+j+"</div></div>"}f=$(f);f.find("span.enclosure-viewlink").click(function(){var l=$(this).parent().parent();if(l.hasClass("open-enclosure")){if(l.hasClass("enclosure-audio")){d=l.find("audio");d[0].pause();d.remove()}else{if(l.hasClass("enclosure-video")){d=l.find("video");d[0].pause();d.remove()}else{if(l.hasClass("enclosure-image")){d=l.find("img");d.remove()}}}l.find("div.enclosure-content").remove();l.removeClass("open-enclosure");$(this).html("View");return}if(l.hasClass("enclosure-audio")){l.append('<div id="enclosure-content-'+k+'" class="enclosure-content"><audio src="'+l.data("url")+'" type="'+l.data("type")+'" preload="metadata" controls="controls"></audio></div>')}else{if(l.hasClass("enclosure-video")){l.append('<div id="enclosure-content-'+k+'" class="enclosure-content"><video src="'+l.data("url")+'" type="'+l.data("type")+'" preload="metadata" controls="controls"></video></div>')}else{if(l.hasClass("enclosure-image")){l.append('<div id="enclosure-content-'+k+'" class="enclosure-content"><img src="'+l.data("url")+'"/></div>')}}}l.addClass("open-enclosure");$(this).html("Hide")})}return f};function b(e){var d,c=e.lastIndexOf("/");if(c<0){return e}else{d=decodeURIComponent(e.substring(c+1));if(d.indexOf("%")!=-1){d=decodeURIComponent(d)}return d}}function a(d,c){return d.indexOf(c)==0}};var feedbro=feedbro||{};feedbro.Engine=function(){var aG=this;var c=0;var H;var a1;var r=-1;var d;var p='<a href="" id="" title="" target="" onclick="" style=""></a><br />';var a0=false;var aT=new feedbro.InviewObserver("div#feed");var M=new feedbro.Strings();var i=new feedbro.EnclosureHandler();var ah=new feedbro.FeedIconManager();var aX=new feedbro.FeedFinder();var m=new feedbro.MathJax();var L=new feedbro.TagSelect();var S;var q={email:"mailto:?subject={TITLE}&body={URL}",facebook:"https://www.facebook.com/sharer/sharer.php?u={URL}&t={TITLE}",google:"https://plus.google.com/share?url={URL}",twitter:"https://twitter.com/intent/tweet?text={TITLE}&url={URL}",linkedin:"http://www.linkedin.com/shareArticle?mini=true&url={URL}&title={TITLE}",digg:"http://digg.com/submit?phase=2&url={URL}&amp;title={TITLE}",stumbleupon:"http://www.stumbleupon.com/submit?url={URL}&title={TITLE}",reddit:"http://www.reddit.com/submit?title={TITLE}&url={URL}",tumblr:"http://www.tumblr.com/share/link?url={URL}&name={TITLE}",friendfeed:"http://friendfeed.com/?url={URL}&amp;title={TITLE}",instapaper:"http://www.instapaper.com/edit?url={URL}&title={TITLE}&summary=",gmail:"https://mail.google.com/mail/?view=cm&fs=1&su={TITLE}&body={URL}",yammer:"https://www.yammer.com/home/bookmarklet?t={TITLE}&u={URL}",pocket:"https://getpocket.com/save?url={URL}&title={TITLE}",evernote:"https://www.evernote.com/clip.action?url={URL}&title={TITLE}",readability:"http://www.readability.com/save?url={URL}",flipboard:"https://share.flipboard.com/bookmarklet/popout?v=2&title={TITLE}&url={URL}",hootsuite:"https://hootsuite.com/hootlet/social-share?partner=hootlet&url={URL}&title={TITLE}",buffer:"https://bufferapp.com/add?url={URL}&title={TITLE}",vk:"https://vk.com/share.php?url={URL}&title={TITLE}",gtranslate:"http://translate.google.com/translate?tl={TOLANG}&sl=auto&ie=UTF-8&u={URL}"};function J(){return chrome.extension.getBackgroundPage().feedbrobg}function n(a4,a3){if(a0==false){return}if(a3==undefined){console.log(a4)}else{console.log(a4,a3)}}function af(a4,a3){chrome.tabs.query({title:a4},function(a5){if(a5.length>0){chrome.tabs.update(a5[0].id,{active:true})}else{chrome.tabs.create({url:chrome.runtime.getURL(a3)},function(a6){})}})}function u(){$("div#navigator").tree("selectNode",null);$("div#starreditems").removeClass("menu-selected");$("div#allitems").removeClass("menu-selected");$("div#stats").removeClass("menu-selected");$("div#rulenav").removeClass("menu-selected");$("div#tagnav").removeClass("menu-selected")}function f(){J().saveData()}function at(a3){return a3?a3.replace(/[&<>"'`]/g,function(a4){return"&#"+a4.charCodeAt(0)+";"}):a3}function aR(a3){return a3?a3.replace(/[<>]/g,function(a4){return"&#"+a4.charCodeAt(0)+";"}):a3}function ai(a4,a3){return"<span class='keepunread'><input class='unreadbox' style='vertical-align: middle;' type='checkbox' "+(a3&&a4.unread==1?"checked='checked' ":"")+"id='unread-"+a4.id+"' title='"+Locale.i18n("article_action_keepunread_title",true)+"'> <label for='unread-"+a4.id+"'>"+Locale.i18n("article_action_keepunread_body",true)+"</label></span>"}function ak(a3){return"<div class='tags' title='"+Locale.i18n("article_action_tags_title",true)+"' data-id='"+a3.id+"'></div>"}function aB(a3){return"<a class='delete-entry articletrash' data-id='"+a3.id+"' title='"+Locale.i18n("article_action_delete_title",true)+"'><img data-id='"+a3.id+"' src='images/trash.png' class='articletrashicon'>"+Locale.i18n("article_action_delete_body",true)+"</a>"}function N(a7,a5){var a4;var a6="images/feed-icon-bw.png";if(a5>0){a4='<div class="node"><div class="node-unread" title="'+Locale.i18n("navigator_tree_unread",true)+'">'+a5+"</div>";a6="images/feed-icon.png"}else{a4='<div class="node empty-node">'}if(S==undefined){S=J().getSettings()}if(a7.type==1&&S.getUseFavIcons()==true){a6=ah.getIconFromGoogleCache(a7.htmlUrl)}var a3="";if(a7.type==2){a3="<img src='images/folder-icon.svg' class='treeFolderIcon'>"}else{if(a7.type==1){a3="<img src='"+a6+"' class='treeFeedIcon'>"}}a4+='<div class="node-text'+(a5>0?" node-unreadtext":"")+'" style="float: none; width: auto; overflow: hidden;" title="'+at(a7.realname||a7.name)+" - "+Locale.i18n("navigator_tree_rightclickoptions",true)+'">'+a3+at(a7.name)+"</div>";a4+="</div>";return a4}function z(a3){var a4=J().getFeedTree().getNode(a3.id).data;return N(a4,a4.unread)}function U(){var a4,a3,a6,a5,a8,a9,a7=Object.assign([],J().getTreeData());for(a4=0;a4<a7.length;a4++){a6=a7[a4];if(a6.type==2){a5=a6;a8=0;for(a3=0;a3<a5.children.length;a3++){a9=a5.children[a3];a8+=a9.unread;a9.name=N(a9,a9.unread)}a5.name=N(a5,a8)}else{if(a6.type==1){a6.name=N(a6,a6.unread)}else{n("Unidentified tree data entry: "+JSON.stringify(a6))}}}return a7}function R(a6,a5){H=a6;if(!a6){return}var a4=a6.node;var a3={key:a4.name,id:a4.id};if(!a5){u()}if(a6.action){a3.action=a6.action;if(a3.action=="feedstats"){ae();return}if(a3.action=="tagcloud"){ag();return}if(a3.action=="rulelist"){d.printRuleList();return}if(a3.action=="loadstarred"){a3.starred=1}if(a3.action=="loadtag"){a3.tag=a6.tag}}else{if(a4.type==2){a3.action="loadgroupdao"}else{if(a4.type==1){a3.action="loadsingledao"}else{n("handleLoadEntries: invalid node type: "+a4.type);return}}}a3.firstload=true;Y(a3)}function aq(a3){switch(a3){case 0:case undefined:return Locale.i18n("loadstatus_0",true);case 200:case 304:return Locale.i18n("loadstatus_200",true);case 398:return Locale.i18n("loadstatus_398",true);case 399:return Locale.i18n("loadstatus_399",true);case 401:return Locale.i18n("loadstatus_398",true);case 403:return Locale.i18n("loadstatus_403",true);case 404:return Locale.i18n("loadstatus_404",true);case 500:return Locale.i18n("loadstatus_500",true);case 503:return Locale.i18n("loadstatus_503",true);case 601:return Locale.i18n("loadstatus_601",true);case 602:return Locale.i18n("loadstatus_602",true);case 603:return Locale.i18n("loadstatus_603",true);default:return Locale.i18n("loadstatus_broken",true)}}function aY(){var a3=[];J().processNodes(function(a4){if(a4.data.type==1){a3.push(a4)}},5);a3.sort(function(a5,a4){if(a5.data.status&&!a4.data.status){return 1}if(!a5.data.status&&a4.data.status){return -1}if(!a5.data.status&&!a4.data.status){return 0}var a6=a5.data.status-a4.data.status;if(a6!=0&&(a5.data.status>304||a4.data.status>304)){return a6}return a4.data.latestitem-a5.data.latestitem});return a3}function ae(){var a4=aY();$("div#feed").empty();if(a4.length==0){$("div#feed").html("<div class='info'><div class='info-message'>"+Locale.i18n("statsview_no_feeds",true)+"</div></div>");return}var a8,a6,a7,bf,bd,a3,be,a9="";var bc=Locale.i18n("statsview_table_rowclick_title",true);var a5=Locale.i18n("statsview_table_days",true);var ba=Locale.i18n("statsview_table_default",true);a9+="<table class='feedtable'><thead><tr><th></th>";a9+="<th style='text-align: left'>"+Locale.i18n("statsview_table_feedtitle",true)+"</th>";a9+="<th>"+Locale.i18n("statsview_table_properties",true)+"</th>";a9+="<th style='text-align: right'>"+Locale.i18n("statsview_table_latestupdate",true)+"</th>";a9+="<th>"+Locale.i18n("statsview_table_status",true)+"</th>";a9+="<th title='"+Locale.i18n("statsview_table_scandelay_title",true)+"'>"+Locale.i18n("statsview_table_scandelay",true)+"</th>";a9+="<th>"+Locale.i18n("statsview_table_selected",true)+"</th></tr></thead>";a9+="<tbody>";var bb=J().getSettings().getInactiveFeedLimit();for(a8=0;a8<a4.length;a8++){a6=a4[a8];a7="";bf=0;bd=false;if(a6.data.latestitem>0){a3=new Date(a6.data.latestitem);bf=Math.ceil((new Date().getTime()-a3.getTime())/(24*60*60*1000));a7=bf+" "+a5}if(bf>bb||a6.data.status>=400){bd=true}be=a6.data.scandelay?a6.data.scandelay:ba;a9+="<tr class='feedtablerow'><td align='right'>"+(a8+1)+".</td>";a9+="<td><a class='feedlink' title='"+bc+"' id='link-"+(a6.data.id)+"'>"+at(a6.data.name)+"</a></td>";a9+="<td><img data-id='"+a6.data.id+"' class='feedProperties' src='images/settings.png'></td><td align='right'>"+a7+"</td>";a9+="<td align='center'>"+aq(a6.data.status)+"</td>";a9+="<td align='center'>"+be+"</td><td align='center'><input "+(bd?"checked='checked'":"")+" type='checkbox' class='feedcheck' id='noderm-"+a6.data.id+"'/></tr>"}a9+="</tbody>";a9+="</table>";a9+="<center>";a9+="  <button id='removefeeds' class='alertify-button alertify-button-ok'>"+Locale.i18n("statsview_button_deleteselected",true)+"</button>";a9+="  <button id='uncheckall' class='alertify-button alertify-button-ok'>"+Locale.i18n("statsview_button_unselectall",true)+"</button>";a9+="</center>";$("div#feed").append(a9);$("button#uncheckall").click(function(){$(".feedcheck").prop("checked",false)});$("button#removefeeds").click(function(){var bg=$("input[class='feedcheck']:checked:enabled");if(bg.length<1){return}alertify.confirm(Locale.i18n("statsview_confirm_delete",false,bg.length),function(bh){if(bh){bg.each(function(){var bi=$(this).attr("id").substring(7);J().deleteFeed(bi)});$("div#navigator").tree("loadData",U());f();$("div#stats").click()}})});$("img.feedProperties").click(function(bh){bh.preventDefault();var bj=parseInt($(this).attr("data-id"),10);var bg=$("div#navigator").tree("getNodeById",bj);var bi=J().getFeedTree().getNode(bg.id).data;G(bi,bg.parent);return false});$("a.feedlink").click(function(){var bg=parseInt($(this).attr("id").substring(5),10);aH(bg)});$(document).scrollTop(0)}function aH(a7){u();var a6=$("div#navigator");var a5=a6.tree("getNodeById",a7);a6.tree("selectNode",a5);try{var a4=a6;a4.scrollTop($(a5.element).offset().top-a4.offset().top+a4.scrollTop())}catch(a3){n("Failed to scroll feed tree to chosen node")}R({node:{id:a7,type:1}},true)}function a(a4,a3){if(a3==true||a3==1){J().markUnread(a4,0);J().markDeleted(a4,a3);$("div#blogentrypost-"+a4).remove()}}function ac(){var a3=$(this);var a4=parseInt(a3.attr("data-id"),10);J().markUnread(a4,0);$("div#feed > div#blogentrypost-"+a4).removeClass("unread")}function o(a6){var a4=$("div#navigator");var a5=a4.tree("getNodeById",a6);if(!a5){n("Non-existent tree node: "+a6);return}var a3=J();if(a5.type==1){a4.tree("updateNodeLabel",a5,z(a5));if(a5.parent.parent){a3.getFolderUnreadCount(a5.parent.id);a5=a4.tree("getNodeById",a5.parent.id);a4.tree("updateNodeLabel",a5,z(a5))}}else{if(a5.type==2){a3.getFolderUnreadCount(a6);a4.tree("updateNodeLabel",a5,z(a5))}else{n("Unidentified node type: "+a5.type)}}a3.updateTotalUnread()}function a2(a5){var a3=$("div#navigator").tree("getNodeById",a5);var a4=J().getFeedTree().getNode(a3.id).data;if(a3.type==1){alertify.confirm(Locale.i18n("navigator_action_deletefeed_confirm",false,a4.name),function(a7){if(a7){var a6=a3.parent;$("div#navigator").tree("removeNode",a3);J().deleteFeed(a5);if(a6.parent){o(a6.id)}f()}})}else{alertify.confirm(Locale.i18n("navigator_action_deletefolder_confirm",false,a4.name),function(a6){if(a6){$("div#navigator").tree("removeNode",a3);J().deleteFolder(a5);J().updateTotalUnread();f()}})}}function aU(a5){var a3=$("div#navigator").tree("getNodeById",a5);var a4=J().getFeedTree().getNode(a3.id).data;alertify.prompt(Locale.i18n("navigator_action_rename_prompt",false),function(a7,a8){if(a7){var a6=a8;if(a6.length<1||a6.length>60){alertify.error(Locale.i18n("navigator_action_rename_toolong",false,a6.length));return}a4.name=a6;o(a3.id);f()}},a4.name)}function aV(){$("div.entry-body").css({display:(c==feedbro.Engine.VIEWMODE_HEADLINES?"none":"block")});if(c==feedbro.Engine.VIEWMODE_HEADLINES){$("div.entry").addClass("compact-headline")}else{$("div.entry").removeClass("compact-headline")}}function aW(a4,a3){return function(){a4.find("input#feed-url").val($(this).attr("href"));a3.css({display:"none"});a4.find("button#feed-get").click();return false}}function aw(a3){var a4={node:{name:"searchtag"},action:"loadtag",tag:a3};R(a4,true)}function ag(){var a3=J().getTagCloud();var a7=Object.keys(a3);var a6,a5,a4="<div class='feed-header'></div>";M.sortIgnoreCase(a7);if(a7.length>0){a4+="<table class='feedtable tagtable'><thead><tr>";a4+="<th class='feedtableTh tagtableCount'>"+Locale.i18n("tagview_articles_body",true)+"</th>";a4+="<th class='feedtableTh'>"+Locale.i18n("tagview_tag_body",true)+"</th></tr></thead>";a4+="<tbody>";var a8=Locale.i18n("tagview_table_row_title",true);for(a6=0;a6<a7.length;a6++){a5=M.escapeHtml(a7[a6]);a4+="<tr class='feedtablerow'><td class='feedtableTd tagtableCount'>"+a3[a7[a6]]+"</td><td class='feedtableTd'><div class='taglink' data-key='"+a5+"' title='"+a8+"'>"+a5+"</div></td></tr>"}a4+="</tbody>";a4+="</table>"}else{a4+="<div class='info'><div class='info-message'>"+Locale.i18n("tagview_notags_body",true)+"</div></div>"}$("div#feed").empty();$("div#feed").html(a4);$("div#feed").find("div.taglink").click(function(){var a9=$(this).attr("data-key");aw(a9)})}function G(a8,bd){var bb=$("div#feeddialog");a1=a8.id;bb.find("span#feed-alternatives").css({display:"none"});bb.find("input#feed-url").val(a8.url||"");bb.find("input#feed-title").val(a8.name||"");bb.find("span#feed-status").html(a8.status?aq(a8.status):"");bb.find("span#feed-lastposted").html(a8.latestitem>0?M.timeAgo(a8.latestitem):"-");bb.find("input#feed-username").val(a8.username||"");bb.find("input#feed-password").val(a8.password||"");bb.find("select#feed-proxy").val(a8.proxy||0);var a4=J().getFolders();var ba=bd?bd.id:J().getLastFolderId();if(ba==undefined){ba=-1}var a6=bb.find("select#feed-folder");var a5,bc,a7,a3,a9="<option value='-1'>"+Locale.i18n("common_root",true)+"</option>";for(a7=0;a7<a4.length;a7++){a3="";if(a4[a7].id==ba){a3=" selected='selected'"}a9+="<option"+a3+' value="'+a4[a7].id+'">'+a4[a7].name+"</option>"}a6.html(a9);bb.find("select#feed-maxitems").val(a8.maxitems||"default");bb.find("select#feed-scandelay").val(a8.scandelay||"default");bb.find("select#entrycontent").val(a8.entrycontent||"1");bb.css({display:"block"});a5=(window.innerWidth/2)-(bb.outerWidth()/2);bc=(window.innerHeight/2)-(bb.outerHeight()/2);bb.css({top:bc+"px",left:a5+"px"});bb.find("input#feed-url").focus()}function aP(){var bg=$("div#feeddialog");var ba=bg.find("select#feed-maxitems option:selected").val();var bh=bg.find("select#feed-scandelay option:selected").val();var bf=parseInt(bg.find("select#feed-proxy option:selected").val(),10);var bb=J();var a7=bg.find("input#feed-url").val();if(!a7||a7==""||jQuery.trim(a7)==""||a7.length<5){alertify.alert(Locale.i18n("savefeed_error_url",false));return}var bm=bg.find("input#feed-title").val();if(!bm||bm==""||jQuery.trim(bm)==""||bm.length<2){alertify.alert(Locale.i18n("savefeed_error_title",false));return}var bk=bg.find("select#feed-folder").val();var bl=parseInt(bg.find("select#entrycontent").val(),10);bb.setLastFolderId(parseInt(bk,10));var be=bb.getFeedTree().getNode(a1);if(!be){var a3=bb.getNodesWithUrl(a7);if(a3.length>0){be=a3[0];var bi;if(be.parent&&be.parent.data&&be.parent.data.type==2){bi=be.parent.data.name}if(bi){alertify.alert(Locale.i18n("savefeed_error_duplicate_infolder",false,bi,be.data.name))}else{alertify.alert(Locale.i18n("savefeed_error_duplicate",false,be.data.name))}return}var bd=bb.addFeed(a7,bm,bm,bk);if(bk!=-1){$("div#navigator").tree("appendNode",{name:bm,id:bd,type:1},$("div#navigator").tree("getNodeById",bk))}else{$("div#navigator").tree("appendNode",{name:bm,id:bd,type:1})}be=bb.getFeedTree().getNode(bd);be.data.entrycontent=bl;bb.loadFeedItems(bd)}var bj=be.data;if(ba=="default"){ba=undefined}if(bh=="default"){bh=undefined}bj.maxitems=ba;bj.scandelay=bh;bj.proxy=bf;bj.name=bm;bj.url=a7;bj.entrycontent=bl;var a5=bg.find("input#feed-username").val();var a4=bg.find("input#feed-password").val();if(a5&&a5!=""){bj.username=a5;bj.password=a4}var bc=be.parent.data?be.parent.data.id:-1;if(bk!=bc){bb.moveNode(be.data.id,bk,"inside");var a8=$("div#navigator").tree("getNodeById",be.data.id);var a9;if(bk!=-1){a9=$("div#navigator").tree("getNodeById",bk)}else{a9=$("div#navigator").tree("getRoot")}var a6=a8.parent.id;$("div#navigator").tree("moveNode",a8,a9,"inside");o(a8.id);if(a6){o(a6)}}bb.saveData();bg.find("button#feed-cancel").click();if(be){o(be.data.id)}}function ar(a3){if(a3){var a4=J().getSettings().getConfirmMarkReadMode();if(a4==3){alertify.confirm(Locale.i18n("navigator_action_markread_confirm",false,J().getFeedTree().getNode(a3.id).data.name),function(a5){if(a5){J().markAsRead(a3.id);al(a3)}})}else{J().markAsRead(a3.id);al(a3)}}else{alertify.alert(Locale.i18n("navigator_action_markread_noselection",false))}}function x(){var a3=J().getSettings().getConfirmMarkReadMode();if(a3==2||a3==3){alertify.confirm(Locale.i18n("navigator_action_markread_all_confirm",false),function(a4){if(a4){J().markAllAsRead();al()}})}else{J().markAllAsRead();al()}}function al(a3){if($("div#navigator").tree("getSelectedNode")==a3||$("div#mainfunctions div#starreditems").hasClass("menu-selected")||$("div#mainfunctions div#allitems").hasClass("menu-selected")||$("div#mainfunctions div#tagnav").hasClass("menu-selected")){$("div#titles div.item").removeClass("unread")}}function s(){if(H&&H.action=="loadall"){x()}else{ar($("div#navigator").tree("getSelectedNode"))}}function t(a6,a5,a8){if(a6.action=="addfeed"){var a7=J().getFeedTree().getNode(a6.id).data;if(a6.parentid<0){$("div#navigator").tree("appendNode",{name:a7.name,id:a6.id,type:1})}else{var a4=$("div#navigator").tree("getNodeById",a6.parentid);$("div#navigator").tree("appendNode",{name:a7.name,id:a6.id,type:1},a4)}o(a6.id)}else{if(a6.action=="updatenode"){o(a6.id)}else{if(a6.action=="reloaddata"){$("div#navigator").tree("loadData",U())}else{if(a6.action=="updatetheme"){w()}else{if(a6.action=="updateview"){aL()}else{if(a6.action=="updatecss"){ad()}}}}}}if(a8){try{a8()}catch(a3){n(a3)}}}function Y(a3){if(!a3.start){a3.start=0}if(!a3.count){a3.count=30}if(J().isUnreadSearch(a3)&&a3.single!=true){a3.unread=1}chrome.runtime.sendMessage(a3,function(a5){var a4=J().getFeedEntries();W(a3,a4,a4.length<1?{message:Locale.i18n("showarticles_nomatches",true)}:undefined);if(a3.id){o(a3.id)}})}function O(a5,a4){var a3=$("div#blogentrypost-"+a5+" > div.entry-title span.readtoggle-entry-upper > img");a3.attr("src",a4?"images/icon-unread.png":"images/icon-read.png")}function aI(a4){var a5=a4.prop("checked");var a7=parseInt(a4.attr("id").substring(7),10);J().markUnread(a7,a5?1:0);O(a7,a5);var a3=$("div#titles > div.activetitle");if(a3.length>0){if(a5){a3.addClass("unread")}else{a3.removeClass("unread")}}var a6=$("div.entry.active");if(a6.length>0){if(a5){a6.addClass("unread")}else{a6.removeClass("unread")}}}function aN(a6){var a7,a4=a6.attr("id");var a3=$("div.activetitle");if(!a4){return}var a5;if(a4.indexOf("topstar")==0){a7=a4.substring(8);a5=$("span#star-"+a7)}else{a7=a4.substring(5);a5=$("span#topstar-"+a7)}a7=parseInt(a7,10);if(a6.hasClass("starred")){a6.removeClass("starred");a5.removeClass("starred");if(a3.length>0){a3.find("div.item-pin").removeClass("pinned")}}else{a6.addClass("starred");a5.addClass("starred");if(a3.length>0){a3.find("div.item-pin").addClass("pinned")}}J().toggleItemStarred(a7)}function y(){var a4=1024;var a3=850;if(a3>screen.height){a3=screen.height-50}var a6=Math.round((screen.width/2)-(a4/2));var a5=Math.round((screen.height/2)-(a3/2));chrome.windows.create({url:chrome.runtime.getURL("help.html"),type:"popup",width:a4,height:a3,top:a5,left:a6})}function C(ba){var a5,a8,a3,a7,a4,bb,a6=$(ba.target);if(ba.target&&(a6.is("input")||a6.is("select"))){return}if((ba.keyCode==79||ba.keyCode==13)&&ba.shiftKey){a3=$("div#navigator").tree("getSelectedNode");R({node:a3},true);ap(ba)}else{if((ba.keyCode==78||ba.keyCode==40)&&ba.shiftKey){bb=$("div#navigator");a3=bb.tree("getSelectedNode");a7=J().getFeedTree().getNodeSibling(a3.id,2);if(a7){bb.tree("selectNode",bb.tree("getNodeById",a7.data.id))}ap(ba)}else{if((ba.keyCode==80||ba.keyCode==38)&&ba.shiftKey){bb=$("div#navigator");a3=bb.tree("getSelectedNode");a7=J().getFeedTree().getNodeSibling(a3.id,1);if(a7){bb.tree("selectNode",bb.tree("getNodeById",a7.data.id))}ap(ba)}else{if(ba.keyCode==85){an();ap(ba)}else{if(ba.keyCode==87&&!ba.shiftKey&&!ba.ctrlKey&&!ba.altKey&&!ba.metaKey){$("div#togglepanel").click();ap(ba)}else{if(ba.keyCode==88&&ba.shiftKey){bb=$("div#navigator");a3=bb.tree("getSelectedNode");if(!a3){return}var a9=a3.parent;if(!a9.parent){a9=a3}bb.tree(a9.is_open?"closeNode":"openNode",a9,false);bb.tree("selectNode",a9);ap(ba)}else{if(ba.key=="?"||(ba.keyCode==187&&ba.shiftKey)){y();ap(ba)}else{if(ba.keyCode==65&&ba.shiftKey){s();ap(ba)}else{if(ba.keyCode==84&&!ba.shiftKey&&!ba.ctrlKey&&!ba.altKey){aS();ap(ba)}else{if(ba.keyCode==33||(ba.shiftKey&&ba.keyCode==32)){a4=$("div#feed");a4.scrollTop(a4.scrollTop()-a4.height());ap(ba)}else{if(ba.keyCode==34||ba.keyCode==32){a4=$("div#feed");a4.scrollTop(a4.scrollTop()+a4.height());ap(ba)}else{if(!ba.shiftKey&&!ba.ctrlKey&&!ba.altKey&&ba.keyCode==49){au(0);ap(ba)}else{if(!ba.shiftKey&&!ba.ctrlKey&&!ba.altKey&&ba.keyCode==50){au(1);ap(ba)}else{if(!ba.shiftKey&&!ba.ctrlKey&&!ba.altKey&&ba.keyCode==51){au(2);ap(ba)}else{if(!ba.shiftKey&&!ba.ctrlKey&&!ba.altKey&&ba.keyCode==52){au(3);ap(ba)}else{if(!ba.shiftKey&&!ba.ctrlKey&&!ba.altKey&&ba.keyCode==53){au(4);ap(ba)}else{if(!ba.shiftKey&&!ba.ctrlKey&&!ba.altKey&&ba.keyCode==54){au(5);ap(ba)}else{if(ba.altKey&&ba.keyCode==49){a8=J().getSettings().getQuickTag("qtag1");if(a8&&a8!=""){Z(a8)}ap(ba)}else{if(ba.altKey&&ba.keyCode==50){a8=J().getSettings().getQuickTag("qtag2");if(a8&&a8!=""){Z(a8)}ap(ba)}else{if(ba.altKey&&ba.keyCode==51){a8=J().getSettings().getQuickTag("qtag3");if(a8&&a8!=""){Z(a8)}ap(ba)}else{if(ba.altKey&&ba.keyCode==52){a8=J().getSettings().getQuickTag("qtag4");if(a8&&a8!=""){Z(a8)}ap(ba)}else{if(ba.altKey&&ba.keyCode==53){a8=J().getSettings().getQuickTag("qtag5");if(a8&&a8!=""){Z(a8)}ap(ba)}else{if(ba.keyCode==69&&!ba.ctrlKey&&!ba.altKey){a5="entry.active";if(c==2){a5="entry"}$("div."+a5).find("a.share").click();$("div.opt.email").click();ap(ba)}else{if(ba.keyCode==71&&!ba.altKey&&!ba.shiftKey){a5="entry.active";if(c==2){a5="entry"}$("div."+a5).find("a.share").click();$("div.opt.gtranslate").click();ap(ba)}else{if(ba.keyCode==82&&H){aL();ap(ba)}else{if(c==feedbro.Engine.VIEWMODE_OPERA||c==feedbro.Engine.VIEWMODE_OPERA_IFRAME){P(ba)}else{aE(ba)}}}}}}}}}}}}}}}}}}}}}}}}}}}function aL(){R(H,true)}function ap(a4){try{if(a4.preventDefault){a4.preventDefault()}}catch(a3){n("skipDefault failed: "+a3)}}function aE(bc){var a8=$("div.active");var a9,a7,ba;if(bc.keyCode==74||(!bc.shiftKey&&!bc.ctrlKey&&bc.keyCode==78)||(bc.shiftKey&&bc.keyCode==39)){a9=a8.nextAll("div.entry:first");ap(bc)}else{if(bc.keyCode==75||(!bc.shiftKey&&!bc.ctrlKey&&bc.keyCode==80)||(bc.shiftKey&&bc.keyCode==37)){a9=a8.prevAll("div.entry:first");ap(bc)}else{if(bc.keyCode==86&&a8.length>0){chrome.tabs.create({url:a8.find("a.entry-link").attr("href"),active:false},function(bk){});a8.removeClass("unread");try{var a5=a8.attr("id");if(a5){a5=parseInt(a5.substring(a5.indexOf("-")+1),10);J().markUnread(a5,0)}}catch(bd){n("Open post 'v' error: ",bd)}ap(bc)}else{if(!bc.shiftKey&&!bc.ctrlKey&&bc.keyCode==76&&a8.length>0){var bj=a8.find("a.entry-link");var a3=bj.attr("href");var bg=bj.text();h(a3,bg);ap(bc)}else{if((bc.keyCode==13||bc.keyCode==79)&&a8.length>0){if($("section#alertify").hasClass("alertify-confirm")==false){if(c==feedbro.Engine.VIEWMODE_NEWS||c==feedbro.Engine.VIEWMODE_NEWSLINEMODE){if(a8.hasClass("entry-newspaper")){a8.find("div.entry-newspaper-section").click()}else{a8.addClass("entry-newspaper");a8.find("div.entry-newspaper-section").css("display","block");var bb=$("div#feed");var a6=parseInt(bb.css("padding-top"),10);if(isNaN(a6)){a6=0}bb.scrollTop(bb.scrollTop()+Math.round(a8.offset().top)-A()-a6)}}else{a8.find("div.entry-header").click()}ap(bc)}}else{if(bc.keyCode==83&&a8.length>0){var bi=a8.find("> div.entry-body > div.itemlinks > span.star");aN(bi);ap(bc)}else{if(bc.keyCode==68&&bc.shiftKey){$("div.entry").each(function(bk,bm){var bl=$(bm);var bo=bl.attr("id");var bn=bo.indexOf("-");if(bn>0){bo=bo.substring(bn+1);a(bo,1)}});alertify.success(Locale.i18n("navigator_action_deleteall_success",false));ap(bc)}else{if((bc.keyCode==68||bc.keyCode==46)&&!bc.altKey&&!bc.ctrlKey&&a8.length>0){var a4=a8.attr("id");if(a4==undefined){return}var be=a4.indexOf("-");if(be>0){a4=a4.substring(be+1);$("div#blogentrypost-"+a4).hide();if(a8.nextAll("div.entry:first").length>0){C({keyCode:74})}else{C({keyCode:75})}a(a4,1)}ap(bc)}else{if(bc.keyCode==77&&a8.length>0){av(parseInt(a8.attr("data-id"),10));ap(bc)}}}}}}}}}if(a9&&a9.length>0){var bh=$("div#feed");var bf=parseInt(bh.css("padding-top"),10);if(isNaN(bf)){bf=0}a8.removeClass("active");a9.addClass("active");bh.scrollTop(bh.scrollTop()+Math.round(a9.offset().top)-A()-bf)}}function P(bc){var a6=$("div.activetitle");var a8,a5,a9,a7;if(bc.keyCode==74||(!bc.shiftKey&&!bc.ctrlKey&&bc.keyCode==78)||(bc.shiftKey&&bc.keyCode==39)){a8=a6.nextAll("div.item:first");ap(bc)}else{if(bc.keyCode==75||(!bc.shiftKey&&!bc.ctrlKey&&bc.keyCode==80)||(bc.shiftKey&&bc.keyCode==37)){a8=a6.prevAll("div.item:first");ap(bc)}else{if(bc.keyCode==86&&a6.length>0){chrome.tabs.create({url:$("div.entry").find("a.entry-link").attr("href"),active:false},function(bk){});ap(bc)}else{if(bc.keyCode==76&&!bc.altKey&&!bc.ctrlKey&&a6.length>0){var bj=$("div.entry").find("a.entry-link");var a3=bj.attr("href");var be=bj.text();h(a3,be);ap(bc)}else{if(bc.keyCode==83&&a6.length>0){var bh=$("div#feed div.entry-body div.itemlinks span.star");aN(bh);ap(bc)}else{if(bc.keyCode==68&&bc.shiftKey){$("div#titles > div.item[data-key]").each(function(bk,bm){var bl=$(bm);var bn=bl.attr("data-key");a(bn,1);bl.remove()});$("div.entry").remove();alertify.success(Locale.i18n("navigator_action_deleteall_success",false));ap(bc)}else{if((bc.keyCode==68||bc.keyCode==46)&&!bc.altKey&&!bc.ctrlKey&&a6.length>0){var a4=a6.attr("data-key");$("div#blogentrypost-"+a4).hide();if(a6.nextAll("div.item:first").length>0){C({keyCode:74})}else{C({keyCode:75})}a6.remove();a(a4,1);ap(bc)}else{if(bc.keyCode==77&&a6.length>0){av(parseInt($("div.entry").attr("data-id"),10));ap(bc)}}}}}}}}if(a8&&a8.length>0){a6.removeClass("activetitle");a8.addClass("activetitle");var ba=$("div#titles");var bg={top:ba.position().top,left:ba.position().left};bg.bottom=bg.top+ba.height();bg.right=bg.left+ba.width();if(!X(a8,bg)){var bb=a8.position().top;var bd=a8.outerHeight();var bf=bb+bd;var bi=ba.height();if(bf>bi){ba.scrollTop(ba.scrollTop()+bf-bi-A())}else{if(bb<bg.top){ba.scrollTop(ba.scrollTop()-(bg.top-bb))}}}a8.click()}}function h(a4,a6,a3){var a5="https://getpocket.com/edit.php?url="+a4+"&title="+a6;if(a3){a5=a5+"?tags="+encodeURIComponent(a3.replace(/,/g," "))}$.get(a5,function(a9){if(a9.indexOf("You have successfully saved")!=-1){alertify.set({delay:2000});alertify.success(Locale.i18n("article_action_pocket_success",false,a6))}else{var a8=870;var a7=700;var bb=(screen.width/2)-(a8/2);var ba=(screen.height/2)-(a7/2);window.open(a5,"pocket","toolbar=no,scrollbars=0,width="+a8+",height="+a7+",top="+ba+",left="+bb)}})}function X(a5,a3){var a6=$(a5);var a4={top:a6.offset().top,left:a6.offset().left};a4.bottom=a4.top+a6.height();a4.right=a4.left+a6.width();if(a4.top<a3.top||a4.bottom>a3.bottom||a4.left<a3.left||a4.right>a3.right){return false}else{return true}}function l(){G({id:-1000})}function b(){alertify.prompt(Locale.i18n("navigator_action_addfolder_prompt",false),function(a4,a5){if(a4){var a3=a5;if(!a3||a3==""){return}if(a3.length<1||a3.length>35){alertify.error(Locale.i18n("navigator_action_addfolder_toolong",false));return}var a6=J().addFolder(a3);$("div#navigator").tree("appendNode",{name:a3,id:a6,type:2});o(a6);f()}})}function k(a3){var a5=a3.position();var a4=$("div#feedbro-sharebox");a4.css({display:"block",top:(1+a5.top+a3.outerHeight())+"px",left:a5.left+"px"});if(a4.position().top-$(window).scrollTop()+a4.outerHeight()>$(window).height()){a4.css({top:a5.top-a4.outerHeight()-1})}a4.attr("data-url",a3.attr("data-url"));a4.attr("data-title",a3.attr("data-title"));return false}function g(a3){var a5=a3.getAttribute("id");var a4=parseInt(a5.substring(8),10);J().markUnread(a4,0)}function E(a3){var a6,bb,a9,a5,a8=$(a3.target);var ba=false;if(a8.hasClass("star")){aN(a8);ba=true}else{if(a8.hasClass("unreadbox")){aI(a8);ba=true}else{if(a8.hasClass("articletrashicon")||a8.hasClass("articletrash")){B(a3);a3.preventDefault();ba=true}else{if(a8.hasClass("share")){k(a8);ba=true}else{if(a8.hasClass("articlemarkreadicon")){av(parseInt(a8.attr("data-id"),10));ba=true}else{if(a8.hasClass("fromlinefavicon")){aH(parseInt(a8.attr("data-feedid"),10));ba=true}}}}}}if(ba){a3.stopPropagation();return}if(a3.target!=this&&a8.hasClass("itemlinks")==false&&a8.hasClass("entry-title-wrapper")==false&&a8.hasClass("entry-title-wrapper-dummy")==false&&a8.hasClass("entry-header")==false&&a8.hasClass("entry-title")==false&&a8.hasClass("fromline")==false&&a8.hasClass("entry-date")==false&&a8.hasClass("entry-title-td")==false){return}a6=$("div.active");if(a6.length>0){a6.removeClass("active")}a5=$(this);a5.addClass("active");if(c==feedbro.Engine.VIEWMODE_HEADLINES){var a4=a5.find("div.entry-body");var a7=a5.find("td.entry-title-td > div");bb=a4.css("display")||"block";a9=(bb=="none"?"block":"none");if(a9=="block"){aD(a4.find("blockquote:first"))}a4.css({display:a9});if(a9=="block"){a5.removeClass("clickopen");a5.attr("title","");a7.removeClass("entry-title-wrapper");a7.addClass("entry-title-wrapper-dummy")}else{a5.addClass("clickopen");a5.attr("title",Locale.i18n("article_header_clickopen",true));a7.removeClass("entry-title-wrapper-dummy");a7.addClass("entry-title-wrapper")}}}function aC(a4,a3){J().removeTag(a4,a3)}function az(a4,a3){J().addTag(a4,a3)}function ab(a3){aw(a3)}function K(a8){var a5=J().getTagCloud();var a7,a4=Object.keys(a5);var a6=a8.toLowerCase();var a3=[];for(a7=0;a7<a4.length;a7++){if(a4[a7].toLowerCase().indexOf(a6)==0){a3.push(a4[a7])}}return a3}function B(a5){if(c==feedbro.Engine.VIEWMODE_OPERA||c==feedbro.Engine.VIEWMODE_OPERA_IFRAME){C({keyCode:68})}else{var a4=$(a5.target);var a7=a4.attr("data-id");var a6=$("div.entry.active");if(a6.length>0&&a6.attr("id")==("blogentrypost-"+a7)){var a3=a6.next("div.entry");if(a3.length==0){a3=a6.prev("div.entry")}if(a3.length>0){a6.removeClass("active");a3.addClass("active")}}a(a7,1)}a5.stopPropagation();return false}this.setDebug=function(a3){a0=a3};this.previewFeed=function(a4,a5,a7,a6,a3){J().previewFeed(a4,a5,a6,a3,function(a8){var ba={action:"preview",firstload:true};var bc={author:a8.feed.author,title:a8.feed.title,link:a8.feed.link,url:a4,name:a8.feed.title,status:a8.status,latestitem:0};if(a8.feed.latestitemdate){bc.latestitem=a8.feed.latestitemdate.getTime()}var a9,bb=a8.feed.entries.length;for(a9=0;a9<bb;a9++){a8.feed.entries[a9].feed=bc}ba.feed=bc;W(ba,a8.feed.entries);if(a7){a7()}})};function W(a6,a3){S=J().getSettings();if(a6.action=="loadsingle"||a6.action=="preview"){try{var a4=c;c=feedbro.Engine.VIEWMODE_FULL;ao(a6,a3);c=a4}catch(a5){n("displayFeedItems load single failed",a5)}}else{if(c==feedbro.Engine.VIEWMODE_FULL||c==feedbro.Engine.VIEWMODE_HEADLINES||c==feedbro.Engine.VIEWMODE_NEWS||c==feedbro.Engine.VIEWMODE_NEWSLINEMODE){try{ao(a6,a3)}catch(a5){n("displayFeedItemsStandard failed",a5)}}else{if(c==feedbro.Engine.VIEWMODE_OPERA||c==feedbro.Engine.VIEWMODE_OPERA_IFRAME){try{F(a6,a3)}catch(a5){n("displayFeedItemsOpera failed",a5)}}}}V()}function V(){try{feedbro.Youtube.process()}catch(a3){n("Failed to process Youtube video elements",a3)}}function aa(a3){if(a3){$("div#titles").show();$("div#dragbar2").show()}else{$("div#titles").hide();$("div#dragbar2").hide()}}function aO(a5,a4,a8){if(a5.firstload==true){aT.clear();var a7=$("div#titles");a7.find("div.item").removeData("feeditem");a7.empty();var a3=$("div#feed");a3.empty();a3.html("<div class='feed-header'></div>");a3.attr("data-viewmode",(c+1));if(a5.action=="preview"&&a5.feed){if(a5.feed.status!=200){a3.append("<div class='previewheader-error'>"+Locale.i18n("preview_error",true)+": <a rel='noopener noreferrer' href='"+a5.feed.url+"'>"+a5.feed.status+"</a> "+aq(a5.feed.status)+"</div>")}else{a3.append("<div class='previewheader'><div class='previewheader-text'>"+Locale.i18n("preview_header",true)+" <a rel='noopener noreferrer' href='"+a5.feed.url+"'>"+M.escapeHtml(a5.feed.title)+"</a></div><button id='addpreviewfeed' class='alertify-button alertify-button-ok'>"+Locale.i18n("preview_subscribe",true)+"</button></div>");a3.find("button#addpreviewfeed").click(function(){G(a5.feed)})}}else{if(a8){var a6=a8.url?'<div class="info-link"><a href="'+a8.url+'">'+a8.url+"</a></div>":"";a3.append("<br><div class='info'>"+(a8.code?"<div class='info-code'>"+a8.code+"</div>":"")+"<div class='info-message'>"+a8.message+"</div>"+a6+"</div>")}else{if(a4.length<1){a3.append("<div class='info'><div class='info-message'>"+Locale.i18n("showarticles_noentries",true)+"</div></div>");return false}}}r=-1}return true}function ao(bf,a9,a3){aa(false);if(!aO(bf,a9,a3)){return}if(!bf.index){bf.index=0}var a6=J();var bb=a6.getRuleEngine();var bc=a6.getSettings().getDateFormat();var a4=$("div#feed");if(bf.metaStart){bf.start=bf.metaStart}if(bf.metaIndex){bf.index=bf.metaIndex}var a7=bf.index;var be="load-"+(parseInt(bf.start,10)+bf.count)+"-"+bf.count;var ba;var a5,bd,a8=false;for(a5=0;a5<a9.length;a5++,a7++){bd=a9[a5];aQ(bd,a5,a7,bf,ba,bb,bc);if(a5+2==a9.length&&a9.length==bf.count&&bf.action!="preview"){a4.append("<div class='lazyload' id='"+be+"' data-skipuntil='"+a9[a5+1].id+"'></div>");a8=true}}if(bf.firstload==true){a4.scrollTop(0)}if(bf.action!="preview"&&a8){aT.once(be,T(a7,bf,true))}a4.focus();a6.getSoundPlayer().playQueueUniques();aT.addEvents()}function F(a8,bb,bl){var bi,a9="",br,a3,ba,bp,a4,a6;if(a8.metaStart){a8.start=a8.metaStart}if(a8.metaIndex){a8.index=a8.metaIndex}var bo="load-"+(parseInt(a8.start,10)+a8.count)+"-"+a8.count;var a7;var a5=J();var bd=a5.getRuleEngine();var bk=a5.getSettings();var bh=bk.getDateFormat();var bc=bk.getUseFavIconsTitles();var bn;var bm;var bf=$("div#titles");var bj=$("div#feed");var bq=false;aa(true);if(!aO(a8,bb,bl)){return}if(!a8.index){a8.index=0}a7=a8.index;for(bi=0;bi<bb.length;bi++){a3=bb[bi];if(a3.content==p){a5.markUnread(a3.id,0);continue}if(a3.title==undefined||a3.title.length<2){M.fixTitle(a3)}a9="";ba=M.getDateTag(a3.publishedDate.getTime());if(!a8.prevtag||ba.tag!=a8.prevtag.tag){bf.append("<div class='datedivider'>"+ba.tag+"</div>");a8.prevtag=ba}bp=a3.publishedDate.format(ba.format);a9+='<div class="item" data-key="'+a3.id+'">';a9+='<div class="item-title'+(v(a3.title)?" rtl-layout":"")+'" id="item-title-'+a3.id+'">'+aR(M.stripTags(a3.title))+"</div>";a9+='<div class="item-pin"></div>';a9+='<div class="item-author'+(v(a3.feed.title)?" rtl-layout":"")+'">'+(bc?aj(a3.link):"")+aR(M.stripTags(a3.feed.title))+"</div>";a9+='<div class="item-date">'+bp+"</div>";a9+="</div>";a4=$(a9);try{bd.process(feedbro.RuleEngine.EVENT_ITEM_VIEWED,a3,a4,feedbro.RuleEngine.IGNORE_ACTIONS_VIEW)}catch(be){n("ruleEngine.process failed: ",be,bd,a4)}if(a3.starred==1){a4.find("div.item-pin").addClass("pinned")}if(a3.unread==1){a4.addClass("unread")}if(a8.firstload==true&&a6==undefined&&a4.hasClass("item")){a4.addClass("activetitle");bm=a4;a6=true}a4.data("feeditem",jQuery.extend({},a3));bf.append(a4);if(S.getMathJaxEnabled()){try{if(m.shouldRender(a3.title)){m.render("item-title-"+a3.id)}}catch(be){n("Could not render MathJax: ",be)}}if(bi+2==bb.length&&bb.length==a8.count){bf.append("<div class='lazyload' id='"+bo+"' data-skipuntil='"+bb[bi+1].id+"'></div>");bq=true}a4.click(D(bi,a7,a8));a4.bind("contextmenu",aM);a7++}if(bq){aT.once(bo,T(a7,a8,false))}aT.addEvents();if(bm!=undefined&&S.getDisableAutoSelect()!=true){bm.click()}if(a8.firstload==true){bf.scrollTop(0)}}function aM(a5){var a4=$(this);var a3=a4.data("feeditem");chrome.tabs.create({url:a3.link,active:a5.ctrlKey},function(a6){});chrome.extension.getBackgroundPage().feedbrobg.markUnread(a3.id,0);a4.removeClass("unread");a5.preventDefault();a5.stopPropagation();return false}function aj(a3){return'<img src="'+ah.getIconFromGoogleCache(a3)+'" class="titlesfavicon">'}function w(){$("link#theme").attr("href","styles/theme-"+J().getSettings().getTheme()+".css")}function ad(){var a8=J().getSettings();var a3="font-size: "+a8.getArticleBodyFontSize()+"%";var a6="line-height: "+a8.getArticleLineHeight()+"; ";var a5="";a5+="div.entry-body > blockquote { "+a6+a3+"; } div.entry-npsummary { "+a6+a3+" !important; } ";a5+="div#titles div.item, div#feed div.entry { font-family: "+a8.getArticleFontFamily()+" !important; } ";if(a8.getJustifyText()==true){a5+="div#feed > div.entry > div.entry-body > blockquote { text-align: justify; } "}if(a8.getTruncateTitles()==false){a5+=".entry-title-wrapper { white-space: normal !important; overflow: visible !important; } "}var a4,a7;for(a4=1;a4<=6;a4++){a7=a8.getArticleWidth(a4);if(a7!=-1&&a7!="-1"){switch(a4){case 1:case 2:a5+='div#feed[data-viewmode="'+a4+'"] > div.entry { max-width: '+a7+"px; margin-left: auto; margin-right: auto; }";break;case 3:case 4:a5+='div#feed[data-viewmode="'+a4+'"] > div.entry.active { width: '+a7+"px; margin-left: auto; margin-right: auto; }";break;case 5:a5+='div#feed[data-viewmode="'+a4+'"] > div.entry.linemode { width: '+a7+"px; }";break;case 6:a5+='div#feed[data-viewmode="'+a4+'"] > div.entry { max-width: '+a7+"px; margin-left: auto; margin-right: auto; }";break;default:break}}}a7=a8.getTitleFontSize();if(a7!=100){a5+=".entry-link, .entry-nptitle-a { font-size: "+a7+"%; }"}a7=a8.getCardHeight();if(a7!=-1){a5+='div#feed[data-viewmode="4"] > div.entry > .entry-newspaper-section { height: '+a7+"px; }"}$("style#settings").html(a5)}function D(a5,a3,a4){return function(){var a7=$(this);var a9=a7.data("feeditem");var ba=$("div#feed");var a8=J();var bc=S.getMarkReadMode();var a6=S.getDateFormat();var bb=a8.getRuleEngine();ba.empty();aQ(a9,a5,a3,a4,undefined,bb,a6);$("div.item").removeClass("activetitle");a7.addClass("activetitle");if(bc!=3){a8.markUnread(a9.id,0);a7.removeClass("unread")}$("div#feed > div.entry").removeClass("active");ba.scrollTop(0);a8.getSoundPlayer().playQueueUniques();V()}}function T(a3,a4,a5){return function(a9){var a6=a9.getAttribute("id");var a8=parseInt(a9.getAttribute("data-skipuntil"),10);var a7=a6.substring(5).split("-");if(a4.unread==1){a4.start=0;a4.skipUntil=a8;a4.metaStart=parseInt(a7[0],10);a4.metaIndex=a3}else{a4.start=parseInt(a7[0],10);a4.index=a3}a4.count=parseInt(a7[1],10);a4.firstload=false;Y(a4)}}this.engineInit=function(){if(chrome.extension.getBackgroundPage()==null){$("body").css({"background-color":"#25003E"});$("body").html("<div style='font-size: 2em; color: #fff; font-family: \"Open Sans\", sans-serif; position: absolute; width: 700px; height: 150px; top: 50%; left: 50%; margin-left: -350px; margin-top: -75px;'>Feedbro is not available in Private Browsing Mode</div>");return}var a7=J();var a4=a7.getSettings();ah.setSettings(a4);w();ad();Locale.start();Locale.activeMap=a7.getActiveLocaleMap();Locale.translate(true);alertify.set({labels:{cancel:Locale.i18n("dialog_cancel",false),ok:Locale.i18n("dialog_ok",false)}});var a3=$("div#navigator");a3.tree({data:U(),autoEscape:false,slide:false,dragAndDrop:true,selectable:true,onCanMoveTo:function(ba,bb,a9){if(bb.type==1&&a9=="inside"){return false}else{if(ba.type==2&&bb.parent!=null&&(bb.parent.type==2||a9=="inside")){return false}else{return true}}}});$("#markread").click(s);$("#addfeed").click(l);$("#addfolder").click(b);$("div#togglepanel").click(function(){var a9=$("div#leftpane").css("display");a9=(a9=="flex")?"none":"flex";$("div#leftpane").css("display",a9)});$("div#supportfeedbro").click(function(){window.open("https://www.paypal.me/nodetics/5","_blank")});$("div#openfbhelp").click(y);$("div#reloadall").click(function(){alertify.success(Locale.i18n("navigator_action_reload",false));J().scanUnread(true)});$("div#starreditems").click(function(){u();var a9={node:{name:"starred"},action:"loadstarred"};$("div#starreditems").addClass("menu-selected");R(a9,true)});$("div#allitems").click(function(){u();var a9={node:{name:"allitems"},action:"loadall"};$("div#allitems").addClass("menu-selected");R(a9,true)});$("button#prevItem").click(function(){C({keyCode:75})});$("button#nextItem").click(function(){C({keyCode:74})});$("a.link-import").click(function(){af("Feedbro - Options","options.html");return false});$("a.link-addfeed").click(function(){l();return false});$("a.link-addfolder").click(function(){b();return false});$("a.link-settings").click(function(){af("Feedbro - Options","options.html");return false});$("a.link-readall").click(function(){$("div#allitems").click();return false});$("a.link-help").click(function(){y();return false});$("div#stats").click(function(){u();$("div#stats").addClass("menu-selected");aa(false);var a9={node:{name:"feedstats"},action:"feedstats"};R(a9,true)});d=new feedbro.RuleEngineUI();d.setContainerName("div#feed");d.init();$("div#rulenav").click(function(){u();$("div#rulenav").addClass("menu-selected");aa(false);var a9={node:{name:"rulelist"},action:"rulelist"};R(a9,true)});$("div#tagnav").click(function(){u();$("div#tagnav").addClass("menu-selected");aa(false);var a9={node:{name:"tagcloud"},action:"tagcloud"};R(a9,true)});$(document).keydown(C);a3.bind("tree.move",function(bb){bb.preventDefault();var bd=bb.move_info.target_node;var ba=bb.move_info.moved_node;var a9=bb.move_info.position;var bc=ba.parent;if(bd.type==1&&a9=="inside"){alertify.alert(Locale.i18n("navigator_tree_error_underfeed",false));return}if(ba.type==2&&bd.parent!=null&&(bd.parent.type==2||a9=="inside")){alertify.alert(Locale.i18n("navigator_tree_error_underfolder",false));return}bb.move_info.do_move();J().moveNode(ba.id,bd.id,a9);f();o(ba.id);if(bc&&bc.id){o(bc.id)}});a3.bind("tree.open",function(a9){if(a9.node.id){J().getFeedTree().getNode(a9.node.id).data.is_open=true}});a3.bind("tree.close",function(a9){if(a9.node.id){J().getFeedTree().getNode(a9.node.id).data.is_open=false}});a3.bind("tree.contextmenu",function(bc){var bb=bc.node;var a9=bc.click_event.pageX;var be=bc.click_event.pageY;var ba='<div id="contextmenu" style="z-index: 11000; padding: 0px; border: 1px outset white; background-color: #ededed; position: absolute; width: 200px; top: '+be+"px; left: "+a9+'px;">';ba+='<div id="ctx-markread" class="contextitem">'+Locale.i18n("navigator_ctxmenu_markread",true)+"</div>";ba+='<div id="ctx-rename" class="contextitem">'+Locale.i18n("navigator_ctxmenu_rename",true)+"</div>";if(bb.type==2){ba+='<div id="ctx-sortfolderfeeds" class="contextitem">'+Locale.i18n("navigator_ctxmenu_sortfeeds",true)+"</div>"}ba+='<div id="ctx-delete" class="contextitem">'+Locale.i18n("navigator_ctxmenu_delete",true)+"</div>";if(bb.type==1){ba+='<div id="ctx-load" class="contextitem">'+Locale.i18n("navigator_ctxmenu_updatefeed",true)+"</div>";ba+='<div id="ctx-properties" class="contextitem">'+Locale.i18n("navigator_ctxmenu_properties",true)+"</div>"}else{if(bb.type==2){ba+='<div id="ctx-loadfolderfeeds" class="contextitem">'+Locale.i18n("navigator_ctxmenu_updatefolder",true)+"</div>"}}ba+="</div>";$("div#contextmenu").remove();var bd=$(ba);$("body").append(bd);if((be+bd.height())>$(window).height()){bd.css({top:be-bd.height()})}bd.bind("contextmenu",function(bf){return false});bd.find("div#ctx-delete").click(function(){n("Delete "+bb.id);a2(bb.id)});bd.find("div#ctx-rename").click(function(){n("Rename "+bb.id);aU(bb.id)});bd.find("div#ctx-markread").click(function(){n("Mark read "+bb.id);ar(bb)});if(bb.type==1){bd.find("div#ctx-load").click(function(){alertify.success(Locale.i18n("navigator_ctxmenu_updatefeed_success",false));J().loadFeedItems(bb.id)});bd.find("div#ctx-properties").click(function(){var bf=J().getFeedTree().getNode(bb.id).data;G(bf,bb.parent)})}else{if(bb.type==2){bd.find("div#ctx-loadfolderfeeds").click(function(){alertify.success(Locale.i18n("navigator_ctxmenu_updatefolder_success",false));J().loadFolderFeeds(bb.id)});bd.find("div#ctx-sortfolderfeeds").click(function(){J().sortFolder(bb.id)})}}});$("select#itemage").val(a4.getMaxItemAge());$("select#itemage").change(function(){J().getSettings().setMaxItemAge($(this).val());J().saveSettings()});$("select#itemsortorder").val(a4.getItemSortOrder());$("select#itemsortorder").change(function(){J().getSettings().setItemSortOrder($(this).val());J().saveSettings()});aA(a4.getOnlyUnread());$("div#unreadtoggle").click(function(){an()});au(a4.getViewMode(),true);var a5=$("div#feeddialog");a5.keydown(function(a9){a9.stopPropagation()});a5.find("button#feed-cancel").click(function(){$("div#feeddialog").css({display:"none"})});a5.find("button#feed-save").click(aP);a5.find("button#feed-preview").click(function(){var ba=a5.find("input#feed-url").val();var bb=parseInt(a5.find("select#entrycontent").val(),10);var bc=a5.find("input#feed-username").val();var a9=a5.find("input#feed-password").val();if(ba!=undefined&&ba.length>0){a5.css({cursor:"wait"});aG.previewFeed(ba,bb,function(){a5.css({cursor:"default"})},bc,a9)}});a5.find("button#feed-get").click(function(){var ba=a5.find("input#feed-url").val();if(!ba||ba==""){alertify.alert(Locale.i18n("addfeed_load_error_nourl",false));return}a5.css({cursor:"wait"});var bb=a5.find("input#feed-username").val();var a9=a5.find("input#feed-password").val();J().findFeeds(ba,bb,a9,function(bc){a5.css({cursor:"default"});if(bc.length==0){alertify.alert(Locale.i18n("addfeed_load_error_invalidurl",false,ba))}if(bc.length==1){a5.css({cursor:"wait"});J().previewFeed(bc[0].href,1,bb,a9,function(bh){a5.css({cursor:"default"});var bi=bh.feed.title||"";a5.find("input#feed-url").val(bc[0].href);a5.find("span#feed-status").html(aq(bh.status));a5.find("input#feed-title").val(bi);a5.find("span#feed-lastposted").html(bh.feed.latestitemdate?M.timeAgo(bh.feed.latestitemdate.getTime()):"-");if(bh.error){alertify.alert(Locale.i18n("addfeed_load_error_loadfailed",false,bc[0].href,bh.error.code,bh.error.message))}})}if(bc.length>1){var bf,be="";var bd=a5.find("span#feed-alternatives");var bg=a5.find("input#feed-url");bd.css({display:"block",width:bg.outerWidth()});for(bf=0;bf<bc.length;bf++){be+="<div class='feed-alternative' id='select-feed-"+bf+"' href='"+bc[bf].href+"' title='"+Locale.i18n("addfeed_alternatives_clicktip",true)+"'><a href='#'>["+bc[bf].type+"] "+bc[bf].title+"</a></div>"}bd.html(be);for(bf=0;bf<bc.length;bf++){bd.find("div#select-feed-"+bf).click(aW(a5,bd))}}})});$("div#feedbro-sharebox > div.opt").click(function(){var bf=$(this).attr("class");var bb=bf.substring(4);var ba=q[bb];var bg=$("div#feedbro-sharebox");ba=ba.replace("{URL}",encodeURIComponent(bg.attr("data-url")));ba=ba.replace("{TITLE}",encodeURIComponent(bg.attr("data-title")));var bc=870;var bi=700;var bd=(screen.width/2)-(bc/2);var bh=(screen.height/2)-(bi/2);var be;if(bb=="email"){$('<iframe src="'+ba+'" style="display: none" id="mailTrigger">').appendTo("body");setTimeout(function(){$("iframe#mailTrigger").remove()},4000)}else{if(bb=="gtranslate"){var a9=J().getSettings().getTargetLanguage();ba=ba.replace("{TOLANG}",a9?a9:"en");be=window.open(ba,"_blank")}else{be=window.open(ba,bb,"toolbar=no,scrollbars=0,width="+bc+",height="+bi+",top="+bh+",left="+bd)}}bg.css({display:"none"});return false});$(document).click(function(a9){$("div#contextmenu").remove();if($(a9.target).prop("class")!="share"){$("div#feedbro-sharebox").css({display:"none"})}});a3.bind("tree.click",R);$("div#normalview").click(function(){au(0)});$("div#headlineview").click(function(){au(1)});$("div#3cola").click(function(){au(2)});$("div#newsview").click(function(){au(3)});$("div#newslinemode").click(function(){au(4)});$("div#3colaiframe").click(function(){au(5)});$("div#reload").click(function(){aL()});$("div#prevItem").click(function(){C({keyCode:75})});$("div#nextItem").click(function(){C({keyCode:74})});$("div#gotosettings").click(function(){document.location.href="/options.html"});$("div#dragbar1").mousedown(function(a9){I(a9,"div#leftpane","div#titles")});$("div#dragbar2").mousedown(function(a9){I(a9,"div#titles","div#feed")});$("div#leftpane").css("width",a4.getNavigatorWidth());$("div#titles").css("width",a4.getTitlesWidth());if(a7.isInitialized()==false){alertify.error(Locale.i18n("startup_error_background",false));return}if(a7.getFeedEntryManagerErrorStatus()!=0){alertify.alert(Locale.i18n("startup_error_indexeddb",false));return}chrome.runtime.onMessage.addListener(t);window.addEventListener("beforeunload",e);aX.init();L.configure({remove:aC,add:az,search:ab,autocomplete:K});n("Engine init done.");aJ();var a6=new feedbro.Strings();var a8=a6.getQueryParams(document.location.search);if(a8&&a8.article!=undefined){Q();Y({articleid:parseInt(a8.article,10),single:true,action:"loadsingle",firstload:true})}else{if(a8&&a8.preview!=undefined){Q();$("div#feed").html("<div class='previewheader'>"+Locale.i18n("preview_loading",true)+"</div>");aG.previewFeed(a8.preview)}else{if(a4.getStartPageAllItems()==true){$("div#allitems").click()}}}};function e(){window.feedbro=undefined;window.feedbroengine=undefined;window.MathJax=undefined;window.removeEventListener("beforeunload",e);S=undefined;aX=undefined;i=undefined;d=undefined;aT.clear();aT=undefined;L.destroy();L=undefined;J().saveData()}function aJ(){try{if(navigator.userAgent.indexOf("Firefox")!=-1){$("a#feedbro-feedback").attr("href","https://addons.mozilla.org/firefox/addon/feedbroreader/")}}catch(a3){n("Failed to update feedback link")}}function Q(){try{history.pushState({},"Feedbro","reader.html")}catch(a3){}}function A(){return $("div#toolbar").outerHeight()}function I(a8,a5,a6){a8.preventDefault();var a9=$(a8.target),a4=$(a6),a7=$(a5);var a3=$("<div>",{id:"ghostbar",css:{height:a9.height(),top:a9.offset().top,left:a8.pageX}}).appendTo("body");$(document).mousemove(function(ba){a3.css("left",ba.pageX)});$(document).mouseup(function(ba){a7.css("width",ba.pageX-a7.offset().left);$(document).unbind("mousemove");$(document).unbind("mouseup");a3.remove();aZ()})}function aZ(){var a4=parseInt($("div#leftpane").width(),10);var a5=parseInt($("div#titles").width(),10);var a3=J().getSettings();a3.setNavigatorWidth(a4);a3.setTitlesWidth(a5);J().saveSettings()}function ay(ba,a8){var a6,a7="";var a9,a4;try{var a3=M.findImages(ba.content,6);a7+=" <div class='entry-newspaper-section'>";a7+=" <div class='entry-nptitle"+(M.isTextRTL(ba.title,true,100)?" rtl-layout":"")+"'><a class='entry-nptitle-a' data-id='"+ba.id+"' rel='noopener' title='"+Locale.i18n("article_header_clicktip",true)+"' href='"+ba.link+"'>"+aR(M.stripTags(ba.title))+"</a></div>";a7+=" <div class='entry-sourceline'><div class='entry-source'><a class='entry-source-link' href='"+ba.feed.link+"'>"+aR(M.stripTags(ba.feed.title))+"</a></div> <div class='timeago'>"+M.timeAgo(ba.publishedDate)+"</div></div>";a6=M.htmlText(ba.content,a8?350:180,"...");a9=" <div title='"+Locale.i18n("article_header_clickopen",true)+"' class='entry-npsummary"+(M.isTextRTL(a6,true)?" rtl-layout":"")+(a8?" linemode":"")+"'>"+a6+"</div>";if(a3.length>0){a4=" <div class='entry-npmainimage"+(a8?" linemode":"")+"'><img class='entry-npmainimage-img' src='"+a3[0].s+"'></div>"}else{a4=" <div class='entry-npmainimage"+(a8?" linemode":"")+"'></div>"}if(a8){a7+=a4+a9}else{a7+=a9+a4}a7+=" </div>"}catch(a5){n("could not create news html",a5)}return a7}function aK(a3){return"<a class='share' data-url='"+at(a3.link)+"' data-title='"+at(a3.title)+"' title='"+Locale.i18n("article_links_sendto_title",true)+"'>"+Locale.i18n("article_links_sendto_body",true)+" &gt;</a>"}function aQ(bn,bk,a7,bb,bo,be,bi){var bj,bq,bl,bc,bm,a8,a5,bf,bh,a3,a9,a6;var br="";var bp="";if(a7==undefined){a7=0}if(bn.content==p){J().markUnread(bn.id,0);return}if(bn.title==undefined||bn.title.length<2){M.fixTitle(bn)}r=bn.id;if(!bn.feed){bn.feed={}}bj="entry";if(c==feedbro.Engine.VIEWMODE_HEADLINES){bj=bj+" clickopen compact-headline";br=Locale.i18n("article_header_clickopen",true)}if(c==feedbro.Engine.VIEWMODE_NEWS){bj+=" entry-newspaper";bp=ay(bn,false)}if(c==feedbro.Engine.VIEWMODE_NEWSLINEMODE){bj+=" entry-newspaper linemode";bp=ay(bn,true)}if(c==feedbro.Engine.VIEWMODE_OPERA_IFRAME){bj+=" iframe-content"}bq="star";bl="style='display: "+(c==feedbro.Engine.VIEWMODE_HEADLINES?"none":"block")+"'";a6="<div class='readtrigger' id='trigger-"+bn.id+"'></div>";var bd=S.getMarkReadMode();var a4="";if(bb.action!="preview"){a4="<div class='itemlinks noPrint' id='item-"+bn.id+"'><span id='star-"+bn.id+"' class='"+bq+"' title='"+Locale.i18n("article_links_addstar",true)+"'>&nbsp;</span> "+aK(bn)+ai(bn,bd==3)+aB(bn)+ak(bn)+"</div>"}bc=$("<div id='blogentrypost-"+bn.id+"' data-id='"+bn.id+"' class='"+bj+"' title='"+br+"'>"+ax(bn,a7+1,bi,bb)+(bd==1?a6:"")+bp+"<div class='entry-body' "+bl+"><blockquote class='entry-blockquote' id='content-"+bn.id+"'></blockquote>"+(bd==2?a6:"")+a4+"</div></div>");try{be.process(feedbro.RuleEngine.EVENT_ITEM_VIEWED,bn,bc,feedbro.RuleEngine.IGNORE_ACTIONS_VIEW)}catch(bg){n("ruleEngine.process failed: "+bg)}try{j(bn)}catch(bg){n("convertSrcAttributess failed: "+bg)}a3=bc.find("blockquote#content-"+bn.id);if(c==feedbro.Engine.VIEWMODE_OPERA_IFRAME){a3.addClass("iframe-content");a3.append("<iframe src='"+bn.link+"' class='feedbroviewmode6iframe' sandbox='allow-scripts allow-forms' referrerpolicy='no-referrer'></iframe>")}else{a3.append(bn.content)}bc.find("img").on("error",function(bs){bs.target.style.display="none"});bc.find("div.entry-title a.entry-link").click(ac);bc.find("div.entry-nptitle > a").click(ac);if(M.isTextRTL(bn.content,true,100)){a3.addClass("rtl-layout")}if(bn.starred==1){bc.find("span#topstar-"+bn.id).addClass("starred");bc.find("span#star-"+bn.id).addClass("starred")}if(bn.unread==1){bc.addClass("unread")}if(bb.firstload==true&&bb.activelink==undefined&&bc.hasClass("entry")){bc.addClass("active");bb.activelink=true}try{L.createSelector(bc.find("div.tags"),bn.tags)}catch(ba){n("Error: cannot initialize tag selector for entry "+bn.id)}bc.click(E);if(c==feedbro.Engine.VIEWMODE_NEWS||c==feedbro.Engine.VIEWMODE_NEWSLINEMODE){bc.find("div.entry-newspaper-section").click(am)}try{bf=bn.enclosures;if(bf!=undefined&&Array.isArray(bf)&&bf.length>0){for(bh=0;bh<bf.length;bh++){a9=bf[bh];if(a9==undefined){continue}if(a9.url!=undefined){a9.url=aR(a9.url)}if(a9.type!=undefined){a9.type=aR(a9.type)}if(a9.length!=undefined){a9.length=aR(a9.length)}a3.append(i.createTag(bn.id+"-"+bh,a9))}}}catch(bg){n("Error: could not initialize enclosure for entry: "+bn.id)}$("div#feed").append(bc);if(S.getMathJaxEnabled()){try{if(m.shouldRender(bn.title)||m.shouldRender(bn.content)){m.render("blogentrypost-"+bn.id)}}catch(bg){n("Could not render MathJax: "+bg)}}if(bb.action!="preview"&&bn.unread==1&&bd!=3){aT.once("trigger-"+bn.id,g)}}function am(a5){var a6=$(this);var a4=a6.parent();if($(a5.target).is("a")){return}aD(a4.find("div.entry-body > blockquote:first"));a4.removeClass("entry-newspaper");a6.css("display","none");$("div.active").removeClass("active");a4.addClass("active");var a3=$("div#feed");a3.scrollTop(a3.scrollTop()+parseInt(a4.offset().top,10)-parseInt($("div#toolbar").outerHeight(),10)-1)}function av(a9){var a7=$("div#blogentrypost-"+a9);try{var a4=a7.find("span.readtoggle-entry-upper > img");var a8=a4.attr("src")=="images/icon-read.png";var a6=a7.find("div.itemlinks > span.keepunread > input.unreadbox");var ba=parseInt(a6.attr("id").substring(7),10);J().markUnread(ba,a8?1:0);var a3=$("div#titles > div.activetitle");if(a3.length>0){if(a8){a3.addClass("unread")}else{a3.removeClass("unread")}}if(a8){a7.addClass("unread");a4.attr("src","images/icon-unread.png");a6.prop("checked",true)}else{a7.removeClass("unread");a4.attr("src","images/icon-read.png");a6.prop("checked",false)}}catch(a5){n(a5)}}function j(a3){if(c==feedbro.Engine.VIEWMODE_NEWS||c==feedbro.Engine.VIEWMODE_NEWSLINEMODE||c==feedbro.Engine.VIEWMODE_HEADLINES){if(a3.content){a3.content=a3.content.replace(M.getRegexp("<(img|iframe|audio|video|embed)([^>]*)src=([^>]*)","gi"),function(a7,a6,a5,a4){var a8="<"+a6+a5+"data-lazysingle="+a4;a8=a8.replace(/srcset=/g,"data-lazymulti=");return a8})}}}function aD(a3){a3.find("[data-lazysingle],[data-lazymulti]").each(function(a5,a6){var a4;a4=a6.getAttribute("data-lazymulti");if(a4!=undefined&&a4!=""){a6.setAttribute("srcset",a4)}a4=a6.getAttribute("data-lazysingle");if(a4!=undefined&&a4!=""){a6.setAttribute("src",a4)}})}function ax(a7,a4,a3,a6){var a5="";a5+='<div class="entry-title'+(v(a7.title)?" rtl-layout":"")+'">';if(a6.action!="preview"){a5+='<table border="0" width="100%" class="entry-table"><tr><td class="entry-title-td">';if(c==feedbro.Engine.VIEWMODE_HEADLINES){a5+='<div class="entry-title-wrapper">'}else{a5+='<div class="entry-title-wrapper-dummy">'}a5+='<a data-id="'+a7.id+'" class="entry-link" href="'+a7.link+'" target="_blank" rel="noopener" title="'+Locale.i18n("article_header_clicktip",true)+'">'+aR(M.stripTags(a7.title))+"</a> ";if(a7.points!=undefined&&a7.points!=0){a5+='<span class="feedbro-points" title="'+Locale.i18n("article_header_pointstip",true)+'">('+a7.points+")</span>"}a5+="</div>";a5+='</td><td class="entry-title-topcorner">';a5+='<span id="topstar-'+a7.id+'" class="star" title="'+Locale.i18n("article_links_addstar",true)+'">&nbsp;</span>';a5+='<span class="readtoggle-entry-upper noPrint" title="'+Locale.i18n("article_header_markread_title",true)+'"><img data-id="'+a7.id+'" src="images/icon-'+(a7.unread?"unread":"read")+'.png" class="articlemarkreadicon"></span>';a5+='<span class="delete-entry-upper noPrint" title="'+Locale.i18n("article_action_delete_title",true)+'"><img data-id="'+a7.id+'" src="images/trash.png" class="articletrashicon"></span>';a5+="</td></tr></table>"}else{a5+='<a data-id="'+a7.id+'" class="entry-link" href="'+a7.link+'" target="_blank" rel="noopener" title="'+Locale.i18n("article_header_clicktip",true)+'">'+aR(M.stripTags(a7.title))+"</a> "}a5+='</div><div class="entry-header">';a5+='<div class="fromline">';if(S.getFaviconOnFromline()){a5+='<img title="'+Locale.i18n("article_fromline_clicktoload",true)+'" data-feedid="'+a7.feedid+'" class="fromlinefavicon" src="'+ah.getIconFromGoogleCache(a7.link)+'">'}a5+=Locale.i18n("article_fromline_from",true)+' <div class="entry-bloglink makeinline'+(v(a7.feed.title)?" rtl-layout":"")+'"><a class="entry-bloglink-a" target="_blank" href="'+a7.feed.link+'">';a5+=aR(M.stripTags(a7.feed.title))+"</a></div>";if(a7.author!=undefined&&a7.author!=""){a5+=" "+Locale.i18n("article_fromline_by",true)+' <div class="entry-author makeinline'+(v(a7.author)?" rtl-layout":"")+'">'+aR(M.stripTags(a7.author))+"</div>"}a5+='</div><div class="entry-date">'+aF(a7.publishedDate,a3)+'</div><div class="entry-number"> # '+a4+".</div></div>";return a5}function aF(a4,a3){if(a4!=undefined&&a3!=undefined){return a4.format(a3)+" ("+M.timeAgo(a4)+") "}else{return""}}function v(a3){return M.isTextRTL(a3,true,100)}function au(a5,a3){var a4=c;c=a5;$("div.mode").removeClass("active-mode");$("div#feed").attr("data-viewmode",(c+1));if(a5==0){$("div#normalview").addClass("active-mode");aa(false);aV()}else{if(a5==1){$("div#headlineview").addClass("active-mode");aa(false);aV()}else{if(a5==2){$("div#3cola").addClass("active-mode");aa(true)}else{if(a5==3){aa(false);$("div#newsview").addClass("active-mode")}else{if(a5==4){aa(false);$("div#newslinemode").addClass("active-mode")}else{if(a5==5){$("div#3colaiframe").addClass("active-mode");aa(true)}}}}}}if((a4==feedbro.Engine.VIEWMODE_OPERA||a4==feedbro.Engine.VIEWMODE_OPERA_IFRAME||a4==feedbro.Engine.VIEWMODE_NEWS)&&(a5==feedbro.Engine.VIEWMODE_HEADLINES||a5==feedbro.Engine.VIEWMODE_FULL)){aL()}else{if((a5==feedbro.Engine.VIEWMODE_OPERA||a5==feedbro.Engine.VIEWMODE_OPERA_IFRAME)&&(a4==feedbro.Engine.VIEWMODE_HEADLINES||a4==feedbro.Engine.VIEWMODE_FULL||a4==feedbro.Engine.VIEWMODE_NEWS||a4==feedbro.Engine.VIEWMODE_NEWSLINEMODE)){aL()}else{if(a5==feedbro.Engine.VIEWMODE_NEWS&&a4!=feedbro.Engine.VIEWMODE_NEWS){aL()}else{if(a5==feedbro.Engine.VIEWMODE_NEWSLINEMODE&&a4!=feedbro.Engine.VIEWMODE_NEWSLINEMODE){aL()}else{if((a5==0||a5==1)&&(a4!=0&&a4!=1)){aL()}else{if(a5==feedbro.Engine.VIEWMODE_FULL&&a4==feedbro.Engine.VIEWMODE_HEADLINES){$("blockquote.entry-blockquote").each(function(a6,a7){aD($(a7))})}}}}}}if(a3!=true){J().getSettings().setViewMode(c);J().saveSettings()}}function an(){var a3=!$("input#onlyunread").prop("checked");aA(a3);J().getSettings().setOnlyUnread(a3);J().saveSettings()}function aA(a3){if(a3==true){$("div#unreadtoggle").addClass("active-mode");$("input#onlyunread").prop("checked",true)}else{$("div#unreadtoggle").removeClass("active-mode");$("input#onlyunread").prop("checked",false)}}function Z(a5){var a3=$("div#feed > div.entry.active > div.entry-body > div.itemlinks > div.tags");if(a3.length==0){a3=$("div#feed > div.entry > div.entry-body > div.itemlinks > div.tags")}if(a3.length==0){return}var a4=a3.find(".tagicon");a4.click();a3.find("input").val(a5+"");a3.find(".tagadd").click();a4.click()}function aS(){var a3=$("div#feed > div.entry.active > div.entry-body > div.itemlinks > div.tags");if(a3.length==0){a3=$("div#feed > div.entry > div.entry-body > div.itemlinks > div.tags")}if(a3.length==0){return}if(!a3.is(":visible")){return}a3.find(".tagicon").click()}};feedbro.Engine.VIEWMODE_FULL=0;feedbro.Engine.VIEWMODE_HEADLINES=1;feedbro.Engine.VIEWMODE_OPERA=2;feedbro.Engine.VIEWMODE_NEWS=3;feedbro.Engine.VIEWMODE_NEWSLINEMODE=4;feedbro.Engine.VIEWMODE_OPERA_IFRAME=5;var feedbro=feedbro||{};feedbro.FaPlugin=function(){};feedbro.FaPlugin.prototype.canParse=function(a){return a&&a.indexOf("facebook.com/")!=-1};feedbro.FaPlugin.METACACHE={};feedbro.FaPlugin.prototype.parse=function(e,c,a,f){var b=this;var d=new XMLHttpRequest();d.onerror=function(){a.error={};a.error.message="Network error";a.error.code=398;a.status=398};d.onreadystatechange=function(n){var m=n.target;if(m.readyState==4){m.onreadystatechange=null;if(m.status!=0){m.onerror=null}if(m.status==200){var i=b.getPageData(m.responseURL,m.responseText);var o=m.responseURL;var j=[];try{if(i.old){j=b.parseHtml(m.responseText)}else{j=b.parseHtmlNew(m.responseText)}}catch(k){}var l=o&&o.indexOf("facebook.com/groups/")!=-1;var g=o&&o.indexOf("facebook.com/lists/")!=-1;var h=(o=="https://www.facebook.com/?sk=nf")||(o=="https://www.facebook.com/?sk=h_chr");if(!i.old&&l){b.graphqlGroup(i.pageid,function(p){c(e.url,m,feedbro.Strings.toRSS(i.title,m.responseURL,b.parseGraphQlStories(p)),a,f,true)})}else{if(l||g||h){c(m.responseURL,m,feedbro.Strings.toRSS(i.title,m.responseURL,j),a,f,true)}else{if(i.old&&i.pageid!=0){b.loadArticles(i.pageid,i.title,10,e.url,j,c,a,f)}else{if(j.length>0){c(m.responseURL,m,feedbro.Strings.toRSS(i.title,m.responseURL,j),a,f,true)}else{c(e.url,m,"",a,f,true)}}}}}else{c(e.url,m,"",a,f,true)}}};d.withCredentials=true;d.open("GET",e.url,true);d.setRequestHeader("Accept","text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9");d.setRequestHeader("Accept-Language","en-US,en;q=0.5");d.timeout=25000;d.send()};feedbro.FaPlugin.prototype.getPageData=function(a,g){var h;h=feedbro.FaPlugin.METACACHE[a];if(h){return h}var i=new feedbro.Strings();try{var c={stag:["<title",">"],etag:"</title>",spos:0};var f,d,b;b=g.substring(0,50).indexOf('<!DOCTYPE html><html id="facebook"')==0;i.findNext(g,c);f=c.match;if(f!=null){f=i.unescapeHtml(f)}if(f!=null){d=f.match(/^\(\d+\) (.*)/);if(d&&d.length>1){f=d[1]}}c.spos=0;c.stag=['"fb://'];c.etag='"';i.findNext(g,c);if(c.match){d=c.match.match(/(\d+)/);h={pageid:d[1],title:f,old:!b};feedbro.FaPlugin.METACACHE[a]=h;return h}c.spos=0;c.stag=['"pageID":"'];c.etag='"';i.findNext(g,c);if(c.match!=undefined){h={pageid:c.match,title:f,old:!b};feedbro.FaPlugin.METACACHE[a]=h;return h}c.spos=0;c.stag=['http-equiv="refresh" content="0; URL='];c.etag='"';i.findNext(g,c);if(c.match){d=c.match.match(/.+?(\d+)/);h={pageid:d[1],title:f,old:!b};feedbro.FaPlugin.METACACHE[a]=h;return h}h={pageid:0,title:f};feedbro.FaPlugin.METACACHE[a]=h;return h}catch(e){h={pageid:0,title:"Not Found"};feedbro.FaPlugin.METACACHE[a]=h;return h}};feedbro.FaPlugin.prototype.loadArticles=function(b,e,d,a,c,i,j,f){var h=this;var g=new XMLHttpRequest();if(c==null){c=[]}g.onreadystatechange=function(q){var p=q.target;var l,s,m,r,n;if(p.readyState==4){p.onreadystatechange=null;p.onabort=null;if(p.status==200){r=p.responseText;n=[];l=r.indexOf("{");try{s=JSON.parse(r.substring(l));m=s.domops[0][3]["__html"];n=h.parseHtml(m)}catch(o){}var t,k={};for(l=0;l<c.length;l++){t=h.getCleanLink(c[l].link);k[t]=true}for(l=0;l<n.length;l++){t=h.getCleanLink(n[l].link);if(k[t]==null){c.push(n[l])}}r=null;m=null;s=null;i(a,p,feedbro.Strings.toRSS(e,a,c),j,f,true)}else{i(a,p,"",j,f,true)}}};g.withCredentials=true;g.open("GET","https://www.facebook.com/pages_reaction_units/more/?page_id="+b+"&cursor=%7B%22card_id%22%3A%22page_recommendations%22%2C%22has_next_page%22%3Atrue%7D&surface=www_pages_home&unit_count="+d+"&referrer&fb_dtsg_ag&__user=0&__a=1&__dyn=1&__comet_req=0",true);g.timeout=25000;g.setRequestHeader("Accept","*/*");g.setRequestHeader("Accept-Language","en-US,en;q=0.5");g.send()};feedbro.FaPlugin.prototype.getCleanLink=function(c){if(c==undefined){return null}var b=c.indexOf("__xts");if(b==-1){return c}if(c.charAt(b-1)=="?"){return c.substring(0,b-1)}else{return c.substring(0,b-5)}};feedbro.FaPlugin.prototype.parseHtml=function(j){var n='<div class="_5pcr';var d=new feedbro.Strings();var f={stag:[n],etag:"<div><form ",prefix:n,postfix:"</div>"};var r={stag:['data-utime="'],etag:'"'};var h={stag:['<span class="fsm fwn fcg">',"<a",'href="'],etag:'"'};var q={stag:['<span class="fwb',"<a",">"],etag:"<"};var p={stag:['<span class="fwb',"<span",">"],etag:"<"};var e='<div data-testid="post_message"';var i='<div class="mtm">';var l='<div class="_5mly';var m='<a class="see_more_link';var a="https://www.facebook.com";var g=/href="\//gm;var o,b,c;var k=[];while(true){d.findNext(j,f);if(f.match==undefined){break}r.spos=0;h.spos=0;q.spos=0;q.match=null;p.spos=0;p.match=null;d.findNext(f.match,r);d.findNext(f.match,h);d.findNext(f.match,q);if(q.match==null){d.findNext(f.match,p);c=p.match}else{c=q.match}if(h.match&&h.match.indexOf("https://")!=0){h.match=a+h.match}o=d.getHtmlBlockString(f.match,e);o+="<div>"+d.getHtmlBlockString(f.match,i)+"</div>";o=d.stripHtmlBlock(o,l);o=d.stripHtmlBlock(o,m);o=o.replace(g,'href="'+a+"/");b={publishedDate:new Date(parseInt(r.match,10)*1000),author:(c||""),link:this.getCleanLink(h.match),content:o};d.fixTitle(b);k.push(b)}return k};feedbro.FaPlugin.prototype.parseHtmlNew=function(h){var g='"__typename":"Story"';var b,a,e,d=0,f;var c=[];while(true){b=h.indexOf(g,d);if(b<0){break}e=1;for(a=b;a<h.length;a++){if(h.charAt(a)=="{"){e++}if(h.charAt(a)=="}"){e--}if(e==0){break}}var k=JSON.parse("{"+h.substring(b,a)+"}");f=this.parseJsonStory(k);if(f){c.push(f)}d=a}return c};feedbro.FaPlugin.prototype.parseJsonStory=function(a){var c,d;if(a.__isFeedUnit=="Story"){c={content:"",link:null,publishedDate:null,author:null};d=a.comet_sections.context_layout.story.comet_sections;try{if(d.timestamp){c.publishedDate=new Date(d.timestamp.story.creation_time*1000);c.link=d.timestamp.story.url+"?__cft[0]__="+a.encrypted_click_tracking;c.author=d.actor_photo.story.actors[0].name;if(a.comet_sections.content.story.comet_sections.message){c.content="<div class='facebook-post-text'>"+feedbro.Strings.linkify(a.comet_sections.content.story.comet_sections.message.story.message.text)+"</div>"}c.content+=this.getAttachment(this.getContext(a,"comet_sections.content"),0);c.content+=this.getAttachment(this.getContext(a,"comet_sections.content"),1);c.content+=this.getAttachment(this.getContext(a,"comet_sections.content.story.comet_sections.attached_story.story.attached_story.comet_sections.attached_story_layout"));c.content+=this.getEmbeddedArticle(a)}}catch(b){}}return c};feedbro.FaPlugin.prototype.parseGraphQlStories=function(g){var d,h,f,a=[];try{var c=JSON.parse(g);for(d=0;d<c.length;d++){h=c[d];if(h.data&&h.data.node&&h.data.node.__typename=="Story"){f=this.parseJsonStory(h.data.node);if(f){a.push(f)}}}}catch(b){}return a};feedbro.FaPlugin.prototype.getEmbeddedArticle=function(i){var j=this.getContext(i,"comet_sections.content.story.comet_sections.attached_story.story.attached_story.comet_sections.attached_story_layout.story");if(j==null){return""}var b=j.comet_sections.actor_photo.story.actors[0].name;var d=j.comet_sections.actor_photo.story.actors[0].profile_picture.uri;var a=j.comet_sections.timestamp.story.creation_time;var g=j.comet_sections.timestamp.story.url;var f=feedbro.Strings.linkify(j.message.text);var h=j.comet_sections.attached_story_title.story.to.name;var e=j.comet_sections.attached_story_title.story.to.url;var c="";c+="<div class='facebook-embedded-article'>";c+="<div>"+b+"</div><div>"+h+"</div>";c+="<div>"+a+"</div>";c+="<div>"+f+"</div>";c+="</div>";return c};feedbro.FaPlugin.prototype.getContext=function(f,e){var b,d=e.split(".");var a,c=/(\w+)\[(\d+)\]/;for(b=0;b<d.length;b++){a=d[b].match(c);if(a){f=f[a[1]];if(f.length&&f.length>a[2]){f=f[parseInt(a[2],10)]}else{return null}}else{f=f[d[b]]}if(f==null){return null}}return f};feedbro.FaPlugin.prototype.getAttachment=function(b,a){if(a==undefined){a=0}if(b&&b.story.attachments&&b.story.attachments.length>0&&b.story.attachments.length>a){var c=b.story.attachments[a].style_type_renderer.attachment;var e;if(c&&c.media&&c.media.large_share_image){return this.createImageContainer(c.media.large_share_image.uri,c.story_attachment_link_renderer.attachment.url,c.title_with_entities.text)}else{if(c&&c.media&&c.media.photo_image){return this.createImageContainer(c.media.photo_image.uri,c.media.url,"")}else{if(c&&c.media&&c.media.playable_url_quality_hd){var g=c.media.thumbnailImage.uri;e="<div class='facebook-video'>";e+="<div class='youtubevideo' data-link='"+c.media.playable_url_quality_hd+"'><img src='"+g+"' class='thumb'><div class='play'></div></div>";e+="</div>";return e}else{if(b.story.attachments[a].style_type_renderer.cover_photo&&b.story.attachments[a].style_type_renderer.cover_photo.photo){return this.createImageContainer(b.story.attachments[a].style_type_renderer.cover_photo.photo.image.uri,b.story.attachments[a].style_type_renderer.url,"")}else{if(c&&c.title_with_entities&&c.target&&c.target.formatted_price){e="<div class='facebook-auctionitem-title'>"+c.title_with_entities.text+": "+c.target.formatted_price.text+"</div>";if(c.properties&&c.properties.length>7){e+="<div class='facebook-auctionitem-description'>"+feedbro.Strings.linkify(c.properties[7].value.text)+"</div>"}return e}else{if(c&&c.all_subattachments&&c.all_subattachments.nodes){var d,f;e="<div class='facebook-multiple-images'>";for(d=0;d<c.all_subattachments.nodes.length;d++){f=c.all_subattachments.nodes[d];if(f.media){e+="<div class='facebook-multimedia'>";e+="<a rel='noreferrer noopener' target='_blank' href='"+f.url+"'>";e+="<img src='"+f.media.image.uri+"'>";e+="</a></div>"}}e+="</div>";return e}}}}}}}return""};feedbro.FaPlugin.prototype.createImageContainer=function(b,d,e,a){var c="<div class='facebook-embedded-article'>";c+="<a target='_blank' rel='noopener noreferrer' href='"+d+"'>";c+="<div class='facebook-embedded-article-image'><img class='facebook-embedded-article-image' src='"+b+"'></div>";c+="<div class='facebook-embedded-article-title'>"+e+"</div>";c+="</a></div>";return c};feedbro.FaPlugin.prototype.graphqlGroup=function(b,e){var c=4961189247240696;b=parseInt(b,10);var a="av=0&__user=0&__a=1&__dyn=7&variables=";var d={UFI2CommentsProvider_commentsKey:"CometGroupDiscussionRootSuccessQuery",count:11,displayCommentsContextEnableComment:null,displayCommentsContextIsAdPreview:null,displayCommentsContextIsAggregatedShare:null,displayCommentsContextIsStorySet:null,displayCommentsFeedbackContext:null,feedLocation:"GROUP",feedType:"DISCUSSION",feedbackSource:0,focusCommentID:null,isComet:true,privacySelectorRenderLocation:"COMET_STREAM",renderLocation:"group",scale:1,sortingSetting:null,stream_initial_count:0,useDefaultActor:false,id:b};a+=encodeURIComponent(JSON.stringify(d))+"&server_timestamps=true&doc_id="+c;this.graphqlFetch("https://www.facebook.com/groups/"+b+"/",a,e)};feedbro.FaPlugin.prototype.graphqlPublicPageOrList=function(b,d,f){var c,a;c=3042098185916095;a="av=0&__user=0";a+="&__a=1&__ccg=EXCELLENT";a+="&__hsi="+b+"-0";a+="&__spin_t="+(new Date().getTime()/1000);a+="&fb_api_called_class=RelayModern&fb_api_req_friendly_name=CometNotificationsDropdownQuery";a+="&__dyn=7&variables=";var e={count:15,environment:"MAIN_SURFACE",scale:1};a+=encodeURIComponent(JSON.stringify(e))+"&server_timestamps=true&doc_id="+c;this.graphqlFetch("https://www.facebook.com/",a,f)};feedbro.FaPlugin.prototype.graphqlFetch=function(b,a,c){fetch("https://www.facebook.com/api/graphql/",{headers:{accept:"*/*","accept-language":"en-GB,en-US;q=0.9,en;q=0.8,fi;q=0.7,de;q=0.6","cache-control":"no-cache","content-type":"application/x-www-form-urlencoded",pragma:"no-cache","sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin"},referrer:b,referrerPolicy:"no-referrer-when-downgrade",body:a,method:"POST",mode:"cors",credentials:"omit"}).then(function(d){return d.text()}).then(function(d){c("["+d.split("\n").join(",")+"]")})["catch"](function(d){c(undefined)})};var feedbro=feedbro||{};feedbro.FeedEntryManager=function(b){var m=this;var n;var h=b;var g=new feedbro.DbIndex("index");var l=function(o){feedbro.log("IndexedDB error: ",o)};var j;var c=0;function f(){return chrome.extension.getBackgroundPage().feedbrobg}this.getErrorStatus=function(){return c};this.getDbIndex=function(){return g};this.getConnection=function(){return m.db};this.openConnection=function(p){var o=indexedDB.open(h,1);o.onblocked=l;o.onerror=function(q){c=1;console.log("IndexedDB error: ",q)};o.onupgradeneeded=function(t){var q=o.result;var s=q.createObjectStore("entries",{keyPath:"id",autoIncrement:true});var r=q.createObjectStore("meta",{keyPath:"id",autoIncrement:false});console.log("openConnection: database "+h+" created.")};o.onsuccess=function(q){m.db=o.result;console.log("openConnection: database "+h+" opened.");m.countData();if(p){p()}}};this.countData=function(){var p=m.db.transaction(["entries","meta"]);var q=p.objectStore("entries").count();var o=p.objectStore("meta").count();q.onsuccess=function(r){console.log("Entry count: "+r.target.result)};o.onsuccess=function(r){console.log("Meta count: "+r.target.result)}};this.closeConnection=function(o){if(m.db){m.db.close();feedbro.log("Database connection closed.")}};this.clear=function(o){m.getTransaction(["entries","meta"],"readwrite",function(p){p.objectStore("entries").clear();p.objectStore("meta").clear();g.clear();p.onerror=l;p.oncomplete=function(){feedbro.log("Database cleared.");if(o){o()}}})};this.init=function(r){console.time("feedEntryManager.init");var o=m.db.transaction(["meta"]);var p=o.objectStore("meta");var q=p.openCursor();q.onerror=l;q.onsuccess=function(s){var u=s.target.result;if(u){var t=u.value;g.add(t.id,t.timestamp,t.feedid,t.folderid,t.unread,t.starred,t.tags,t.link,t.points,t.guid);u["continue"]()}};o.oncomplete=function(s){feedbro.log("feedEntryManager.init: database "+h+" index lookup initialized. Size: "+g.size());console.timeEnd("feedEntryManager.init");if(r){r()}}};this.getEntry=function(p,o){m.getTransaction(["entries"],"readonly",function(q){var r=q.objectStore("entries");var s=r.get(p);s.onsuccess=function(t){o(t.target.result)}})};this.getFeedEntries=function(o,q){var p=g.query(o);m.getTransaction(["entries"],"readonly",function(r){var t=r.objectStore("entries");var s=[];for(var u=0;u<p.length;u++){var x=p[u];var w=g.get(x);if(!w||w.purge==1){continue}var v=t.get(x);v.onerror=function(y){feedbro.log(" getFeedEntries: store.get failed!")};v.onsuccess=(function(z,D,C,E,y,A,B){return function(G){var F=G.target.result;if(F){F.unread=z;F.starred=D;F.folderid=E;F.feedid=y;F.tags=A;F.points=B;s.push(F)}else{feedbro.log("feed item not found: "+C)}}})(w.unread,w.starred,x,w.folderid,w.feedid,w.tags,w.points)}r.oncomplete=function(y){q(s)};r.onerror=function(y){feedbro.log(" getFeedEntries: transaction failed!");q(s)}})};this.saveFeedEntries=function(p,o,s,q,r){if(p.length<1){r({feedid:o});return}m.getTransaction(["entries","meta"],"readwrite",function(u){var y=u.objectStore("entries");var t=u.objectStore("meta");var A=f().getRuleEngine();d(g,p,o);for(var w=p.length-1;w>=0;w--){var x=p[w];var v=x.oldmeta;if(v){delete x.oldmeta}var z;z=y.put(x);z.onerror=l;z.onsuccess=(function(C,E,B,D){return function(I){var K=(0+E.result);if(D==undefined){C.id=K}var J={id:C.id+0,timestamp:C.publishedDate.getTime(),unread:1,starred:0,feedid:o,folderid:s,tags:[],points:0,guid:C.guid+""};if(C.generatedDate){J.link=C.link+""}if(D){J.tags=D.tags.slice();J.starred=D.starred+0;J.unread=D.unread+0;C.unread=D.unread+0;if(D.purge){J.purge=(D.purge||0)+0}C.starred=D.starred+0}else{C.starred=0;C.unread=1}m.addToIndex(J);C.folderid=s;C.feedid=o;try{var F;if(D){F=feedbro.RuleEngine.IGNORE_ACTIONS_UPDATED}else{if(B){F=feedbro.RuleEngine.IGNORE_ACTIONS_ARRIVE_FIRSTLOAD}else{F=feedbro.RuleEngine.IGNORE_ACTIONS_ARRIVE}}A.process(feedbro.RuleEngine.EVENT_ITEM_ARRIVED,C,undefined,F)}catch(G){feedbro.log("ruleEngine processing failed: "+G)}J=g.get(C.id);if(J!=undefined){var H=t.put(J);H.onerror=function(L){feedbro.log("failed to update meta data for ",J,L)};H.onsuccess=function(L){}}else{feedbro.log("saveFeedEntries: meta data missing from index with key: "+C.id)}}})(x,z,q,v)}u.oncomplete=function(B){f().getSoundPlayer().playQueueUniques();r({feedid:o})}})};function d(t,v,o){var q,s={},u,w=[];for(q=v.length-1;q>=0;q--){u=v[q].guid;if(u!=undefined){s[u]=v[q]}}var p,x,r=Object.keys(s);for(q=0;q<r.length;q++){x=t.getGuid(o,r[q]);if(x){p=s[x.guid];p.id=x.id+0;p.oldmeta={unread:x.unread+0,starred:x.starred+0,purge:x.purge,tags:x.tags.slice()};w.push(p.id)}}if(w.length>0){t.remove(w)}}this.moveFeed=function(o,p){g.moveFeed(o,p)};this.markRead=function(o){o.unread=1;g.query(o,function(p){p.unread=0;p.dirty=1})};this.save=function(){m.getTransaction(["entries","meta"],"readwrite",function(r){var q=r.objectStore("meta");var p=0;var o={updated:0};var t;var v=function(){};t=g.query({purge:1});if(t.length>0){var s=r.objectStore("entries");var u=t.slice();e(q,s,t,function(){g.remove(u)})}t=g.query({dirty:1});if(t.length>0){k(q,t,o,v)}})};this.deleteFeedEntries=function(o){return g.query(o,function(p){p.purge=1})};this.getFeedEntryMeta=function(o){return g.get(o)};this.updateFeedEntryMeta=function(q,o){var p=g.get(q);if(p){if(o.hasOwnProperty("unread")&&o.unread!=p.unread){p.unread=o.unread;p.dirty=1}if(o.hasOwnProperty("starred")&&o.starred!=p.starred){p.starred=o.starred;p.dirty=1}if(o.hasOwnProperty("purge")&&o.purge!=p.purge){p.purge=o.purge;p.dirty=1}}};this.addToIndex=function(o){g.add(o.id,o.timestamp,o.feedid,o.folderid,o.unread,o.starred,o.tags,o.link,o.points,o.guid,o.purge)};this.queryIndex=function(o){return g.query(o)};this.getTagCloud=function(o){return g.getTagCloud(o)};this.getTransaction=function(r,p,s){var o;try{o=m.db.transaction(r,p);s(o)}catch(q){feedbro.log("getTransaction error: ",q);setTimeout(function(){m.openConnection(function(){m.getTransaction(r,p,s)})},1000)}};function e(o,r,q,u){if(q.length>0){var t=q.shift();var p=o["delete"](t);p.onerror=l;var s=r["delete"](t);s.onerror=l;s.onsuccess=function(v){e(o,r,q,u)}}else{u()}}function i(p,q,o,u){if(q.length>0){var t=q.shift();var s=g.get(t);if(!s||s.purge==1){feedbro.log(" loadEntry: Could not find index meta data with ID "+t);i(p,q,o,u)}else{var r=p.get(t);r.onsuccess=function(w){var v=r.result;if(!v){feedbro.log("Could not find a feed entry with ID "+t)}if(v){v.unread=s.unread;v.starred=s.starred;v.points=s.points;o.push(v)}i(p,q,o,u)};r.onerror=function(v){feedbro.log(" loadEntry: FAILED to load "+t+" event: "+v);i(p,q,o,u)}}}else{u(o)}}function k(p,q,o,t){if(q.length>0){var s=q.shift();var r=g.get(s);if(r&&r.purge!==1){r.dirty=0;o.updated++;p.put(r)}k(p,q,o,t)}else{t(o.updated)}}function a(p,r,o,t){if(r.length>0){r.sort(function(v,u){return v-u});var q=IDBKeyRange.bound(r[0],r[r.length-1]);var s=p.openCursor(q);s.onsuccess=function(u){var w=u.target.result;var x=r.shift();if(w){var v=g.get(x);if(v&&v.purge!==1){v.dirty=0;w.update(v);o.updated++}}if(r.length>0){w["continue"](r[0])}else{t(o.updated)}};s.onerror=l}else{t(o.updated)}}};var feedbro=feedbro||{};feedbro.FeedFinder=function(){var g;var f;this.init=function(){g=$(".feedFinderQ");f=$(".feedfinder");f.mouseenter(function(h){f.addClass("show")});$(".feedFinderSearch").click(c);g.on("keyup",function(h){if(h.keyCode==13){c()}});$(".closeFeedFinder").click(function(){f.css("display","none")});$("#findfeed").click(function(){f.addClass("show");f.css("display","block");g.focus();g.select()})};function c(){var h=parseInt($(".daysSinceLastUpdate").val(),10);f.addClass("show").css("cursor","wait");g.css("cursor","wait");b("#feedFinderResults",g.val(),$(".lang").val(),200,h)}function a(){return chrome.extension.getBackgroundPage().feedbrobg}function b(n,i,k,m,p){var l=-1;var r=encodeURIComponent(i);var h=new Date().getTime();var t=new feedbro.Strings();var s="https://feedly.com/v3/search/feeds";var o="&fullTerm=false&organic=true&promoted=true&useV2=true&ct=feedly.desktop&cv=31.0.242";var j=new Date().getTime();if(p>0){l=j-(p*24*60*60*1000)}$.ajax({url:s+"?q="+r+"&n="+m+"&locale="+k+"&ck="+h+o}).done(function(u){f.css("cursor","default");g.css("cursor","default");var w="",v,y,z=0,x,B=u.results;var q=Locale.i18n("feedfinder_alreadysubscribed_title",true);var A=Locale.i18n("feedfinder_action_preview",true);for(v=0;v<B.length;v++){y=B[v];if(l&&l>0&&y.lastUpdated<l){continue}z++;x=y.feedId.substring(5);w+="<div class='feed'>";w+="<table class='feedSearchResultTable'><tbody><tr class='feedSearchEntry'>";w+="  <td class='rowCount'>"+z+"</td>";w+="  <td class='feedIcon'>";w+="     "+(y.iconUrl?"<img class='feedIconImg' src='"+t.escapeHref(y.iconUrl)+"'>":"");w+="  </td>";w+="  <td>";w+="    <div class='feedTitle' dir='auto'><a class='feedTitleLink' href='"+y.website+"' target='_blank' rel='noopener noreferrer'>"+t.escapeHtml(y.title)+"</a></div>";w+="    <div class='feedDescription' dir='auto'>"+t.escapeHtml(y.description?t.stripTags(y.description):"")+"</div>";w+="    <div class='feedTags' dir='auto'>"+(y.deliciousTags?e(y.deliciousTags,t):"")+"</div>";w+="  </td>";w+="  <td class='feedUpdated'>";w+="    "+t.timeAgo(y.lastUpdated,true);w+="  </td>";w+="  <td class='feedActions'>";if(d(x)){w+="    <div class='feedAction-added' title='"+q+"'></div>"}else{w+="    <a class='feedSubscribe' target='feedbro' href='"+t.escapeHref(x)+"'>"+A+"</a>"}w+="  </td>";w+="</tr></tbody></table>";w+="</div>"}if(z==0){w+="<div class='feedFinderInfo'>"+Locale.i18n("feedfinder_error_noresults",true)+"</div>"}$(n).empty();$(n).html(w).scrollTop(0);$("a.feedSubscribe").click(function(C){C.target.classList.add("visited");C.preventDefault();var E=C.target.getAttribute("href");f.removeClass("show");try{window.feedbroengine.previewFeed(E,1)}catch(D){console.log("Failed to preview feed",D)}})}).fail(function(q,v,u){console.log("Feed finding failed: "+v+": "+u)})}function d(h){return a().getFeedTree().searchNodes({type:1,url:h}).length>0}function e(j,h){var l,k="";for(l=0;l<j.length;l++){k+="<span class='feedTag'>"+h.escapeHtml(j[l])+"</span>"}return k}};var feedbro=feedbro||{};feedbro.FeedIconManager=function(){var a;this.setSettings=function(b){a=b};this.save=function(){};this.load=function(){};this.clearCache=function(){};this.getIconFromGoogleCache=function(c){if(c==""||c==undefined){c="https://www.example.com/"}var d;try{d=new URL(c).hostname}catch(b){d="www.example.com"}if(a&&a.getFavIconProvider()=="duckduckgo"){return"https://icons.duckduckgo.com/ip3/"+d+".ico"}else{return"https://www.google.com/s2/favicons?domain="+d}}};var feedbro=feedbro||{};feedbro.FeedlyPlugin=function(){this._strings=new feedbro.Strings()};feedbro.FeedlyPlugin.prototype.canParse=function(a){return a&&a.indexOf("feedsrc=feedly")!=-1};feedbro.FeedlyPlugin.prototype.parse=function(e,c,a,f){var b=this;var d=new XMLHttpRequest();d.onreadystatechange=function(h){var g=h.target;if(g.readyState==4){d.onreadystatechange=null;if(g.status==200){var i="";try{i=b.toRSS(g.responseText,e.url)}catch(j){feedbro.log("Failed to parse: "+e.url)}c(e.url,g,i,a,f,true)}else{c(e.url,g,"",a,f,true)}}};d.open("GET",this.getFeedlyUrl(e.url,e.datelimit,e.maxEntries),true);d.timeout=120000;d.setRequestHeader("Cache-Control","no-cache");d.send()};feedbro.FeedlyPlugin.prototype.getFeedlyUrl=function(c,a,b){c=c.replace(/.feedsrc=feedly/,"");return"https://cloud.feedly.com/v3/streams/contents?streamId=feed%2F"+encodeURIComponent(c)+"&count="+(b?b:20)+(a?"&newerThan="+(a+1):"")};feedbro.FeedlyPlugin.prototype.toRSS=function(f,c){var b='<?xml version="1.0" encoding="UTF-8"?>\n<rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/">\n<channel>\n';var e,h,a,d=JSON.parse(f);b+="  <link><![CDATA["+d.alternate.href+"]]></link>\n";b+="  <title><![CDATA["+d.title+"]]></title>\n";a=d.items;var g;for(e=0;e<a.length;e++){h=a[e];if(h.content&&h.content.content){g=h.content.content}else{if(h.summary&&h.summary.content){g=h.summary.content}else{g=""}}b+="  <item>\n";b+="    <title><![CDATA["+h.title+"]]></title>\n";b+="    <link><![CDATA["+h.alternate[0].href+"]]></link>\n";b+="    <pubDate>"+new Date(parseInt(h.published,10))+"</pubDate>\n";b+="    <content:encoded><![CDATA["+g+"]]></content:encoded>\n";b+="    <author><![CDATA["+(h.author!=undefined?h.author:"")+"]]></author>\n";b+="  </item>\n"}b+="\n</channel>\n</rss>";return b};var feedbro=feedbro||{};feedbro.FeedParser=function(a){this.url=a;this.linkConverter=/<([^<>]*) (src|href)=["'](?!http|data|magnet|mailto)([^"']+)["']([^<>]*)>/gi;this.maxEntries=20;this.timeout=20000;this.fullFeed=false;this.addmetaimageMode=true;this.debugMode=false;this._strings=new feedbro.Strings();this.plugins=[new feedbro.InPlugin(),new feedbro.TwPlugin(),new feedbro.LiPlugin(),new feedbro.FaPlugin(),new feedbro.YoPlugin(),new feedbro.FeedlyPlugin(),new feedbro.SlidesharePlugin(),new feedbro.YammerPlugin(),new feedbro.VkPlugin(),new feedbro.TePlugin(),new feedbro.RumblePlugin()]};feedbro.FeedParser.prototype.setDebugMode=function(a){this.debugMode=a};feedbro.FeedParser.prototype.setMaxEntries=function(a){this.maxEntries=a};feedbro.FeedParser.prototype.setTimeout=function(a){if(!isNaN(a)&&a>1000){this.timeout=a}else{this.debug("FeedParser: invalid timeout value: "+a)}};feedbro.FeedParser.prototype.setFullFeed=function(a){this.fullFeed=a};feedbro.FeedParser.prototype.setEntryDateLimit=function(a){if(a){this.datelimit=a}};feedbro.FeedParser.prototype.setLastModifiedHeader=function(a){if(a!="undefined"){this.lastModifiedHeader=a}};feedbro.FeedParser.prototype.setETagHeader=function(a){if(a!="undefined"){this.etagHeader=a}};feedbro.FeedParser.prototype.setAuthentication=function(a,b){this.username=a;this.password=b};feedbro.FeedParser.prototype.setAddMetaImage=function(a){this.addmetaimageMode=a};feedbro.FeedParser.prototype.setIndex=function(a){this.dbIndex=a};feedbro.FeedParser.skipTags={category:true,contributor:true,generator:true,logo:true,rights:true,subtitle:true,source:true,comments:true,language:true,copyright:true,webMaster:true,docs:true,lastBuildDate:true,cloud:true,ttl:true,image:true,rating:true,skipHours:true,skipDays:true,textInput:true};feedbro.FeedParser.prototype.setMaxEntries=function(a){this.maxEntries=a};feedbro.FeedParser.prototype.handleLoadFeedData=function(u,g,D,p,i){if(this.debugMode){console.time("handleLoadFeedData")}var h=this.identifyFeed(D);u.feed.type=h.type;u.feed.version=h.version;if(this.debugMode){this.debug(h)}if(h.type=="unknown"){u.error={};u.error.message="Unsupported Content-Type: "+p.getResponseHeader("Content-Type");u.error.code=602;u.status=602;i(u);return}var k=this._strings;var E,n,G,B,s,A,a,l,t;var F=this.url.indexOf("youtube.com/")!=-1;var d=this.url.indexOf("youtube.com/results?")!=-1;var C=this.url.indexOf("vimeo.com/")!=-1;var r=this.url.indexOf("bitchute.com/")!=-1;var z=new Date().getTime();var o=0;var q=false;var m,e;if(h.type=="atom"){var y="atom:";if(h.version=="0.3"){y="atom03:"}E=D.getChild(y+"feed");u.feed.title=D.getChildString(y+"title",E);u.feed.author=D.getChildString(y+"author/"+y+"name",E);var f,c=D.getAll(y+"link",E);for(var x=0;x<c.length;x++){f=c[x].getAttribute("type");if(c[x].getAttribute("rel")=="alternate"&&(f=="text/html"||f==undefined)){u.feed.link=c[x].getAttribute("href")+"";break}}s=y+"entry"}else{if(h.type=="rss"){E=D.getChild("rss/channel");u.feed.title=D.getChildString("title",E);u.feed.author=D.getChildString("managingEditor",E);u.feed.link=D.getChildString("link",E);s="item"}else{if(h.type=="rdf"){E=D.getChild("rdf:RDF");if(E.getAttribute("xmlns")=="http://my.netscape.com/rdf/simple/0.9/"){u.feed.title=D.getChildString("rss09:channel/rss09:title",E);u.feed.author=D.getChildString("dc:creator",E);u.feed.link=D.getChildString("rss09:channel/rss09:link",E);s="rss09:item"}else{u.feed.title=D.getChildString("rss10:channel/rss10:title",E);u.feed.author=D.getChildString("dc:creator",E);u.feed.link=D.getChildString("rss10:channel/rss10:link",E);s="rss10:item"}}}}a=this.createBase(this.url,undefined,E.getAttribute("xml:base"));try{if(u.feed.title==null||u.feed.title==""){u.feed.title="Untitled feed"}}catch(w){}try{q=this.isReverseFeed(D,E,s,k)}catch(w){}if(!q){n=E.firstElementChild}else{n=E.lastElementChild}while(E!=undefined){if(n==undefined){break}if(feedbro.FeedParser.skipTags[n.nodeName]){if(!q){n=n.nextElementSibling}else{n=n.previousElementSibling}continue}G=D.mapNodeName(n.nodeName);if(G==s){var b={link:undefined,title:"No Title",author:"",publishedDate:undefined,content:undefined};o++;l=this.createBase(this.url,a,n.getAttribute("xml:base"));e=null;B=n.firstElementChild;while(true){if(B==undefined){break}if(feedbro.FeedParser.skipTags[B.nodeName]){B=B.nextElementSibling;continue}G=D.mapNodeName(B.nodeName);switch(G){case"author":case"dc:creator":case"rdf:author":case"rss10:author":b.author=B.textContent+"";break;case"atom:author":case"atom03:author":b.author=D.getChildString("name",B);break;case"atom:link":case"atom03:link":if(B.getAttribute("rel")=="alternate"&&(B.getAttribute("type")=="text/html"||B.getAttribute("type")==undefined)){b.link=this.toAbsoluteUrl(B.getAttribute("href"),l)}else{if(B.getAttribute("rel")=="enclosure"){this.getEnclosure(b,B,"href",l)}else{if(b.link==undefined){b.link=this.toAbsoluteUrl(B.getAttribute("href"),l)}}}break;case"link":case"rdf:link":case"rss10:link":case"rss09:link":if(B.textContent!=""){b.link=this.toAbsoluteUrl(B.textContent,l)}break;case"title":case"rss10:title":case"rss09:title":case"rdf:title":case"atom:title":case"atom03:title":b.title=B.textContent+"";break;case"content:encoded":e="text";m=B;break;case"description":case"rdf:description":case"rss09:description":case"rss10:description":if(b.content==undefined||b.content==""){e="text";m=B}break;case"atom:summary":case"atom03:summary":if(b.content==undefined||b.content==""){e="atom";m=B}break;case"atom:content":case"atom03:content":if(B.getAttribute("src")==undefined){e="atom";m=B}break;case"pubDate":case"atom:published":case"dc:date":case"atom03:published":b.publishedDate=B.textContent+"";break;case"atom:modified":case"atom:updated":case"atom03:modified":case"atom03:updated":if(b.publishedDate==undefined){b.publishedDate=B.textContent+""}break;case"enc:enclosure":case"rdf:enclosure":this.getEnclosure(b,B,"resource",l);break;case"enclosure":case"media:content":this.getEnclosure(b,B,"url",l);break;case"guid":case"atom03:id":case"atom:id":b.guid=B.textContent+"";break;default:break}B=B.nextElementSibling}if(b.publishedDate!=undefined){b.publishedDate=k.parseDate(b.publishedDate)}if(this.isValidDate(b.publishedDate)){b.publishedDate.setMilliseconds(0)}b.link=this.toAbsoluteUrl(b.link,l);if(b.guid==undefined){b.guid=b.link}if(F==false||d){this.ensurePublishedDate(b,o)}var v=true;if(this.datelimit&&b.publishedDate&&b.publishedDate.getTime()<=this.datelimit){v=false}if(b.publishedDate&&(b.publishedDate.getTime()>z)){v=false}if(b.publishedDate==undefined){v=false}if(!v){if(!q){n=n.nextElementSibling}else{n=n.previousElementSibling}continue}if(e=="atom"){if(A==undefined){A=new XMLSerializer()}this.getContent(D,b,m,A)}else{if(e=="text"){b.content=m.textContent+""}else{b.content=""}}if(F){this.parseYoutubeVideo(D,n,b)}if(C){this.parseVimeoVideo(D,n,b)}if(r){this.parseBitchuteVideo(D,n,b)}this.fixContent(m,b,l);u.feed.entries.push(b);if(u.feed.entries.length>=this.maxEntries){break}}if(!q){n=n.nextElementSibling}else{n=n.previousElementSibling}}if(u.feed.entries.length>0){u.feed.entries.sort(this.articleSorter)}this.decodeFeedCharacters(u);D.trash();D=null;p.onreadystatechange=null;p.abort=null;p=null;if(this.debugMode){console.timeEnd("handleLoadFeedData")}};feedbro.FeedParser.prototype.isReverseFeed=function(h,f,g,j){var d,c,e,i,a,b;d=f.firstElementChild;while(true){if(d==undefined){break}if(feedbro.FeedParser.skipTags[d.nodeName]){d=d.nextElementSibling;continue}c=h.mapNodeName(d.nodeName);if(c==g){e=d;break}d=d.nextElementSibling}d=f.lastElementChild;while(true){if(d==undefined){break}if(feedbro.FeedParser.skipTags[d.nodeName]){d=d.previousElementSibling;continue}c=h.mapNodeName(d.nodeName);if(c==g){i=d;break}d=d.previousElementSibling}if(e==i||e==null||i==null){return false}a=j.parseDate(this.getItemDate(h,e));b=j.parseDate(this.getItemDate(h,i));if(a==null||b==null||isNaN(a)||isNaN(b)){return false}if(b.getTime()>a.getTime()){return true}else{return false}};feedbro.FeedParser.prototype.getItemDate=function(d,e){var b,a;var c=e.firstElementChild;while(true){if(c==undefined){break}if(feedbro.FeedParser.skipTags[c.nodeName]){c=c.nextElementSibling;continue}b=d.mapNodeName(c.nodeName);switch(b){case"pubDate":case"atom:published":case"dc:date":case"atom03:published":a=c.textContent+"";break;case"atom:modified":case"atom:updated":case"atom03:modified":case"atom03:updated":if(a==undefined){a=c.textContent+""}break;default:break}c=c.nextElementSibling}return a};feedbro.FeedParser.prototype.articleSorter=function(d,c){return c.publishedDate.getTime()-d.publishedDate.getTime()};feedbro.FeedParser.prototype.getFeedList=function(d,l){var c,h,g,j=0;if(d==undefined){return}g=d.indexOf("<link");while(g!=-1&&j<100){c=d.indexOf(">",g+1);if(c<0){break}h=d.substring(g,c+1);var b=this._strings.getAttributeMap(h,true);var f=b.type;var a=b.href;var i=b.title;var k=b.rel;if(i==undefined||i.length<1){i="Untitled feed"}if(f&&f.indexOf("application/atom+xml")!=-1){f="atom"}if(f&&f.indexOf("application/rss+xml")!=-1){f="rss"}if(f&&f.indexOf("application/rdf+xml")!=-1){f="rdf"}if(a&&f&&(f=="atom"||f=="rss"||f=="rdf")&&k.indexOf("alternate")!=-1){var e=this.getLink(a,this.url);if(e){l.push({type:f,href:e,title:i})}}g=d.indexOf("<link",g+1);j++}};feedbro.FeedParser.prototype.getLink=function(e,f){if(e==undefined){return e}if(e.indexOf("//")==0){return"http:"+e}if(e.indexOf("feed://")==0){e=e.replace("feed://","http://")}else{if(e.indexOf("feed:http")==0){e=e.replace("feed:","")}}var g=e.indexOf("http");if(g==0||e.length<1){return e}var d;if(e.charAt(0)!="/"){var c=f.indexOf("?");if(c!=-1){f=f.substring(0,c)}d=f.lastIndexOf("/");if(d==-1){d=f.length()}return f.substring(0,d)+"/"+e}d=f.indexOf("/",f.indexOf("//")+3);if(d==-1){d=f.length}return f.substring(0,d)+(e.charAt(0)=="/"?"":"/")+e};feedbro.FeedParser.prototype.ensurePublishedDate=function(c,b){if((c.publishedDate==undefined||isNaN(c.publishedDate))&&c.link&&this.dbIndex){var d=this.dbIndex.findEntryWithLink(c.link);if(d==undefined){var a=new Date();c.publishedDate=new Date(a.getTime()-b*1000)}else{c.publishedDate=new Date(d.timestamp+0)}c.generatedDate=true}};feedbro.FeedParser.prototype.isValidDate=function(a){return a&&!isNaN(a)};feedbro.FeedParser.prototype.getEnclosure=function(d,c,f,e){if(d.enclosures==undefined){d.enclosures=[]}var b,a=this.toAbsoluteUrl(c.getAttribute(f),e);for(b=0;b<d.enclosures.length;b++){if(d.enclosures[b].url==a){return}}if(a!=null){d.enclosures.push({url:a+"",length:c.getAttribute("length")+"",type:c.getAttribute("type")+""})}};feedbro.FeedParser.prototype.getContent=function(j,k,a,i){var g=a.getAttribute("type");var c;if(g=="xhtml"||g=="application/xhtml+xml"){c=j.getChild("div",a);if(c==undefined){c=j.getChild("xhtml:div",a)}if(c){try{k.content=i.serializeToString(c)}catch(h){k.content=c.innerHTML+""}}}else{if(g=="html"||g=="text/html"||g=="text"||g==""||g==undefined){k.content=a.textContent+""}else{if(g=="xml"||g=="application/xml"){var b=j.getChild("activityEntry",a);if(b&&b.getAttribute("xmlns")=="http://ns.opensocial.org/2008/opensocial"){try{var f="";f+=this.getOpenSocialContent(j,j.getChild("object",b));f+=this.getOpenSocialContent(j,j.getChild("target",b));k.content=f;var e=j.getChildString("title",b);if(e&&e!=""){k.title=e}var d=j.getChildString("published",b);if(d&&d!=""){k.publishedDate=d}}catch(l){k.content=""}}}}}};feedbro.FeedParser.prototype.getOpenSocialContent=function(d,g){var f="";if(!g){return""}f+=d.getChildString("author/displayName",g)+": <a href='"+d.getChildString("url",g)+"'>"+d.getChildString("displayName",g)+"</a><blockquote>"+d.getChildString("summary",g)+"</blockquote>";var c=d.getChild("image",g);if(c){var a=d.getChildString("width",c);var e=d.getChildString("height",c);var b="";if(a!=""){b+=" width='"+a+"'"}if(e!=""){b+=" height='"+e+"'"}f+="<img src='"+d.getChildString("url",c)+"'"+b+"><br>"}return f};feedbro.FeedParser.prototype.parseBitchuteVideo=function(e,d,c){try{var a="<div>";a+='<div class="youtubevideo" data-link="'+c.link+'"><img src="'+c.enclosures[0].url+'" class="thumb"><div class="play"></div></div>';a+="</div>";c.content=c.content+a}catch(b){}};feedbro.FeedParser.prototype.parseVimeoVideo=function(f,e,d){try{var c=f.getChild("media:content/media:player",e).getAttribute("url");var g=f.getChild("media:content/media:thumbnail",e).getAttribute("url");if(c&&g&&c!=""&&g!=""){var a="<div>";a+='<div class="youtubevideo" data-link="'+c+'"><img src="'+g+'" class="thumb"><div class="play"></div></div>';a+="</div>";d.content=a}}catch(b){}};feedbro.FeedParser.prototype.parseYoutubeVideo=function(f,d,c){try{var e=f.getChildString("yt:videoId",d);var g=f.getChild("media:group/media:thumbnail",d).getAttribute("url");if(e){var a="<div>";a+='<div class="youtubevideo" id="'+e+'"><img src="'+g+'" class="thumb"><div class="play"></div></div>';a+='<div class="youtubedescription">'+feedbro.Strings.linkify(f.getChildString("media:group/media:description",d))+"</div>";a+="</div>";c.content=a}}catch(b){}};feedbro.FeedParser.prototype.load=function(g){this.processUrl();var b=this;var a={};a.feed={type:"unknown",version:"0.0"};a.feed.entries=[];var d,e,c=false;for(d=0;d<b.plugins.length;d++){e=b.plugins[d];if(e.canParse(b.url)){c=true;e.parse({url:b.url,username:b.username,password:b.password,etagHeader:b.etagHeader,lastModifiedHeader:b.lastModifiedHeader,timeout:b.timeout,datelimit:b.datelimit,maxEntries:b.maxEntries},function(k,l,i,h,m,j){b.responseHandler(k,l,i,h,m,j);l.onreadystatechange=null;l.abort=null;l=null},a,g);break}}if(!c){var f=new XMLHttpRequest();f.onerror=function(){a.error={};a.error.message="Network error";a.error.code=398;a.status=398};f.onreadystatechange=function(i){var h=i.target;if(h.readyState==4){h.onreadystatechange=null;if(h.status!=0){h.onerror=null}b.responseHandler(b.url,h,h.responseText,a,g,false)}};b.adjustCharset(f,this.url);f.open("GET",this.url+"",true);f.timeout=this.timeout;f.setRequestHeader("If-Modified-Since",this.lastModifiedHeader?this.lastModifiedHeader+"":"Sat, 01 Jan 2000 00:00:00 GMT");if(this.etagHeader){f.setRequestHeader("If-None-Match",this.etagHeader+"")}if(this.username&&this.password){f.setRequestHeader("Authorization","Basic "+btoa(this.username+":"+this.password))}f.send()}};feedbro.FeedParser.prototype.debug=function(a){if(this.debugMode){console.log(a)}};feedbro.FeedParser.prototype.responseHandler=function(e,h,g,k,f,r){k.latency=0;k.status=h.status+0;var p=h.getResponseHeader("Content-Type");var s=h.getResponseHeader("Last-Modified");var a=h.getResponseHeader("ETag");k.lastModified=s?s:(this.lastModifiedHeader?this.lastModifiedHeader+"":undefined);k.etag=a?a:(this.etagHeader?this.etagHeader+"":undefined);if(h.status==200){var l=g;var d;var t=new feedbro.XmlDocumentWrapper();try{if(r!=true&&h.responseXML instanceof XMLDocument){d=h.responseXML;t.setDocument(h.responseXML)}else{d=this.textToXml(t,l)}if(d==undefined){k.error={};k.error.message="Invalid XML";k.error.code=601;k.error.url=e+"";k.status=601;f(k);return}}catch(j){k.error={};k.error.message="Invalid XML";k.error.code=601;k.error.url=e+"";k.status=601;f(k);return}try{this.handleLoadFeedData(k,e,t,h,f)}catch(n){k.error={};k.error.message="Invalid Feed";k.error.url=e+"";k.error.code=601;k.status=601}}else{if(h.status==404){k.error={};k.error.message="Feed does not exist";k.error.code=404}else{if(h.status==403){k.error={};k.error.message=h.statusText+"";k.error.code=403}else{if(k.error&&k.error.code==398){this.debug("398 Network Down for "+this.url)}else{if(h.status==0){k.error={};k.error.message="Site did not respond within timeout: "+this.timeout+" ms";k.error.code=399;k.status=399}else{if(h.status==304){this.debug("304 Not Modified "+this.url)}else{k.error={};k.error.message="Unable to read feed: "+e;k.error.code=(h.status+0)}}}}}}if(k.feed&&k.feed.entries&&k.feed.entries.length>0){var b=new Date().getTime();var o,m;try{k.feed.latestItemAge=915360000000;for(o=0;o<k.feed.entries.length;o++){m=b-k.feed.entries[o].publishedDate.getTime();if(m<k.feed.latestItemAge){k.feed.latestItemAge=m;k.feed.latestitemdate=new Date(k.feed.entries[o].publishedDate.getTime())}}}catch(q){}}if(k.error){k.error.url=e+""}if(this.fullFeed&&k.feed&&k.feed.entries&&k.feed.entries.length>0){var c=new feedbro.ClearBody();c.setAddMetaImage(this.addmetaimageMode?true:false);c.setTimeout(this.timeout+45000);this.cutObjectLinks();c.loadFeedEntries(k.feed.entries,function(){f(k)})}else{this.cutObjectLinks();setTimeout(function(){h.onerror=null;h=null;f(k)},100)}};feedbro.FeedParser.prototype.cutObjectLinks=function(){this.dbIndex=undefined;this.lastModifiedHeader=undefined;this.etagHeader=undefined;this.username=undefined;this.password=undefined;this.plugins=undefined;this.url=undefined;this.maxEntries=undefined;this.generateHashes=undefined;this.timeout=30000;this.datelimit=undefined;this.fullFeed=false;this.linkConverter=undefined;this._strings=undefined};feedbro.FeedParser.prototype.identifyFeed=function(b){var c,a={type:"unknown",version:"0.0"};if(b==undefined){return a}try{c=b.getChild("atom:feed");if(c){a.type="atom";a.version="1.0";a.title=b.getChildString("atom:title",c);if(a.title==undefined||a.title==""){a.title="Untitled feed"}return a}c=b.getChild("rss");if(c){a.type="rss";a.version=c.getAttribute("version")+"";a.title=b.getChildString("channel/title",c);if(a.title==undefined||a.title==""){a.title="Untitled feed"}return a}c=b.getChild("rdf:RDF");if(c){a.type="rdf";if(c.getAttribute("xmlns")=="http://my.netscape.com/rdf/simple/0.9/"){a.version="0.9";a.title=b.getChildString("rss09:channel/rss09:title",c)}else{a.version="1.0";a.title=b.getChildString("rss10:channel/rss10:title",c)}if(a.title==undefined||a.title==""){a.title="Untitled feed"}return a}c=b.getChild("atom03:feed");if(c){a.type="atom";a.version="0.3";a.title=b.getChildString("atom03:title",c);if(a.title==undefined){a.title="Untitled feed"}return a}}catch(d){this.debug("identifyFeed: "+d+" url: "+this.url)}return a};feedbro.FeedParser.prototype.createBase=function(c,b,a){if(b==undefined&&a==undefined){return undefined}a=this.getBase(a);if(b==undefined){b=this.getBase(c)}if(b!=undefined&&b.length>0&&b.charAt(b.length-1)!="/"){b=b+"/"}if(a!=undefined&&a.length>0){if(a.charAt(0)=="/"){return this.getProtocol(b)+"://"+this.getServer(b)+a}else{if(a.indexOf("://")==-1){if(a.charAt(0)=="#"||a.charAt(0)=="?"){return b.substring(0,b.length-1)+a}else{return b+a}}else{if(a.indexOf("://")!=-1){return a}}}}return b};feedbro.FeedParser.prototype.getBase=function(e){if(e==undefined){return undefined}var d=e.indexOf("://");var c=e.lastIndexOf("/");if(d!=-1&&c>(d+3)){return e.substring(0,c+1)}else{if(e.charAt(e.length-1)!="/"){return e+"/"}else{return e}}};feedbro.FeedParser.prototype.fixContent=function(c,b,d){if(b.content==undefined){b.content="";return}if(c==undefined){return}var a=c.getAttribute("xml:base");if(a!=undefined){b.content=this.convertRelativeLinks(b.content,this.createBase(this.url,d,a),this.url)}else{if(d!=undefined){b.content=this.convertRelativeLinks(b.content,d,this.url)}else{b.content=this.convertRelativeLinks(b.content,undefined,this.url)}}};feedbro.FeedParser.prototype.convertRelativeLinks=function(b,g,d){var f=this.getProtocol(d);var c=this.getServer(d);var e=this.getBase(d);var a=this;this.linkConverter.lastIndex=0;return b.replace(this.linkConverter,function(o,n,k,j,i){var h=n;var p=k;var q=j;var m=i;var r="<"+h+" "+p+'="';var l='"'+m+">";if(q.length>2&&q.charAt(0)=="/"&&q.charAt(1)=="/"){return r+f+":"+q+l}if(q.length>0&&q.charAt(0)=="/"){if(g!=undefined){return r+a.getProtocol(g)+"://"+a.getServer(g)+q+l}else{return r+f+"://"+c+q+l}}else{if(g!=undefined){if(q.length>0&&g.length>0&&(q.charAt(0)=="#"||q.charAt(0)=="?")){return r+g.substring(0,g.length-1)+q+l}else{return r+g+q+l}}else{return r+e+q+l}}})};feedbro.FeedParser.prototype.toAbsoluteUrl=function(a,b){if(a!=undefined&&a.indexOf("magnet:")==0){return a}if(a!=undefined&&a.indexOf("//")==0){return"http:"+a}else{if(a!=undefined&&a.length>0&&a.indexOf("://")==-1){a=a.trim();if(b==undefined||b.length==0){if(a.charAt(0)=="/"){return this.getProtocol(this.url)+"://"+this.getServer(this.url)+a}else{return this.getBase(this.url)+a}}else{if(b.charAt(b.length-1)!="/"){b=this.getBase(b)}if(a.charAt(0)=="/"){a=a.substring(1)}return b+a}}}return a};feedbro.FeedParser.prototype.getServer=function(e){var d=e.indexOf("://");if(d<0){d=0}else{d=d+3}var c=e.indexOf("/",d);if(c<0){c=e.length}return e.substring(d,c)};feedbro.FeedParser.prototype.getProtocol=function(a){if(!a){return"http"}var b=a.indexOf(":");return b>0?a.substring(0,b):"http"};feedbro.FeedParser.prototype.decodeFeedCharacters=function(b){try{if(b.error){return}var d,e,a=b.feed.entries;for(d=0;d<a.length;d++){e=a[d];e.title=this._strings.decodeHtmlEntities(e.title);e.author=this._strings.decodeHtmlEntities(e.author);e.content=this._strings.decodeHtmlEntities(e.content);e.decoded=1}}catch(c){this.debug("decodeFeedCharacters failed for feed: "+b.feed.title+" error: "+c)}};feedbro.FeedParser.prototype.textToXml=function(k,g){var h;try{h=k.parse(g);return h}catch(c){try{var b="    ";if(g.indexOf("<feed")!=-1){b="\n<!DOCTYPE feed ["+feedbro.FeedParser.ENTITIES+"]>\n"}else{if(g.indexOf("<rss")!=-1){b="\n<!DOCTYPE rss ["+feedbro.FeedParser.ENTITIES+"]>\n"}else{if(g.indexOf("<rdf:RDF")!=-1){b="\n<!DOCTYPE rdf:RDF ["+feedbro.FeedParser.ENTITIES+"]>\n"}}}var j=g.indexOf(">");g=g.substring(0,j+1)+b+g.substring(j+1);h=k.parse(g);return h}catch(e){try{var i=g.indexOf("<?xml");var f=g.indexOf("?>");if(i!=-1&&i!=0&&f>i){var a=g.substring(i,f+2);g=a+"\n"+g.substring(f+2)}g=g.replace(/[\x01-\x08\x0B-\x0C\x0E-\x1F\x7F-\x84\x86-\x9F]/g,"");h=k.parse(g);return h}catch(d){return undefined}}}};feedbro.FeedParser.prototype.adjustCharset=function(c,b){try{var d=this.getCharset(b);if(d&&d!=""){c.overrideMimeType("application/xml; charset="+d)}}catch(a){this.debug("adjustCharset error: "+a)}};feedbro.FeedParser.prototype.getCharset=function(e){var d=e.indexOf("charset=");if(d==-1){return undefined}var c=e.indexOf("&",d);if(c==-1){c=e.length}return e.substring(d+8,c)};feedbro.FeedParser.prototype.findFeeds=function(g){this.processUrl();var e,f,c=this;var b={},a=[],d=false;for(e=0;e<c.plugins.length;e++){f=c.plugins[e];if(f.canParse(c.url)){d=true;f.parse({url:c.url,username:c.username,password:c.password},function(k,n,j,i,o){if(n.status==200){var m=new feedbro.XmlDocumentWrapper();var h=c.textToXml(m,j);var l=c.identifyFeed(m);if(l.type!="unknown"){a.push({type:l.type,href:k,title:l.title})}n.onreadystatechange=null;n.onerror=null;n.abort=null;n=null;o(a)}else{n.onreadystatechange=null;n.onerror=null;n.abort=null;n=null;o(a)}},b,g);break}}if(!d){this.findFeedsDefault(g)}};feedbro.FeedParser.prototype.findFeedsDefault=function(h){var k=[];var i=new XMLHttpRequest();var j=this;var e=j.url;try{if(j.url.indexOf("youtube.com/channel/")!=-1){var c=j.url;var b=c.indexOf("youtube.com/channel/");b+="youtube.com/channel/".length;var a=c.indexOf("/",b+1);if(a==-1){a=c.length}var g=c.substring(b,a);j.url="https://www.youtube.com/feeds/videos.xml?channel_id="+g}else{if(j.url.indexOf("https://www.youtube.com/playlist?list=")==0){j.url="https://www.youtube.com/feeds/videos.xml?playlist_id="+j.url.substring(38)}else{if(j.url.indexOf("https://www.reddit.com/")==0&&j.url.indexOf(".rss")!=(j.url.length-4)){j.url=j.url+".rss"}}}}catch(f){this.debug("Failed to modify URL to find Youtube feed")}try{if(j.url.indexOf("https://vimeo.com/")==0&&j.url.indexOf("rss")==-1){j.url=j.url+"/videos/rss"}}catch(f){this.debug("Failed to modify URL to find Vimeo feed")}try{if(j.url.indexOf("https://www.bitchute.com/channel")==0&&j.url.indexOf("rss")==-1){j.url=j.url.replace("/channel","/feeds/rss/channel")}}catch(f){this.debug("Failed to modify URL to find Bitchute feed")}try{if(j.url.indexOf("pinterest.com/")!=-1&&j.url.indexOf(".rss")==-1){var d=j.url.substring(8).split("/");if(d.length>1&&d[d.length-1]==""){d.pop()}if(d.length==2){j.url="https://"+d.join("/")+"/feed.rss"}if(d.length==3){j.url="https://"+d.join("/")+".rss"}}}catch(f){this.debug("Failed to modify URL to find Pinterest feed")}i.onreadystatechange=function(u){var r=u.target;if(r.readyState==4){r.onreadystatechange=null;var p=new feedbro.Strings();if(r.status==200){var o=r.responseText;try{if(r.responseURL&&r.responseURL.indexOf("https://www.youtube.com/c/")==0){j.scanYouTubeProfile(p,o,k)}else{var s=new feedbro.XmlDocumentWrapper();var v=j.textToXml(s,o);var t=j.identifyFeed(s);if(t.type!="unknown"){k.push({type:t.type,href:j.url,title:t.title})}}}catch(m){}if(k.length<1){j.getFeedList(o,k)}if(k.length<1&&e.indexOf("youtube.com/")!=-1){var l={stag:["videos.xml?channel_id="],etag:'"'};p.findNext(o,l);if(l.match){var n=l.match;l.stag=['<meta property="og:title" content="'];l.spos=0;p.findNext(o,l);var q="Youtube Feed";if(l.match){q=l.match}k.push({type:"atom",href:"https://www.youtube.com/feeds/videos.xml?channel_id="+n,title:q})}}}if(k.length<1&&!p.endsWith(j.url,"/feed")){j.url=j.url+"/feed";j.findFeedsDefault(h)}else{h(k)}}};i.withCredentials=true;i.open("GET",this.url,true);i.timeout=this.timeout;if(this.username&&this.password){i.setRequestHeader("Authorization","Basic "+btoa(this.username+":"+this.password))}i.setRequestHeader("If-Modified-Since","Sat, 01 Jan 2000 00:00:00 GMT");i.send()};feedbro.FeedParser.prototype.scanYouTubeProfile=function(b,f,a){var e,d;var c={stag:['<meta name="title" content="'],etag:'"'};b.findNext(f,c);if(c.match){e=c.match+""}c.spos=0;c.stag=['<meta itemprop="channelId" content="'];b.findNext(f,c);if(c.match){d=c.match+""}if(e&&d){a.push({type:"atom",href:"https://www.youtube.com/feeds/videos.xml?channel_id="+d,title:e+" | YouTube"})}};feedbro.FeedParser.prototype.processUrl=function(){if(this.url.indexOf("://")==-1){this.url="http://"+this.url}var e=this.getServer(this.url);var a=e.indexOf("@");if(a<0){return}var d=e.split("@");var c=d[0];this.url=this.url.replace(c+"@","");var b=c.split(":");if(b.length==2){this.setAuthentication(b[0],b[1])}};feedbro.FeedParser.ENTITIES='<!ENTITY nbsp "&#160;"> <!ENTITY iexcl "&#161;"> <!ENTITY cent "&#162;"> <!ENTITY pound "&#163;"> <!ENTITY curren "&#164;"> <!ENTITY yen "&#165;"> <!ENTITY brvbar "&#166;"> <!ENTITY sect "&#167;"> <!ENTITY uml "&#168;"> <!ENTITY copy "&#169;"> <!ENTITY ordf "&#170;"> <!ENTITY laquo "&#171;"> <!ENTITY not "&#172;"> <!ENTITY shy "&#173;"> <!ENTITY reg "&#174;"> <!ENTITY macr "&#175;"> <!ENTITY deg "&#176;"> <!ENTITY plusmn "&#177;"> <!ENTITY sup2 "&#178;"> <!ENTITY sup3 "&#179;"> <!ENTITY acute "&#180;"> <!ENTITY micro "&#181;"> <!ENTITY para "&#182;"> <!ENTITY middot "&#183;"> <!ENTITY cedil "&#184;"> <!ENTITY sup1 "&#185;"> <!ENTITY ordm "&#186;"> <!ENTITY raquo "&#187;"> <!ENTITY frac14 "&#188;"> <!ENTITY frac12 "&#189;"> <!ENTITY frac34 "&#190;"> <!ENTITY iquest "&#191;"> <!ENTITY Agrave "&#192;"> <!ENTITY Aacute "&#193;"> <!ENTITY Acirc "&#194;"> <!ENTITY Atilde "&#195;"> <!ENTITY Auml "&#196;"> <!ENTITY Aring "&#197;"> <!ENTITY AElig "&#198;"> <!ENTITY Ccedil "&#199;"> <!ENTITY Egrave "&#200;"> <!ENTITY Eacute "&#201;"> <!ENTITY Ecirc "&#202;"> <!ENTITY Euml "&#203;"> <!ENTITY Igrave "&#204;"> <!ENTITY Iacute "&#205;"> <!ENTITY Icirc "&#206;"> <!ENTITY Iuml "&#207;"> <!ENTITY ETH "&#208;"> <!ENTITY Ntilde "&#209;"> <!ENTITY Ograve "&#210;"> <!ENTITY Oacute "&#211;"> <!ENTITY Ocirc "&#212;"> <!ENTITY Otilde "&#213;"> <!ENTITY Ouml "&#214;"> <!ENTITY times "&#215;"> <!ENTITY Oslash "&#216;"> <!ENTITY Ugrave "&#217;"> <!ENTITY Uacute "&#218;"> <!ENTITY Ucirc "&#219;"> <!ENTITY Uuml "&#220;"> <!ENTITY Yacute "&#221;"> <!ENTITY THORN "&#222;"> <!ENTITY szlig "&#223;"> <!ENTITY agrave "&#224;"> <!ENTITY aacute "&#225;"> <!ENTITY acirc "&#226;"> <!ENTITY atilde "&#227;"> <!ENTITY auml "&#228;"> <!ENTITY aring "&#229;"> <!ENTITY aelig "&#230;"> <!ENTITY ccedil "&#231;"> <!ENTITY egrave "&#232;"> <!ENTITY eacute "&#233;"> <!ENTITY ecirc "&#234;"> <!ENTITY euml "&#235;"> <!ENTITY igrave "&#236;"> <!ENTITY iacute "&#237;"> <!ENTITY icirc "&#238;"> <!ENTITY iuml "&#239;"> <!ENTITY eth "&#240;"> <!ENTITY ntilde "&#241;"> <!ENTITY ograve "&#242;"> <!ENTITY oacute "&#243;"> <!ENTITY ocirc "&#244;"> <!ENTITY otilde "&#245;"> <!ENTITY ouml "&#246;"> <!ENTITY divide "&#247;"> <!ENTITY oslash "&#248;"> <!ENTITY ugrave "&#249;"> <!ENTITY uacute "&#250;"> <!ENTITY ucirc "&#251;"> <!ENTITY uuml "&#252;"> <!ENTITY yacute "&#253;"> <!ENTITY thorn "&#254;"> <!ENTITY yuml "&#255;"> <!ENTITY quot "&#34;"> <!ENTITY amp "&#38;#38;"> <!ENTITY lt "&#38;#60;"> <!ENTITY gt "&#62;"> <!ENTITY apos "&#39;"> <!ENTITY OElig "&#338;"> <!ENTITY oelig "&#339;"> <!ENTITY Scaron "&#352;"> <!ENTITY scaron "&#353;"> <!ENTITY Yuml "&#376;"> <!ENTITY circ "&#710;"> <!ENTITY tilde "&#732;"> <!ENTITY ensp "&#8194;"> <!ENTITY emsp "&#8195;"> <!ENTITY thinsp "&#8201;"> <!ENTITY zwnj "&#8204;"> <!ENTITY zwj "&#8205;"> <!ENTITY lrm "&#8206;"> <!ENTITY rlm "&#8207;"> <!ENTITY ndash "&#8211;"> <!ENTITY mdash "&#8212;"> <!ENTITY lsquo "&#8216;"> <!ENTITY rsquo "&#8217;"> <!ENTITY sbquo "&#8218;"> <!ENTITY ldquo "&#8220;"> <!ENTITY rdquo "&#8221;"> <!ENTITY bdquo "&#8222;"> <!ENTITY dagger "&#8224;"> <!ENTITY Dagger "&#8225;"> <!ENTITY permil "&#8240;"> <!ENTITY lsaquo "&#8249;"> <!ENTITY rsaquo "&#8250;"> <!ENTITY euro "&#8364;"> <!ENTITY fnof "&#402;"> <!ENTITY Alpha "&#913;"> <!ENTITY Beta "&#914;"> <!ENTITY Gamma "&#915;"> <!ENTITY Delta "&#916;"> <!ENTITY Epsilon "&#917;"> <!ENTITY Zeta "&#918;"> <!ENTITY Eta "&#919;"> <!ENTITY Theta "&#920;"> <!ENTITY Iota "&#921;"> <!ENTITY Kappa "&#922;"> <!ENTITY Lambda "&#923;"> <!ENTITY Mu "&#924;"> <!ENTITY Nu "&#925;"> <!ENTITY Xi "&#926;"> <!ENTITY Omicron "&#927;"> <!ENTITY Pi "&#928;"> <!ENTITY Rho "&#929;"> <!ENTITY Sigma "&#931;"> <!ENTITY Tau "&#932;"> <!ENTITY Upsilon "&#933;"> <!ENTITY Phi "&#934;"> <!ENTITY Chi "&#935;"> <!ENTITY Psi "&#936;"> <!ENTITY Omega "&#937;"> <!ENTITY alpha "&#945;"> <!ENTITY beta "&#946;"> <!ENTITY gamma "&#947;"> <!ENTITY delta "&#948;"> <!ENTITY epsilon "&#949;"> <!ENTITY zeta "&#950;"> <!ENTITY eta "&#951;"> <!ENTITY theta "&#952;"> <!ENTITY iota "&#953;"> <!ENTITY kappa "&#954;"> <!ENTITY lambda "&#955;"> <!ENTITY mu "&#956;"> <!ENTITY nu "&#957;"> <!ENTITY xi "&#958;"> <!ENTITY omicron "&#959;"> <!ENTITY pi "&#960;"> <!ENTITY rho "&#961;"> <!ENTITY sigmaf "&#962;"> <!ENTITY sigma "&#963;"> <!ENTITY tau "&#964;"> <!ENTITY upsilon "&#965;"> <!ENTITY phi "&#966;"> <!ENTITY chi "&#967;"> <!ENTITY psi "&#968;"> <!ENTITY omega "&#969;"> <!ENTITY thetasym "&#977;"> <!ENTITY upsih "&#978;"> <!ENTITY piv "&#982;"> <!ENTITY bull "&#8226;"> <!ENTITY hellip "&#8230;"> <!ENTITY prime "&#8242;"> <!ENTITY Prime "&#8243;"> <!ENTITY oline "&#8254;"> <!ENTITY frasl "&#8260;"> <!ENTITY weierp "&#8472;"> <!ENTITY image "&#8465;"> <!ENTITY real "&#8476;"> <!ENTITY trade "&#8482;"> <!ENTITY alefsym "&#8501;"> <!ENTITY larr "&#8592;"> <!ENTITY uarr "&#8593;"> <!ENTITY rarr "&#8594;"> <!ENTITY darr "&#8595;"> <!ENTITY harr "&#8596;"> <!ENTITY crarr "&#8629;"> <!ENTITY lArr "&#8656;"> <!ENTITY uArr "&#8657;"> <!ENTITY rArr "&#8658;"> <!ENTITY dArr "&#8659;"> <!ENTITY hArr "&#8660;"> <!ENTITY forall "&#8704;"> <!ENTITY part "&#8706;"> <!ENTITY exist "&#8707;"> <!ENTITY empty "&#8709;"> <!ENTITY nabla "&#8711;"> <!ENTITY isin "&#8712;"> <!ENTITY notin "&#8713;"> <!ENTITY ni "&#8715;"> <!ENTITY prod "&#8719;"> <!ENTITY sum "&#8721;"> <!ENTITY minus "&#8722;"> <!ENTITY lowast "&#8727;"> <!ENTITY radic "&#8730;"> <!ENTITY prop "&#8733;"> <!ENTITY infin "&#8734;"> <!ENTITY ang "&#8736;"> <!ENTITY and "&#8743;"> <!ENTITY or "&#8744;"> <!ENTITY cap "&#8745;"> <!ENTITY cup "&#8746;"> <!ENTITY int "&#8747;"> <!ENTITY there4 "&#8756;"> <!ENTITY sim "&#8764;"> <!ENTITY cong "&#8773;"> <!ENTITY asymp "&#8776;"> <!ENTITY ne "&#8800;"> <!ENTITY equiv "&#8801;"> <!ENTITY le "&#8804;"> <!ENTITY ge "&#8805;"> <!ENTITY sub "&#8834;"> <!ENTITY sup "&#8835;"> <!ENTITY nsub "&#8836;"> <!ENTITY sube "&#8838;"> <!ENTITY supe "&#8839;"> <!ENTITY oplus "&#8853;"> <!ENTITY otimes "&#8855;"> <!ENTITY perp "&#8869;"> <!ENTITY sdot "&#8901;"> <!ENTITY lceil "&#8968;"> <!ENTITY rceil "&#8969;"> <!ENTITY lfloor "&#8970;"> <!ENTITY rfloor "&#8971;"> <!ENTITY lang "&#9001;"> <!ENTITY rang "&#9002;"> <!ENTITY loz "&#9674;"> <!ENTITY spades "&#9824;"> <!ENTITY clubs "&#9827;"> <!ENTITY hearts "&#9829;"> <!ENTITY diams "&#9830;">';var feedbro=feedbro||{};feedbro.FeedTreeNode=function(){this.children=[];this.parent=undefined;this.data=undefined};feedbro.FeedTree=function(){var l={};var k=new feedbro.FeedTreeNode();var h=1;function o(s,r,t){if(!s){s=k}if(!t){t=1}var q=s.children;for(var p=0;p<q.length;p++){r(q[p],t);o(q[p],r,t+1)}}function f(r){var q=k.children;for(var p=0;p<q.length;p++){r(q[p])}}function n(q){var r=i(l);for(var p=0;p<r.length;p++){q(l[r[p]])}}function a(t,r){var p=[];p.push(t);while(p.length>0){var s=p.shift();if(s.parent){r(s)}for(var q=0;q<s.children.length;q++){p.push(s.children[q])}}}function b(t,r){var p=[];var u=[];var s,q;p.push(t);while(p.length>0){s=p.shift();if(s.parent){u.push(s)}for(q=0;q<s.children.length;q++){p.push(s.children[q])}}while(u.length>0){s=u.pop();r(s)}}this.toJson=function(p){return JSON.stringify(this.getData(p))};this.fromJson=function(p){this.load(JSON.parse(p))};this.getData=function(t,r){var p;if(r!=undefined){p=r}else{p=[]}if(!t){t=k}var s;if(t.parent){s=d(t);p.push(s)}for(var q=0;q<t.children.length;q++){this.getData(t.children[q],t.parent?s.children:p)}return p};function d(t){var s={};var r=i(t.data);for(var p=0;p<r.length;p++){var q=r[p];s[q]=t.data[q]}s.children=[];return s}this.load=function(s,q){var p;if(!q){q=k}for(p=0;p<q.children.length;p++){this.deleteNode(q.children[p])}for(p=0;p<s.length;p++){var t=s[p];var r=this.addNode(t,q,feedbro.FeedTree.INSIDE_LAST);if(t.children){this.load(t.children,r)}}};this.getRoot=function(){return k};this.getNode=function(p){return l[p]};this.getNodeSibling=function(t,s){var r=l[t];var p;if(!r){return r}if(s==feedbro.FeedTree.AFTER){if(r.children.length>0&&r.data.is_open){return r.children[0]}else{p=j(r.parent.children,r);if(p==(r.parent.children.length-1)){if(r.parent.parent){return e(r.parent)}else{return e(r)}}else{if(r.parent.children.length>1){return r.parent.children[p+1]}else{return null}}}}else{if(s==feedbro.FeedTree.BEFORE){p=j(r.parent.children,r);if(p>0){var q=r.parent.children[p-1];if(q.children.length>0&&q.data.is_open){return q.children[q.children.length-1]}else{return q}}else{if(p==0){if(r.parent.parent){return r.parent}else{return null}}else{return null}}}else{c("getNodeSibling: Unidentified direction: "+s);return null}}};function e(q){var p=q.parent.children;var r=j(p,q);return(r+1<p.length)?p[r+1]:null}this.searchNodes=function(p){var x=i(l);var t=i(p);var r=[];for(var s=0;s<x.length;s++){var w=x[s];var u=l[w].data;var q;for(q=0;q<t.length;q++){var v=t[q];if(p[v]!=u[v]){break}}if(q==t.length){r.push(l[w])}}return r};function i(r){var q=[];for(var p in r){if(r.hasOwnProperty(p)){q.push(p)}}return q}this.addNode=function(r,s,p){if(!p||s===k){p=feedbro.FeedTree.INSIDE_LAST}if(!s){s=k}var q=new feedbro.FeedTreeNode();q.data=r;if(!r.id){q.data.id=h++}else{if(r.id>=h){h=r.id+1}}m(q,s,p);l[q.data.id]=q;return q};this.deleteNode=function(q){if(!q.parent){c("Root cannot be deleted");return false}g(q.parent,q);delete l[q.data.id];for(var p=0;p<q.children.length;p++){this.deleteNode(q.children[p])}return true};this.moveNode=function(q,r,p){if(!q.parent){c("Root cannot be moved");return false}if(!p){p=feedbro.FeedTree.INSIDE_LAST}g(q.parent,q);m(q,r,p);return q};this.sortChildren=function(r){var q=this.getNode(r);if(!q){return false}var p=q.children;if(p){p.sort(function(v,t){var u=(v.data.name||"").toLowerCase();var s=(t.data.name||"").toLowerCase();if(u<s){return -1}if(u>s){return 1}return 0})}return true};function m(q,r,p){var s;if(p==feedbro.FeedTree.INSIDE_FIRST){r.children.unshift(q);q.parent=r}else{if(p==feedbro.FeedTree.INSIDE_LAST){r.children.push(q);q.parent=r}else{if(p==feedbro.FeedTree.BEFORE){s=j(r.parent.children,r);r.parent.children.splice(s,0,q);q.parent=r.parent}else{if(p==feedbro.FeedTree.AFTER){s=j(r.parent.children,r);r.parent.children.splice(s+1,0,q);q.parent=r.parent}else{c("addNodePosition: Unidentified node position: "+p)}}}}}function g(p,q){var r=j(p.children,q);p.children.splice(r,1)}function j(q,r){var p;for(p=0;p<q.length;p++){if(q[p].data.id==r.data.id){return p}}return -1}function c(p){feedbro.log("FeedTree: "+p)}this.processNodes=function(q,p,r){if(!r){r=feedbro.FeedTree.MODE_BOTTOMUP}if(r==feedbro.FeedTree.MODE_BOTTOMUP){b(q,p)}else{if(r==feedbro.FeedTree.MODE_TOPDOWN){a(q,p)}else{if(r==feedbro.FeedTree.MODE_TOPNODES){f(p)}else{if(r==feedbro.FeedTree.MODE_DEPTHFIRST){o(q,p)}else{n(p)}}}}}};feedbro.FeedTree.BEFORE=1;feedbro.FeedTree.AFTER=2;feedbro.FeedTree.INSIDE_FIRST=3;feedbro.FeedTree.INSIDE_LAST=4;feedbro.FeedTree.MODE_BOTTOMUP=1;feedbro.FeedTree.MODE_TOPDOWN=2;feedbro.FeedTree.MODE_RANDOM=3;feedbro.FeedTree.MODE_TOPNODES=4;feedbro.FeedTree.MODE_DEPTHFIRST=5;feedbro.FeedTree.FEED=1;feedbro.FeedTree.FOLDER=2;var feedbro=feedbro||{};feedbro.InPlugin=function(){this._strings=new feedbro.Strings()};feedbro.InPlugin.prototype.canParse=function(a){return a&&a.indexOf("https://www.instagram.com")==0};feedbro.InPlugin.prototype.parse=function(e,c,a,f){var b=this;var d=new XMLHttpRequest();d.onerror=function(){a.error={};a.error.message="Network error";a.error.code=398;a.status=398};d.onreadystatechange=function(h){var g=h.target;if(g.readyState==4){g.onreadystatechange=null;if(g.status!=0){g.onerror=null}if(g.status==200){var k=g.responseText;var i="";try{if(e.url=="https://www.instagram.com"||e.url=="https://www.instagram.com/"){i=b.toMainRSS(k,e.url)}else{i=b.toRSS(k,e.url)}}catch(j){feedbro.log("Failed to parse: "+e.url)}if(c){c(e.url,g,i,a,f,true)}}else{c(e.url,g,"",a,f,true)}}};d.withCredentials=true;d.open("GET",e.url,true);d.timeout=20000;d.setRequestHeader("Cache-Control","no-cache");d.send()};feedbro.InPlugin.prototype.toMainRSS=function(h,k){var c={spos:0};var m="";var a="https://www.instagram.com";var e=/@(\S+)/g;var b=/#(\S+)/g;c.stag=["window._sharedData = "];c.etag=";<\/script>";this._strings.findNext(h,c);if(c.match!=undefined){m='<?xml version="1.0" encoding="UTF-8"?>\n<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:sy="http://purl.org/rss/1.0/modules/syndication/" xmlns:admin="http://webns.net/mvcb/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n';m+="<channel>\n<title>My Instagram</title>";m+="<link>https://www.instagram.com</link>";m+="<description>My Instagram Main Page</description>\n";var q=JSON.parse(c.match);if(q==undefined||q.entry_data==undefined||q.entry_data.FeedPage==undefined){m+="</channel></rss>";return m}var g=q.entry_data.FeedPage[0].graphql.user.edge_web_feed_timeline.edges;var n,p,r,o,l;for(var f=0;f<g.length;f++){n=g[f].node;if(n.__typename!="GraphImage"){continue}o=undefined;l=undefined;p="<item>";r=a+"/p/"+n.shortcode;p+="<link>"+r+"</link>";p+="<author>"+this._strings.escapeHtml(n.owner.full_name)+" ("+this._strings.escapeHtml(n.owner.username)+")</author>";p+="<description><![CDATA[";if(n.display_url!=undefined){p+='<p><a target="_blank" href="'+r+'">';if(n.dimensions&&n.dimensions.width!=undefined&&n.dimensions.height!=undefined){p+='<img src="'+n.display_url+'" width="'+n.dimensions.width+'" height="'+n.dimensions.height+'">'}else{p+='<img src="'+n.display_url+'">'}p+="</a></p>"}if(n.edge_media_to_caption&&n.edge_media_to_caption.edges&&n.edge_media_to_caption.edges[0].node){o=n.edge_media_to_caption.edges[0].node.text;try{if(o!=undefined){l="Post by "+this._strings.escapeHtml(n.owner.full_name)+": "+this._strings.escapeHtml(this._strings.truncate(o,60,"..."))}o=o.replace(e,this.usernameMapper);o=o.replace(b,this.hashtagMapper)}catch(j){feedbro.log(j)}p+="<p>"+o+"</p>"}p+="]]></description>";if(l==undefined){l="Post by "+this._strings.escapeHtml(n.owner.full_name)+" ("+this._strings.escapeHtml(n.owner.username)+")"}p+="<title>"+l+"</title>";var d=new Date();d.setTime(n.taken_at_timestamp*1000);p+="<pubDate>"+d.format("ddd, d mmm yyyy HH:mm:ss Z")+"</pubDate>";p+="</item>\n";m+=p}m+="</channel>\n</rss>"}return m};feedbro.InPlugin.prototype.toRSS=function(h,f){var l={spos:0};var b,s,u,t,n,e,q,p="";var d=/@(\w+)/g;var g=/ #(\w+)/g;l.stag=['<meta property="og:title" content="'];l.etag='"';this._strings.findNext(h,l);u=l.match;l.stag=['<meta property="og:description" content="'];this._strings.findNext(h,l);n=l.match;l.stag=['<meta property="og:url" content="'];this._strings.findNext(h,l);e=l.match;l.stag=["window._sharedData = "];l.etag=";<\/script>";this._strings.findNext(h,l);if(l.match!=undefined){p='<?xml version="1.0" encoding="UTF-8"?>\n<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:sy="http://purl.org/rss/1.0/modules/syndication/" xmlns:admin="http://webns.net/mvcb/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n';p+="<channel>\n<title>"+this._strings.escapeHtml(u)+"</title>";p+="<link>"+e+"</link>";p+="<description>"+this._strings.escapeHtml(n)+"</description>\n";var r=JSON.parse(l.match);if(r==undefined||r.entry_data==undefined||r.entry_data.ProfilePage==undefined){p+="</channel></rss>";return p}var c=r.entry_data.ProfilePage[0];p+="<managingEditor>"+this._strings.escapeHtml(c.graphql.user.full_name)+" ("+this._strings.escapeHtml(c.graphql.user.username)+")</managingEditor>";var a="https://www.instagram.com";var j=c.graphql.user.edge_owner_to_timeline_media.edges;for(var o=0;o<j.length;o++){b=j[o].node;u=undefined;s="<item>";b.link=a+"/p/"+b.shortcode;s+="<link>"+b.link+"</link>";s+="<author>"+this._strings.escapeHtml(c.graphql.user.full_name)+" ("+this._strings.escapeHtml(c.graphql.user.username)+")</author>";s+="<description><![CDATA[";if(b.display_url!=undefined){var k={url:b.display_url};s+='<p><a target="_blank" href="'+b.link+'">';if(k.width!=undefined&&k.height!=undefined){s+='<img src="'+k.url+'" width="'+k.width+'" height="'+k.height+'">'}else{s+='<img src="'+k.url+'">'}s+="</a></p>"}if(b.edge_media_to_caption&&b.edge_media_to_caption.edges&&b.edge_media_to_caption.edges.length>0){b.caption=b.edge_media_to_caption.edges[0].node.text}if(b.caption!=undefined){if(b.caption.text!=undefined){q=b.caption.text}else{q=b.caption}try{if(q!=undefined){u=this._strings.escapeHtml(this._strings.truncate(q,60,"..."))}q=q.replace(d,this.usernameMapper);q=q.replace(g,this.hashtagMapper)}catch(m){feedbro.log(m)}s+="<p>"+q+"</p>"}s+="<p>";if(b.likes!=undefined){s+=b.likes.count+" likes"}if(b.comments!=undefined){s+=" - "+b.comments.count+" comments"}if(b.location!=undefined&&b.location.latitude!=undefined){s+=' - <a class="instagram-photolocation" target="_blank" href="http://maps.google.com/maps?q='+b.location.latitude+","+b.location.longitude+'">Photo location';if(b.location.name!=undefined){s+=": "+b.location.name}s+="</a>"}s+="</p>";s+="]]></description>";if(u!=undefined){s+="<title>"+u+"</title>"}t=new Date();t.setTime(b.taken_at_timestamp*1000);s+="<pubDate>"+t.format("ddd, d mmm yyyy HH:mm:ss Z")+"</pubDate>";s+="</item>\n";p+=s}p+="</channel>\n</rss>"}return p};feedbro.InPlugin.prototype.usernameMapper=function(a){return"<a target='_blank' class='instagram-username' rel='noopener noreferrer' href='https://www.instagram.com/"+a.substring(1)+"'>"+a+"</a>"};feedbro.InPlugin.prototype.hashtagMapper=function(a){return"<a target='_blank' class='instagram-hashtag' rel='noopener noreferrer' href='https://www.instagram.com/explore/tags/"+a.substring(1)+"/'>"+a+"</a>"};var feedbro=feedbro||{};feedbro.InviewObserver=function(e){var d={};var c=[];function a(f,g){var j,k,m,l;for(j=0;j<f.length;j++){if(f[j].intersectionRatio<1){continue}k=f[j].target;l=k.getAttribute("id");m=d[l];try{g.unobserve(k)}catch(h){feedbro.log("Unable to stop observing element")}if(m){d[l]=null;m(k)}}}this.once=function(f,g){c.push({id:f,callback:g})};this.addEvents=function(){setTimeout(this.processQueue,350)};this.processQueue=function(){var g,h,f;for(g=0;g<c.length;g++){h=c[g];f=document.getElementById(h.id);if(f){d[h.id]=h.callback;b.observe(f)}else{feedbro.log("Failed to add element with ID "+h.id+" to observe list")}}c=[]};this.clear=function(){try{b.disconnect();d={};c=[]}catch(f){}};var b=new IntersectionObserver(a,{root:document.querySelector(e),rootMargin:"0px",threshold:1})};var feedbro=feedbro||{};feedbro.LiPlugin=function(a){this._timeout=15000;this._rootUrl="https://www.linkedin.com";this._strings=new feedbro.Strings();this._debug=false};feedbro.LiPlugin.csrfToken="";feedbro.LiPlugin.lastScan=0;feedbro.LiPlugin.prototype.setDebug=function(a){this._debug=a};feedbro.LiPlugin.prototype.canParse=function(a){return a&&(a.indexOf(this._rootUrl+"/groups/")==0||a.indexOf(this._rootUrl+"/jobs/search/")==0||a.indexOf(this._rootUrl+"/feed/hashtag/")==0||a==(this._rootUrl+"/feed/")||(a.indexOf(this._rootUrl)!=-1&&a.indexOf("/detail/recent-activity/posts/")!=-1))};feedbro.LiPlugin.prototype.initTokens=function(b){var a=new XMLHttpRequest();a.onreadystatechange=function(d){var c=d.target;if(c.readyState==4){c.onreadystatechange=undefined;b()}};a.withCredentials=true;a.open("GET","https://www.linkedin.com/feed/",true);a.timeout=15000;a.send()};feedbro.LiPlugin.prototype.parse=function(e,d,a,f){var c=this;var b=new Date().getTime()-feedbro.LiPlugin.lastScan;if(feedbro.LiPlugin.csrfToken==""||b>(15*60*1000)){this.initTokens(function(){feedbro.LiPlugin.lastScan=new Date().getTime();c.doParse(e,d,a,f)})}else{c.doParse(e,d,a,f)}};feedbro.LiPlugin.prototype.doParse=function(b,h,j,f){var i=this;var g=new XMLHttpRequest();g.onerror=function(){j.error={};j.error.message="Network error";j.error.code=398;j.status=398};g.onreadystatechange=function(l){var k=l.target;if(k.readyState==4){k.onreadystatechange=null;if(k.status!=0){k.onerror=null}var n="";if(k.status==200){try{if(b.url.indexOf("https://www.linkedin.com/jobs/search")==0){n=i.parseJobs(k.responseText,b.url)}else{if(b.url.indexOf("/detail/recent-activity/posts/")!=-1){n=i.parseIndividualArticles(k.responseText,b.url)}else{n=i.parseJson(k.responseText,b.url)}}}catch(m){feedbro.log("LiPlugin error: "+m)}}h(b.url,k,n,j,f,true)}};var e=b.url;var a;try{if(b.url=="https://www.linkedin.com/feed/"){e="https://www.linkedin.com/voyager/api/feed/updatesV2?commentsCount=0&count=20&likesCount=0&moduleKey=home-feed%3Adesktop&q=chronFeed&start=0"}else{if(b.url.indexOf("https://www.linkedin.com/groups/")==0){var c=b.url.match(/groups\/(\d+)/);e="https://www.linkedin.com/voyager/api/groups/updatesV2?count=10&groupId="+c[1]+"&q=groupsFeed&start=0"}else{if(b.url.indexOf("https://www.linkedin.com/jobs/search")==0){a=b.url.substring(b.url.indexOf("=")+1);e="https://www.linkedin.com/voyager/api/search/hits?count=25&decorationId=com.linkedin.voyager.deco.jserp.WebJobSearchHit-22&facetEnabled=false&geoUrn=urn%3Ali%3Afs_geo%3A"+a+"&origin=JOB_SEARCH_RESULTS_PAGE&q=jserpAll&query=search&topNRequestedFlavors=List(HIDDEN_GEM,SALARY,PREFERRED_COMMUTE,IN_NETWORK,SCHOOL_RECRUIT,COMPANY_RECRUIT,JOB_SEEKER_QUALIFIED,PRE_SCREENING_QUESTIONS,SKILL_ASSESSMENTS)"}else{if(b.url.indexOf("https://www.linkedin.com/feed/hashtag/")==0){a=b.url.split("/").pop();if(a.indexOf("?keywords=")==0){a=a.substring(a.indexOf("=")+1);e="https://www.linkedin.com/voyager/api/feed/interestUpdatesV2?count=10&keywords="+a+"&q=interestFeedByKeywords&sortOrder=RELEVANCE&start=0"}else{e="https://www.linkedin.com/voyager/api/feed/interestUpdatesV2?count=10&q=interestFeedByUrn&sortOrder=RELEVANCE&start=0&urn=urn%3Ali%3Ahashtag%3A"+a}}else{if(b.url.indexOf("/detail/recent-activity/posts/")!=-1){a=b.url.match(/in\/(.*?)\/detail\//)[1];e="https://www.linkedin.com/voyager/api/identity/profiles/"+a+"/posts?count=10&start=0"}}}}}}catch(d){feedbro.log("LiPlugin error: "+d,b.url+"")}g.withCredentials=true;g.open("GET",e,true);g.timeout=b.timeout?b.timeout:10000;g.setRequestHeader("Cache-Control","no-cache");g.setRequestHeader("accept","application/vnd.linkedin.normalized+json+2.1");g.setRequestHeader("accept-language","en-GB,en-US;q=0.9,en;q=0.8,fi;q=0.7,de;q=0.6");g.setRequestHeader("csrf-token",feedbro.LiPlugin.csrfToken+"");g.setRequestHeader("pragma","no-cache");g.setRequestHeader("x-li-lang","en_US");g.setRequestHeader("x-restli-protocol-version","2.0.0");g.send()};feedbro.LiPlugin.prototype.getKeywords=function(b){if(b.indexOf("https://www.linkedin.com/feed/hashtag/")!=0){return undefined}try{var c=b.split("/").pop();if(c.indexOf("?keywords=")==0){c=c.substring(c.indexOf("=")+1)}return c}catch(a){return undefined}};feedbro.LiPlugin.prototype.hashtagReplace=function(a){return'<a class="linkedin-hashtag" rel="noopener noreferrer" target="_blank" href="https://www.linkedin.com/feed/hashtag/'+a+'/">#'+a+"</a>"};feedbro.LiPlugin.prototype.parseJobs=function(o,a){var r=JSON.parse(o);var g=r.included,h,f,c,j,q=[];for(f=0;f<g.length;f++){j=g[f];var b={};if(j["$type"]=="com.linkedin.voyager.jobs.JobPosting"){b.publishedDate=new Date(j.listedAt);b.title=j.title;b.content="";b.author="";b.guid=j.entityUrn;var m=j.formattedLocation;var d="";if(j.applyMethod&&j.applyMethod.companyApplyUrl){d=j.applyMethod.companyApplyUrl;b.content+="<div class='linkedin-apply'><a href='"+d+"' target='_blank' rel='noopener noreferrer'>Apply</a></div>"}b.content+="<div class='linkedin-job-location'>"+m+"</div>";var k=j.entityUrn.split(":");b.link=this._rootUrl+"/jobs/view/"+k[3];var n=j.companyDetails.company;var p;var l;for(l=0;l<g.length;l++){h=g[l];if(h["$type"]=="com.linkedin.voyager.organization.Company"&&h.entityUrn==n){p=h.name.trim();b.author=p;b.title=b.title+" | "+p;if(h.logo&&h.logo.image&&h.logo.image.artifacts){b.content+="<img src='"+h.logo.image.rootUrl+h.logo.image.artifacts[0].fileIdentifyingUrlPathSegment+"'>"}break}}c=r.data.metadata.keywords+" Jobs | LinkedIn";q.push(b)}}return feedbro.Strings.toRSS(c,a,q)};feedbro.LiPlugin.prototype.parseIndividualArticles=function(g,a){var j=JSON.parse(g);var d,b,e,f,c;var h=[];for(d=0;d<j.included.length;d++){b=j.included[d];if(b["$type"]=="com.linkedin.voyager.identity.profile.Post"){e={};e.content="";e.publishedDate=new Date(b.postedAt);e.title=b.title;e.author=b.authorComponent.name.text;e.link=b.permaLink;e.guid=b.entityUrn;c=e.author;if(b.image&&b.image.artifacts){f=b.image.rootUrl+b.image.artifacts[0].fileIdentifyingUrlPathSegment;e.content+="<div class='linkedin-article-image'><img src='"+f+"'></div>"}h.push(e)}}return feedbro.Strings.toRSS(c+" | LinkedIn",a,h)};feedbro.LiPlugin.prototype.parseJson=function(l,a){var o=JSON.parse(l);var e={};var c,b,g,f;var n=[];var m="Feed";var k={};var j=new feedbro.Strings();var h=this.getKeywords(a);if(h){m="#"+h}for(f=0;f<o.included.length;f++){c=o.included[f];e[c.entityUrn]=c;if(c["$type"]=="com.linkedin.voyager.identity.shared.MiniProfile"){if(c.picture&&c.picture.artifacts){k[c.entityUrn]=c.picture.rootUrl+c.picture.artifacts[0].fileIdentifyingUrlPathSegment}}else{if(c["$type"]=="com.linkedin.voyager.entities.shared.MiniCompany"){if(c.logo&&c.logo.artifacts){k[c.entityUrn]=c.logo.rootUrl+c.logo.artifacts[0].fileIdentifyingUrlPathSegment}}}}for(f=0;f<o.included.length;f++){c=o.included[f];if(c["$type"]=="com.linkedin.voyager.entities.shared.MiniGroup"){m=c.groupName}else{if(c["$type"]=="com.linkedin.voyager.feed.render.UpdateV2"&&c.commentary!=null&&c.entityUrn.indexOf("RESHARED")==-1){if(c.updateMetadata.trackingData&&c.updateMetadata.trackingData.sponsoredTracking){continue}var d={content:c.commentary.text.text,guid:c.updateMetadata.urn,author:c.actor?c.actor.name.text:"",link:this.findLink(c)};d.content=this.convertBody(d.content);d.content+=this.getArticle(c,j);if(c.content&&c.content["$type"]=="com.linkedin.voyager.feed.render.ImageComponent"&&c.content.images&&c.content.images.length>0){d.content+=this.getImageTag(c.content.images[0])}if(d.author==""&&c.contextualHeader&&c.contextualHeader.subtitle){g=c.contextualHeader.subtitle.text.split(" ");d.author=g[g.length-2]+" "+g[g.length-1]}b=e[c["*resharedUpdate"]];if(b){if(b.commentary){d.content+="<div class='linkedin-shared-post'>"+this.createAuthorHeader(b,k,j)+this.convertBody(b.commentary.text.text)+"</div>"}else{d.content+="<div class='linkedin-shared-post'>"+this.createAuthorHeader(b,k,j)+this.getArticle(b,j)+"</div>"}}j.fixTitle(d);d.content=this.createAuthorHeader(c,k,j)+d.content;n.push(d)}}}if(a=="https://www.linkedin.com/feed/"){m="Feed"}return feedbro.Strings.toRSS(m+" | LinkedIn",a,n)};feedbro.LiPlugin.prototype.findLink=function(b){var a=b.updateMetadata.urn;if(a.substring(0,16)=="urn:li:aggregate"){a=a.substring(18,a.indexOf(","))}return"https://www.linkedin.com/feed/update/"+a};feedbro.LiPlugin.prototype.createAuthorHeader=function(d,b,e){var a="";var c="";if(d.actor&&d.actor.image&&d.actor.image.attributes){c=b[d.actor.image.attributes[0]["*miniProfile"]||d.actor.image.attributes[0]["*miniCompany"]]}if(c==undefined){c=""}else{c="<img class='linkedin-actor-image' src='"+e.escapeHref(c)+"'>"}if(d.actor&&d.actor.navigationContext){a+="<header><div class='linkedin-author-header'>";a+="<a class='linkedin-author-link' target='_blank' rel='noopener noreferrer' href='"+e.escapeHref(d.actor.navigationContext.actionTarget)+"'>";a+="<table class='linkedin-author-table'><tr><td class='linkedin-author-table-column-1'><div class='linkedin-actor-image'>"+c+"</div></td>";a+="<td class='linkedin-author-table-column-2'>";a+="<div class='linkedin-actor-namerow'><span class='linkedin-actor-name'>"+e.escapeHtml(d.actor.name.text)+"</span> <span class='linkedin-actor-order'>"+(d.actor.supplementaryActorInfo?d.actor.supplementaryActorInfo.text:"")+"</span></div>";a+="<div class='linkedin-actor-title'>"+e.escapeHtml(d.actor.description.text)+"</div>";a+="</td></tr></table>";a+="</a>";a+="</div></header>"}return a};feedbro.LiPlugin.prototype.convertBody=function(a){a=feedbro.Strings.linkify(a);a=feedbro.Strings.convertHashtags(a,this.hashtagReplace);return a.replace(/\n/g,"<br>")};feedbro.LiPlugin.prototype.getArticle=function(c,e){if(c.content&&c.content["$type"]=="com.linkedin.voyager.feed.render.ArticleComponent"){var a=this.getImageTag(c.content.largeImage||c.content.smallImage);var d=c.content.title.text;var b=c.content.navigationContext.actionTarget;return"<div class='linkedin-article'><a target='_blank' class='linkedin-article-link' rel='noreferrer noopener' href='"+e.escapeHref(b)+"'>"+a+"<div class='linkedin-article-title'>"+e.escapeHtml(d)+"</div><div class='linkedin-article-subtitle'>"+e.escapeHtml(c.content.subtitle?c.content.subtitle.text:"")+"</div></a></div>"}else{return""}};feedbro.LiPlugin.prototype.getImageTag=function(a){if(a==null||a.attributes==null||a.attributes.length==0){return""}var c,b;if(a.attributes[0].sourceType=="VECTOR"){c=a.attributes[0].vectorImage;b=c.rootUrl+c.artifacts[c.artifacts.length-1].fileIdentifyingUrlPathSegment}else{if(a.attributes[0].sourceType=="URL"){b=a.attributes[0].imageUrl}else{return""}}return"<div class='linkedin-article-image'><img src='"+b+"'></div>"};var feedbro=feedbro||{};feedbro.LiveClick=function(){var d;var k=new feedbro.Strings();var h="div#popuplist";var b="images/";var g=new feedbro.FeedIconManager();this.init=function(){d=Object.assign([],f().getTreeData());g.setSettings(f().getSettings());i()};function f(){return chrome.extension.getBackgroundPage().feedbrobg}function e(m){var o=$(this);var n=parseInt(o.attr("data-id"),10);l(n)}function l(o){var n,m;for(n=0;n<d.length;n++){m=d[n];if(m.type==2&&m.id==o){$(h).html(c(m,m.children));$(h+" .iconBackButton").click(function(){i()});$(h+" div.feed").click(j);window.scrollTo(0,0);break}}}function j(n){var o=$(this);var q=parseInt(o.attr("data-id"),10);var p=o.attr("data-parent-id");var m=f();m.handleMessageEvent({action:"loadsingle",start:0,count:20,unread:1,feedid:q},"bg",function(s){var r=m.getFeedEntries();a(p,r)})}function a(p,s){var o="",u,t;if(s.length>0){o+="<div class='viewHeader'><img class='iconBackButton' src='"+b+"liveclick-backbutton.png'><div class='feedTitle'><img class='feedIcon' src='"+g.getIconFromGoogleCache(s[0].feed.link)+"'>"+k.escapeHtml(s[0].feed.title)+"</div></div>"}else{o+="<div class='viewHeader'><img class='iconBackButton' src='"+b+"liveclick-backbutton.png'><div class='feedTitle'>"+Locale.i18n("mainmenu_liveclick_nounread",true)+"</div></div>"}var r=Locale.i18n("mainmenu_liveclick_authorprefix",true);o+="<div class='entryList'>";for(var n=0;n<s.length;n++){u=s[n];var m=k.isTextRTL(u.title||"",true,100);var q=k.isTextRTL(u.author||"",true,100);k.fixTitle(u);t=k.escapeHtml(u.title);o+="<div class='article'>";o+="<a target='_blank' data-id='"+u.id+"' class='popup-link' href='"+u.link+"' title='"+t+"'>";o+="<div class='articleTitle"+(m?" rtl-layout":"")+"'>"+t+"</div>";o+="<div class='footer'>";o+="  <div class='articleDate' title='"+u.publishedDate+"'>"+k.timeAgo(u.publishedDate,true)+"</div>";o+="  <div class='articleAuthor'>"+(u.author!=""?(r+" <span class='name"+(q?" rtl-layout":"")+"'>"+k.stripTags(u.author)+"</span>"):"")+"</div>";o+="</div>";o+="</a>";o+="</div>"}o+="<div>";$(h).html(o);$(".popup-link").click(function(v){var x=parseInt(v.currentTarget.getAttribute("data-id"),10);var w=f();w.markUnread(x,0);w.updateTotalUnread();v.currentTarget.parentElement.classList.add("read")});if(p==undefined){$(h+" .iconBackButton").click(function(){i()})}else{$(h+" .iconBackButton").click(function(){l(parseInt(p,10))})}window.scrollTo(0,0)}function i(){$(h).html(c({},d));$(h+" div.folder").click(e);$(h+" div.feed").click(j)}function c(w,v){var t,r,x,n,q,p;var s="";var o;s+="<div class='popuptree'>";if(w.type==2){o=k.isTextRTL(w.name||"",true,100);s+="<div class='viewHeader'><img class='iconBackButton' src='"+b+"liveclick-backbutton.png'><div class='feedTitle"+(o?" rtl-layout":"")+"'><img class='folderIcon' src='"+b+"folder-icon.svg'>"+k.escapeHtml(w.name)+"</div></div>"}if(w.type==undefined){s+="<div class='viewHeader'></div>"}var u=0;s+="<div class='entryList'>";for(t=0;t<v.length;t++){x=v[t];if(x.type==2){n=x;q=0;for(r=0;r<n.children.length;r++){p=n.children[r];q+=p.unread}n.unread=q;if(q>0){o=k.isTextRTL(n.name||"",true,100);s+="<div class='folder' data-id='"+n.id+"'><table class='popupEntryTable'><tr><td><div class='popupTreeIcon'><img src='"+b+"folder-icon.svg'></div></td><td><div class='truncate folderName"+(o?" rtl-layout":"")+"'>"+k.escapeHtml(n.name)+"</div></td><td><div class='popupUnread'>"+n.unread+"</div></td></tr></table></div>";u++}}else{if(x.type==1){if(x.unread>0){var m=g.getIconFromGoogleCache(x.htmlUrl);o=k.isTextRTL(x.name||"",true,100);s+="<div class='feed' data-id='"+x.id+"'"+(w.id?" data-parent-id='"+w.id+"'":"")+"><table class='popupEntryTable'><tr><td><div class='popupTreeIcon'><img src='"+m+"'></div></td><td><div class='truncate feedName"+(o?" rtl-layout":"")+"'>"+k.escapeHtml(x.name)+"</div></td><td><div class='popupUnread'>"+x.unread+"</div></td></tr></table></div>";u++}}}}if(u==0){s+="<div class='popupMessage'>"+Locale.i18n("mainmenu_liveclick_nounread",true)+"</div>"}s+="</div>";s+="</div>";return s}};var Locale=Locale||{};Locale.locales=Locale.locales||{};Locale.argumentRE=/\{(\d+)\}/g;Locale.needEscapeCache={};Locale.htmlReplacements={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};Locale.start=function(){Locale.defaultLocale=Locale.locales.en_US;Locale.activeLocale="en_US";Locale.activeMap=Locale.defaultLocale};Locale.i18n=function(g,f){var a=Locale.activeMap;var d=a?a[g]:undefined;if(d==undefined){console.log("i18n: missing locale translation key: "+g);d=Locale.defaultLocale[g]}if(d==undefined){console.log("i18n: completely missing translation key: "+g);return g}if(arguments&&arguments.length>2){var e=arguments;d=d.replace(Locale.argumentRE,function(h,i){var j=parseInt(i,10);if(j<e.length&&j>0){return e[j+1]}else{return"{"+j+"}"}})}if(f==true){var b=Locale.needEscapeCache[g];var c;if(b==undefined){c=Locale.escape(d);b=(c!=d);Locale.needEscapeCache[g+""]=b;d=c}else{if(b==true||arguments.length>2){d=Locale.escape(d)}}}return d};Locale.escape=function(a){return a.replace(/[<>"']/g,Locale.escapeReplace)};Locale.escapeReplace=function(a){return Locale.htmlReplacements[a]};Locale.selectLocale=function(a){Locale.activeLocale=a;if(a=="default"||Locale.locales[Locale.activeLocale]==undefined){Locale.activeMap=Locale.defaultLocale}else{Locale.activeMap=Locale.locales[Locale.activeLocale]}Locale.needEscapeCache={}};Locale.getActiveMap=function(){return Locale.activeMap};Locale.addLocale=function(a,b){Locale.locales[b]=a;Locale.selectLocale(b)};Locale.install=function(b,c,a,d){Locale.download(b,function(e){Locale.locales[e.meta.locale_type]=e;if(c){Locale.selectLocale(e.meta.locale_type)}a(200)},d)};Locale.deleteLocale=function(a){delete Locale.locales[a]};Locale.download=function(b,a,d){var c=new XMLHttpRequest();c.onreadystatechange=function(f){var e=f.target;if(e.readyState==4){e.onreadystatechange=null;if(e.status==200){try{var h=JSON.parse(e.responseText);if(h.meta&&h.meta.manifest_version&&h.meta.locale_type){a(h)}else{d(600)}}catch(g){d(601+" "+g)}}else{d(e.status+0)}}};c.open("GET",b,true);c.timeout=10000;c.setRequestHeader("Cache-Control","no-cache");c.send()};Locale.translate=function(f,c){var e,d,a,g,b=document.querySelectorAll(f?"[data-i18n]":"[data-i18n]:not(.processed)");if(c==undefined){c=Locale.activeMap}if(b!=undefined){for(e=0;e<b.length;e++){a=b[e];d=a.getAttribute("data-i18n");if(d){g=c[d+"_body"];if(g!=undefined){a.innerHTML=Locale.escape(g)}g=c[d+"_value"];if(g!=undefined){a.setAttribute("value",g)}g=c[d+"_placeholder"];if(g!=undefined){a.setAttribute("placeholder",g)}g=c[d+"_title"];if(g!=undefined){a.setAttribute("title",g)}}a.classList.add("processed")}}};var feedbro=feedbro||{};feedbro.log=function(){if(feedbro.debug){if(arguments.length==1){console.log(arguments[0])}if(arguments.length==2){console.log(arguments[0],arguments[1])}if(arguments.length>=3){console.log(arguments[0],arguments[1],arguments[2])}}};var feedbro=feedbro||{};feedbro.Mainmenu=function(){function e(g,f){chrome.tabs.query({title:g},function(i){if(i.length>0){chrome.windows.update(i[0].windowId,{focused:true});if(f&&f.indexOf("preview")!=-1){chrome.tabs.update(i[0].id,{active:true,url:f})}else{chrome.tabs.update(i[0].id,{active:true});if(a().getSettings().getIconClickReloads()){a().notifyEngine("updateview",-1,-1)}}try{window.close()}catch(h){}}else{chrome.tabs.create({url:chrome.runtime.getURL(f)},function(k){try{window.close()}catch(j){}})}})}function c(){var h=a().getFolders();var l=a().getLastFolderId();var j=false;var k=new feedbro.Strings();var g,f="<select id='folder' title='"+Locale.i18n("mainmenu_selectfolder_title",true)+"'>";if(h.length>0){for(g=0;g<h.length;g++){if(h[g].id==l){j=true}f+="<option"+(h[g].id==l?" selected='selected'":"")+" value='"+h[g].id+"'>"+k.escapeHtml(h[g].name)+"</option>"}}f+="<option value='-1'"+(!j?" selected='selected'":"")+">"+Locale.i18n("mainmenu_rootfolder",true)+"</option>";f+="</select>";return f}function b(){chrome.tabs.query({currentWindow:true,active:true},function(f){if(f.length>0){d(f[0].url)}})}function d(g){$("div.menuitem").css({cursor:"progress"});try{a().findFeeds(g,undefined,undefined,function(h){$("div.menuitem").css({cursor:"pointer"});if(h.length>0){$("body").css({width:"500px"});$("div#articlelist").css({display:"none"});$("div#articlelistdivider").css({display:"none"});var l,k="<div class='divider'></div><div class='results-area'>";var n=Locale.i18n("mainmenu_input_title",true);var m=Locale.i18n("mainmenu_newtab_title",true);var j=Locale.i18n("mainmenu_preview_title",true);var p=Locale.i18n("mainmenu_edit_title",true);var o=new feedbro.Strings();for(l=0;l<h.length;l++){k+="<div class='discovered-feed-entry'><div class='discovered-feed-entry-left'><input title='"+n+"' type='checkbox' name='feed' "+(h.length==1?"checked='checked'":"")+" value='"+l+"'>";k+="<span class='discovered-feed-type'><a class='discovered-feed-url' title='"+m+"' target='_blank' rel='noopener noreferrer' href='"+h[l].href+"'>"+h[l].type+"</a></span>";k+="<a class='discovered-feed-previewlink' target='_blank' rel='noopener noreferrer' title='"+j+"' href='"+h[l].href+"'>";k+="<img src='images/preview-icon.png' class='previewicon'></a></div>";k+="<div class='discovered-feed-name' id='feedname-"+l+"' contenteditable='true' title='"+p+"'>"+o.escapeHtml(h[l].title)+"</div></div>"}k+='<div class="results-toolbar"><div class="results-label">'+Locale.i18n("mainmenu_addtofolder",true)+'</div><div class="results-folder">';k+=c();k+="</div>";k+='<div class="results-buttons">';k+='<input class="uibutton" type="button" id="subscribe" value="'+Locale.i18n("mainmenu_button_subscribe",true)+'">&nbsp;<input class="uibutton" type="button" id="close" value="'+Locale.i18n("mainmenu_button_close",true)+'">';k+="</div>";k+="</div>";$("div#results").html(k);$("div.discovered-feed-name").keydown(function(i){if(i.keyCode==13){i.preventDefault();$(this).blur();return false}});$("a.discovered-feed-previewlink").click(function(q){var i=$(this).attr("href");e("Feedbro","reader.html?preview="+encodeURIComponent(i));q.preventDefault();return false});$("input#close").click(function(){window.close()});$("input#subscribe").click(function(){var i=$("select#folder > option:selected").attr("value");a().setLastFolderId(i);var q=0,r;$("input:checkbox[name=feed]:checked").each(function(){var t=$(this).val();var w=$("div#feedname-"+t).text();var v=a().getNodesWithUrl(h[t].href);if(v.length>0){var u=v[0];var s;if(u.parent&&u.parent.data&&u.parent.data.type==2){s=u.parent.data.name}if(s){alertify.error(Locale.i18n("mainmenu_error_duplicate_folder",false,w,s,u.data.name))}else{alertify.error(Locale.i18n("mainmenu_error_duplicate",false,w,u.data.name))}}else{q++;r=a().addFeed(h[t].href,w,w,i);a().notifyEngine("addfeed",r,i);a().loadFeedItems(r)}});if(q>0){a().saveData();alertify.set({delay:2000});if(q>1){alertify.success(Locale.i18n("mainmenu_success_addedmultiple",false,q))}else{alertify.success(Locale.i18n("mainmenu_success_addedsingle",false))}}else{alertify.set({delay:2000});alertify.error(Locale.i18n("mainmenu_error_nothing_selected",false))}})}else{alertify.set({delay:2000});alertify.error(Locale.i18n("mainmenu_error_nothing_found",false))}})}catch(f){$("div.menuitem").css({cursor:"pointer"})}}function a(){var f=chrome.extension.getBackgroundPage();return f?f.feedbrobg:null}this.customInit=function(){var f=a();if(f==null){$("body").html("<div style='padding: 10px; min-width: 230px; text-align: center'>Not available in Private Browsing Mode</div>");return}Locale.start();Locale.activeMap=a().getActiveLocaleMap();Locale.translate(true);alertify.set({labels:{cancel:Locale.i18n("dialog_cancel",false),ok:Locale.i18n("dialog_ok",false)}});$("div#reader").click(function(){e("Feedbro","reader.html")});$("div#findfeeds").click(function(){b()});$("div#options").click(function(){e("Feedbro - Options","options.html")});$("div#explorer").click(function(){$("div#articlelist").css({display:"none"});$("div#menuitems").css({display:"none"});$("div#results").css({display:"none"});$("div#articlelistdivider").css({display:"none"});var h=new feedbro.LiveClick();h.init()});if(a().getSettings().getShowLatestInPopup()){var g=new feedbro.MainmenuPopup();g.showPopupItems("div#articlelist");$("body").css({width:"500px"})}else{$("div#articlelist").css({display:"none"});$("div#articlelistdivider").css({display:"none"})}}};var feedbro=feedbro||{};feedbro.MainmenuPopup=function(){this.showPopupItems=function(e){var b=new Date().getTime();var a=new feedbro.Strings();var f=new feedbro.FeedIconManager();var c=chrome.extension.getBackgroundPage().feedbrobg;var d=c.getSettings();var h=d.getArticleLinkMode();var g="../images";f.setSettings(d);c.handleMessageEvent({action:"loadall",start:0,count:9,maxdate:b,unread:1},"bg",function(m){var t=c.getFeedEntries();var o;var p="",s,q;if(t.length==0){$("div#articlelist").css({display:"none"});$("div#articlelistdivider").css({display:"none"})}var l=Locale.i18n("mainmenu_open_originalarticle",true);var u=Locale.i18n("mainmenu_mark_read",true);var k=Locale.i18n("mainmenu_favorite",true);var r=Locale.i18n("mainmenu_delete",true);for(o=0;o<t.length;o++){a.fixTitle(t[o]);var j=a.isTextRTL(t[o].title,true,100);var n=a.isTextRTL(t[o].feed.title,true,100);if(t[o].starred==1){s="<img title='"+k+"' class='starred' data-id='"+t[o].id+"' src='"+g+"/star-yellow.png'>"}else{s="<img title='"+k+"' data-id='"+t[o].id+"' src='"+g+"/star-grey.png'>"}q="<div class='article-popup-linkhtml'><a class='article-link' data-id='"+t[o].id+"'target='_blank' href='"+t[o].link+"'><img title='"+l+"' data-id='"+t[o].id+"' src='"+g+"/link-icon.png' width='16'></a></div>";p+="<div class='article-popup' data-id='"+t[o].id+"'><table><tr>";p+="<td class='article-meta'><div class='article-popup-title"+(j?" rtl-layout":"")+"'>";p+="<span class='open-article' data-id='"+t[o].id+"'>"+a.escapeHref(a.truncate(a.stripTags(t[o].title),100,"..."))+"</span>";p+="</div>";p+="<div class='article-popup-bottom'>";p+="<div class='article-popup-feedtitle"+(n?" rtl-layout":"")+"'><img class='feedTitleIcon' src='"+f.getIconFromGoogleCache(t[o].link)+"'>"+a.escapeHref(t[o].feed.title)+"</div>";p+="<div class='article-popup-delete'><img title='"+r+"' data-id='"+t[o].id+"' src='"+g+"/trash.png'></div>";p+="<div class='article-popup-star'>"+s+"</div>"+q;p+="<div class='article-popup-markread'><img title='"+u+"' data-id='"+t[o].id+"' src='"+g+"/icon-unread.png'></div>";p+="<div class='article-popup-date'>"+a.timeAgo(t[o].publishedDate.getTime())+"</div>";p+="</div></td></tr></table></div>"}var v=$(p);$(e).html(v);if(h==1){v.find("span.open-article").click(function(){feedbro.Chrome.openTab("Feedbro","reader.html?article="+$(this).data("id"))})}else{v.find("span.open-article").click(function(){$(this).parent().parent().find("a.article-link").get(0).click()})}v.find("div.article-popup-star img").click(function(){var i=$(this);c.toggleItemStarred(i.data("id"));if(i.hasClass("starred")){i.removeClass("starred");i.attr("src",g+"/star-grey.png")}if(!i.hasClass("starred")){i.addClass("starred");i.attr("src",g+"/star-yellow.png")}});v.find("div.article-popup-delete img").click(function(){var i=$(this);var w=parseInt(i.attr("data-id"),10);c.markUnread(w,0);c.markDeleted(w,1);c.updateTotalUnread();$("div.article-popup[data-id='"+w+"']").remove()});v.find("div.article-popup-markread img").click(function(){var i=$(this);var w=parseInt(i.attr("data-id"),10);c.markUnread(w,0);c.updateTotalUnread();$("div.article-popup[data-id='"+w+"']").remove()});v.find("a.article-link").click(function(){var i=parseInt($(this).attr("data-id"),10);c.markUnread(i,0);c.updateTotalUnread()})})}};var feedbro=feedbro||{};feedbro.MathJax=function(){var b=this;var a=true;var e=false;var c=false;var d=[];this.init=function(){if(e){return}e=true;if(navigator&&navigator.userAgent&&navigator.userAgent.indexOf("Firefox")!=-1){return}var g=document.createElement("script");g.type="text/javascript";g.src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML";g.async="async";document.head.appendChild(g)};this.destroy=function(){window.MathJax=undefined};this.shouldRender=function(g){if(!g||g.length<4||!a){return false}var j,k=g.length,m=0,l,h=false;while(true){j=g.indexOf("$",m);if(j<0){break}if(j+1<k){l=g.charAt(j+1);if(l!="\\"&&(l==" "||l=="1"||l=="2"||l=="3"||l=="4"||l=="5"||l=="6"||l=="7"||l=="8"||l=="9"||l=="0")){h=false}else{h=true;break}}m=j+1}if(h){b.init()}return h};this.render=function(g){b.init();if(window.MathJax!=undefined){MathJax.Hub.Queue(["Typeset",MathJax.Hub,document.getElementById(g)])}else{d.push(g);if(!c){f()}}};function f(){if(window.MathJax!=undefined){if(d.length>0){var g;for(g=0;g<d.length;g++){MathJax.Hub.Queue(["Typeset",MathJax.Hub,document.getElementById(d[g])])}d=[]}}else{c=true;setTimeout(f,1000)}}};var feedbro=feedbro||{};feedbro.Notifications=function(){var d=new feedbro.Strings();var b;var a={};var c=[];this.setSettings=function(f){b=f};this.init=function(){if(chrome.notifications){setInterval(e,1000);chrome.notifications.onClicked.addListener(function(f){chrome.notifications.clear(f,function(j){if(b.getPopupClickMode()==2){var i=a[f];chrome.tabs.create({url:i});try{var h=chrome.extension.getBackgroundPage().feedbrobg;h.markUnread(parseInt(f,10),0);h.updateTotalUnread()}catch(g){feedbro.log("Failed to mark article with id "+f+" as read")}}else{feedbro.Chrome.openTab("Feedbro","reader.html?article="+f)}})})}else{console.log("chrome.notifications API is not available. Notifications disabled!")}};this.createItemNotification=function(i){if(b.getNotificationsEnabled()!=true){return}if(chrome.notifications==undefined){return}var f;if(i.feed.link!=undefined&&i.feed.link.indexOf("https://twitter.com")==0){f={src:"images/twitter128.png"}}else{if(i.feed.link!=undefined&&i.feed.link.indexOf("facebook.com/")!=-1){f={src:"images/facebook128.png"}}else{if(i.feed.link!=undefined&&i.feed.link.indexOf("youtube.com/")!=-1){f={src:"images/youtube128.png"}}else{f={src:"images/reader128.png"}}}}d.fixTitle(i);var g={type:"basic",title:d.unescapeHtml(d.stripTags(i.feed.title))+(i.author!=undefined&&i.author!=""?" | "+d.unescapeHtml(i.author):""),message:d.unescapeHtml(d.stripTags(i.title)),iconUrl:f.src};var j=i.id+"";a[j]=i.link+"";var h={id:j,options:g};c.push(h)};function e(){if(chrome.notifications==undefined){return}if(c.length>0){var f=c.shift();var g=b.getNotificationTimeout();chrome.notifications.create(f.id,f.options,function(h){})}}};var feedbro=feedbro||{};feedbro.Options=function(){var i=this;var d;var a;function e(){return chrome.extension.getBackgroundPage().feedbrobg}this.getLicense=function(){chrome.runtime.sendMessage({action:"getlicense"},function(k){d=JSON.parse(k.license);a=k.status;i.showLicense(d)})};this.showLicense=function(m){var k="";if(m==null){k="None"}else{var l;switch(m.data.type){case"1":l="Personal License";break;case"2":l="Corporate License";break}k+="Licensed to "+m.data.owner+" &lt;"+m.data.email+"&gt; - Valid until: "+m.data.valid+" - Type: "+l}$("div#license").html(k)};this.downloadFile=function(p,m,r){var q=navigator.userAgent.indexOf("Windows")==-1;var o=navigator.userAgent.indexOf("Vivaldi")!=-1;if(q&&o){r="application/octet-stream"}var n=new Blob([p],{type:r});var l=window.URL.createObjectURL(n);var k=document.createElement("a");k.href=l;k.download=m;k.style.display="none";document.body.appendChild(k);k.click()};function g(k,u){var n=$(k);var o=n.attr("title");var r=n.attr("text");var q=n.attr("xmlUrl");var l;var m;var t=n.attr("entryContent");var p=n.attr("maxItems");var s=n.attr("scanDelay");if(!o||o==""){o=r}if(!r&&o){r=o}if(r==undefined||r==""){r="Unnamed feed"}if(o==undefined||o==""){o="Unnamed feed"}if(q!=undefined){l=e().addFeed(q,r,o,u);if((t&&t!="")||(p&&p!="")||(s&&s!="")){m=e().getFeedTree().getNode(l);if(m){t=parseInt(t,10);if(!isNaN(t)){m.data.entrycontent=t}p=parseInt(p,10);if(!isNaN(p)){m.data.maxitems=p}s=parseInt(s,10);if(!isNaN(s)){m.data.scandelay=s}}}}}this.importFeeds=function(r,l,n){try{var s;var p;try{s=$.parseXML(r);if(s==undefined){throw"Invalid file"}p=$(s);if(p.find("> opml").length!=1){throw"Invalid file"}}catch(k){alertify.alert(Locale.i18n("options_error_invalidopml",true,l.name));return}var t=e().getFeedTree();var m;var o={addedFeeds:0,addedFolders:0,skippedFeeds:0,skippedFolders:0};$.each(p.find("opml > body > outline"),function(u,w){var x=$(w);var y=x.attr("text");var v=x.attr("type");if(v=="rss"||v=="atom"||(v==undefined&&x.attr("xmlUrl")!=undefined)){if(!c(n,t,1,x.attr("xmlUrl"))){g(w,-1);o.addedFeeds++}else{feedbro.log("Skipped feed "+x.attr("xmlUrl"));o.skippedFeeds++}}else{if(v=="link"||v=="include"){feedbro.log("Skipped item "+u+" of unsupported type: "+v)}else{if(!y){y=x.attr("title")}if(y==undefined||y==""){y="Folder"}var z;if(n){m=t.searchNodes({type:2,name:y});if(m.length>0){z=m[0].data.id;o.skippedFolders++}else{z=e().addFolder(y);o.addedFolders++}}else{z=e().addFolder(y);o.addedFolders++}$.each(x.find("outline"),function(A,C){var B=$(C);if(B.attr("type")=="rss"||(B.attr("type")==undefined&&B.attr("xmlUrl")!=undefined)){if(!c(n,t,1,B.attr("xmlUrl"))){g(C,z);o.addedFeeds++}else{feedbro.log("Skipped feed "+B.attr("xmlUrl"));o.skippedFeeds++}}})}}});e().saveData();e().notifyEngine("reloaddata");e().scanUnread();alertify.alert(Locale.i18n("options_action_opmlimport_success",true,o.addedFeeds,o.addedFolders,o.skippedFeeds,o.skippedFolders))}catch(q){alertify.alert(Locale.i18n("options_action_opmlimport_failed",true,q+""))}};function c(l,k,m,n){if(!l){return false}if(m==1&&k.searchNodes({type:1,url:n}).length==0){return false}else{if(m==2&&k.searchNodes({type:2,name:n}).length==0){return false}}return true}function j(){try{var n=$("input#fileupload");var o=n.prop("files");if(o==undefined||o.length<1){feedbro.log("No file selected!");return}var l=o[0];var m=new FileReader();m.onload=function(r){var q=r.target.result;var p=e().getSettings().getSkipOpmlDupes();i.importFeeds(q,l,p);n.val(null)};m.readAsText(l)}catch(k){feedbro.log(k)}return false}function b(){try{var n=$("input#rulesupload");var o=n.prop("files");if(o==undefined||o.length<1){feedbro.log("No file selected!");return}var l=o[0];var m=new FileReader();m.onload=function(r){var q=r.target.result;try{e().getRuleEngine().importRules(q);alertify.alert(Locale.i18n("options_action_rulesimport_success",true))}catch(p){feedbro.log(p);alertify.alert(Locale.i18n("options_action_rulesimport_failed",true,p+""))}n.val(null)};m.readAsText(l)}catch(k){feedbro.log(k);alertify.alert(Locale.i18n("options_action_rulesimport_failed",true,k+""))}return false}function f(){try{var n=$("input#licenseupload");var o=n.prop("files");if(o==undefined||o.length<1){return}var l=o[0];var m=new FileReader();m.onload=function(r){var q=r.target.result;try{e().updateLicense(q,function(s){if(s==1){alertify.success("License successfully imported!");i.getLicense()}},function(s){if(s==-3){alertify.error("License has expired")}else{alertify.error("Invalid license")}})}catch(p){feedbro.log(p);alertify.alert("Unable to import license: "+p)}n.val(null)};m.readAsText(l)}catch(k){feedbro.log(k);alertify.alert("Unable to import license: "+k)}return false}function h(){$("link#theme").attr("href","styles/theme-"+e().getSettings().getTheme()+".css")}this.initOptions=function(){try{i.refreshLocale()}catch(l){feedbro.log("Locale init error",l)}h();$("a#export").click(function(){var q=new feedbro.Strings();var p=q.getDatestamp();i.downloadFile(e().exportOpml(),"feedbro-subscriptions-"+p+".opml","application/xml");return false});$("a#import").click(function(){$("input#fileupload").click();return false});$("a#clearall").click(function(){alertify.confirm(Locale.i18n("options_action_delete_feedsandfolders",true),function(q){if(q){try{e().clearAll();setTimeout(function(){alertify.alert(Locale.i18n("options_action_delete_feedsandfolders_success",true))},1000)}catch(p){feedbro.log("Error in removing all subscriptions: ",p)}}});return false});$("a#deleteRules").click(function(){alertify.confirm(Locale.i18n("options_action_delete_rules",true),function(r){if(r){try{var q=e().getRuleEngine();q.deleteRules();q.saveRules();setTimeout(function(){alertify.alert(Locale.i18n("options_action_delete_rules_success",true))},1000)}catch(p){feedbro.log("Error in deleting rules: ",p)}}});return false});var n=e().getSettings();$("input#fileupload").change(function(){j();return false});$("input#rulesupload").change(function(){b();return false});$("input#licenseupload").change(function(){f();return false});$("a#importlicense").click(function(){$("input#licenseupload").click();return false});$("a#exportRules").click(function(){var p=e().getRuleEngine().exportRules();i.downloadFile(JSON.stringify(p),"feedbro-rules.json","application/json");return false});$("a#importRules").click(function(){$("input#rulesupload").click();return false});$("a#importFirefox").click(function(){document.location.href="firefox-bookmarks.html"});$("select#updatethreads").val(n.getUpdateThreads());$("select#updatethreads").change(function(){e().getSettings().setUpdateThreads($(this).val());e().saveSettings()});$("select#timeout").val(n.getFeedTimeout()/1000);$("select#timeout").change(function(){e().getSettings().setFeedTimeout($(this).val()*1000);e().saveSettings()});$("select#articlelink").val(n.getArticleLinkMode());$("select#articlelink").change(function(){var p=parseInt($(this).val(),10);e().getSettings().setArticleLinkMode(p);e().saveSettings()});$("select#polldelay").val(n.getPollDelay());$("select#polldelay").change(function(){var p=$(this).val();e().getSettings().setPollDelay(p);e().saveSettings()});$("select#targetlanguage").val(n.getTargetLanguage());$("select#targetlanguage").change(function(){var p=$(this).val();e().getSettings().setTargetLanguage(p);e().saveSettings()});$("select#maxentries").val(n.getFeedMaxEntries());$("select#maxentries").change(function(){e().getSettings().setFeedMaxEntries($(this).val());e().saveSettings()});$("select#markreadmode").val(n.getMarkReadMode());$("select#markreadmode").change(function(){e().getSettings().setMarkReadMode($(this).val());e().saveSettings()});$("select#iconclick").val(n.getIconClickMode());$("select#iconclick").change(function(){e().getSettings().setIconClickMode($(this).val());e().saveSettings();e().setPopupEnabled($(this).val()=="1")});$("select#popupclick").val(n.getPopupClickMode());$("select#popupclick").change(function(){e().getSettings().setPopupClickMode($(this).val());e().saveSettings()});$("select#faviconprovider").val(n.getFavIconProvider());$("select#faviconprovider").change(function(){e().getSettings().setFavIconProvider($(this).val());e().saveSettings()});$("input#iconclickreloads").prop("checked",n.getIconClickReloads());$("input#iconclickreloads").change(function(){e().getSettings().setIconClickReloads($(this).is(":checked"));e().saveSettings()});$("input#tag-iframe").prop("checked",n.getFilterIframe());$("input#tag-iframe").change(function(){e().getSettings().setFilterIframe($(this).is(":checked"));e().saveSettings()});$("input#tag-embed").prop("checked",n.getFilterEmbed());$("input#tag-embed").change(function(){e().getSettings().setFilterEmbed($(this).is(":checked"));e().saveSettings()});$("input#sound").prop("checked",n.getSoundEnabled());$("input#sound").change(function(){e().getSettings().setSoundEnabled($(this).is(":checked"));e().saveSettings()});$("input#latestinpopup").prop("checked",n.getShowLatestInPopup());$("input#latestinpopup").change(function(){e().getSettings().setShowLatestInPopup($(this).is(":checked"));e().saveSettings()});$("input#mathjax").prop("checked",n.getMathJaxEnabled());$("input#mathjax").change(function(){e().getSettings().setMathJaxEnabled($(this).is(":checked"));e().saveSettings()});$("input#startallitems").prop("checked",n.getStartPageAllItems());$("input#startallitems").change(function(){e().getSettings().setStartPageAllItems($(this).is(":checked"));e().saveSettings()});$("input#notifications").prop("checked",n.getNotificationsEnabled());$("input#notifications").change(function(){e().getSettings().setNotificationsEnabled($(this).is(":checked"));e().saveSettings()});$("input#disableautoscan").prop("checked",n.getDisableAutoScan());$("input#disableautoscan").change(function(){e().getSettings().setDisableAutoScan($(this).is(":checked"));e().saveSettings()});$("input#disableautoselect").prop("checked",n.getDisableAutoSelect());$("input#disableautoselect").change(function(){e().getSettings().setDisableAutoSelect($(this).is(":checked"));e().saveSettings()});$("input#confirmmarkread").prop("checked",n.getConfirmMarkRead());$("input#confirmmarkread").change(function(){e().getSettings().setConfirmMarkRead($(this).is(":checked"));e().saveSettings()});$("input#truncatetitles").prop("checked",n.getTruncateTitles());$("input#truncatetitles").change(function(){e().getSettings().setTruncateTitles($(this).is(":checked"));e().saveSettings()});$("input#justifytext").prop("checked",n.getJustifyText());$("input#justifytext").change(function(){e().getSettings().setJustifyText($(this).is(":checked"));e().saveSettings()});$("input#usefavicons").prop("checked",n.getUseFavIcons());$("input#usefavicons").change(function(){e().getSettings().setUseFavIcons($(this).is(":checked"));e().saveSettings();e().notifyEngine("reloaddata")});$("input#faviconfromline").prop("checked",n.getFaviconOnFromline());$("input#faviconfromline").change(function(){e().getSettings().setFaviconOnFromline($(this).is(":checked"));e().saveSettings();e().notifyEngine("reloaddata")});$("input#usefaviconstitles").prop("checked",n.getUseFavIconsTitles());$("input#usefaviconstitles").change(function(){e().getSettings().setUseFavIconsTitles($(this).is(":checked"));e().saveSettings()});$("input#skipopmldupes").prop("checked",n.getSkipOpmlDupes());$("input#skipopmldupes").change(function(){e().getSettings().setSkipOpmlDupes($(this).is(":checked"));e().saveSettings()});$("input#disableheaderlistener").prop("checked",n.getDisableHeaderListener());$("input#disableheaderlistener").change(function(){e().getSettings().setDisableHeaderListener($(this).is(":checked"));e().saveSettings()});$("input.quicktag").blur(function(){var p=$(this);e().getSettings().setQuickTag(p.attr("id"),p.val());e().saveSettings()});$("input#qtag1").val(n.getQuickTag("qtag1"));$("input#qtag2").val(n.getQuickTag("qtag2"));$("input#qtag3").val(n.getQuickTag("qtag3"));$("input#qtag4").val(n.getQuickTag("qtag4"));$("input#qtag5").val(n.getQuickTag("qtag5"));var k=new Date();$("select#dateformat option").each(function(){$(this).text(k.format($(this).val()))});$("select#theme").val(n.getTheme());$("select#theme").change(function(){e().getSettings().setTheme($(this).val());e().saveSettings();e().updateTheme();h()});$("select#bodyfontsize").val(n.getArticleBodyFontSize());$("select#bodyfontsize").change(function(){e().getSettings().setArticleBodyFontSize($(this).val());e().saveSettings();e().updateCss()});$("select#titlefontsize").val(n.getTitleFontSize());$("select#titlefontsize").change(function(){e().getSettings().setTitleFontSize($(this).val());e().saveSettings();e().updateCss()});var m,o;for(m=1;m<=6;m++){o=$("select#articlewidth"+m);o.val(String(n.getArticleWidth(m)));o.change(function(){e().getSettings().setArticleWidth($(this).attr("data-mode"),$(this).val());e().saveSettings();e().updateCss()})}$("select#cardheight").val(n.getCardHeight());$("select#cardheight").change(function(){e().getSettings().setCardHeight($(this).val());e().saveSettings();e().updateCss()});$("select#articlefontfamily").val(n.getArticleFontFamily());$("select#articlefontfamily").change(function(){e().getSettings().setArticleFontFamily($(this).val());e().saveSettings();e().updateCss()});$("select#lineheight").val(n.getArticleLineHeight());$("select#lineheight").change(function(){e().getSettings().setArticleLineHeight($(this).val());e().saveSettings();e().updateCss()});$("select#dateformat").val(n.getDateFormat());$("select#dateformat").change(function(){e().getSettings().setDateFormat($(this).val());e().saveSettings()});$("select#inactivelimit").val(n.getInactiveFeedLimit());$("select#inactivelimit").change(function(){e().getSettings().setInactiveFeedLimit($(this).val());e().saveSettings()});$("select#confirmmode").val(n.getConfirmMarkReadMode());$("select#confirmmode").change(function(){e().getSettings().setConfirmMarkReadMode($(this).val());e().saveSettings()});$("div#left").click(function(){i.restoreView()});$("div#right").click(function(){i.restoreView()});$("select#locale").change(function(p){var q=$(this).val();e().selectLocale(q);i.refreshLocale()});$("a#importLocale").click(function(p){p.preventDefault();alertify.prompt(Locale.i18n("options_locale_url",true),function(r,q){if(r){i.updateLocale(q)}})});$("a#updateLocale").click(function(p){p.preventDefault();var r=$("select#locale").val();if(r=="custom"){var q=e().getSettings().getLocaleMeta();i.updateLocale(q.locale_source_url)}});$("#templateLocale").click(function(p){p.preventDefault();i.getLocaleTemplate()});if(navigator.userAgent.indexOf("Firefox")==-1){$(".filter-firefox").css("display","none")}};this.updateLocale=function(k){e().installLocale(k,function(l){i.refreshLocale();alertify.alert(Locale.i18n("options_action_locale_update_success",true))},function(l){setTimeout(function(){alertify.alert(Locale.i18n("options_action_locale_update_failed",true,l))},500)})};this.refreshLocale=function(){var l=e().getSettings();var m=l.getLocaleMeta();Locale.start();Locale.activeMap=e().getActiveLocaleMap();Locale.translate(true);alertify.set({labels:{cancel:Locale.i18n("dialog_cancel",true),ok:Locale.i18n("dialog_ok",true)}});if(m){var n=$("#locale option[value='custom']");var k=new feedbro.Strings();if(n==undefined||n.length==0){$("#locale").append("<option value='custom'>"+k.escapeHtml(m.locale_name+" ("+m.locale_type+")")+"</option>")}else{n.html(k.escapeHtml(m.locale_name+" ("+m.locale_type+")"))}}$("#locale").val(l.getLocale())};this.getLocaleTemplate=function(){i.downloadFile(JSON.stringify(e().getDefaultLocaleMap(),undefined,4),"feedbro-locale-en_US.json","application/json")};this.restoreView=function(){chrome.tabs.query({title:"Feedbro"},function(k){if(k.length>0){chrome.tabs.update(k[0].id,{active:true})}else{document.location.href="reader.html"}})}};var feedbro=feedbro||{};feedbro.Persistence={};feedbro.Persistence.loadValue=function(a,b){chrome.storage.local.get(a,function(c){if(chrome.runtime.lastError){console.log("chrome.storage.local.get failed! Reload the extension or restart the browser. Error: ",chrome.runtime.lastError)}else{b(c[a])}})};feedbro.Persistence.saveValue=function(a,b,d){var c={};c[a]=b;chrome.storage.local.set(c,function(){if(chrome.runtime.lastError){console.log("Failed to save: Persistence.saveValue with parameter: "+a,chrome.runtime.lastError)}if(d){d()}})};var feedbro=feedbro||{};feedbro.RuleEngine=function(){var k=this;var l;var f=0;var e=0;var d=0;var j=0;var g=false;var a;var c=[];var h=new feedbro.Strings();var b=false;var i=false;this.setDebug=function(m){b=m};this.isEnabled=function(){return g};this.setEnabled=function(m){g=m};this.setActionHandler=function(m){a=m};this.process=function(n,o,q,m){if(!g){return}if(a==undefined){feedbro.log("RuleEngine: undefined ActionHandler");return}var p=[];k.evaluateRulesForEntry(n,o,p);if(p.length>0){a.processActions(o,p,q,m)}};this.evaluateRulesForAllEntries=function(o,m){if(!g){return[]}d=0;var p=[];feedbro.log("evaluateRulesForAllEntries: start");for(var n=0;n<m.length;n++){k.evaluateRulesForEntry(o,m[n],p)}feedbro.log("evaluateRulesForAllEntries: matched rules: "+d+" actions: "+p.length);return p};this.evaluateRulesForEntry=function(o,w,q,n){if(!g){return}var s;for(s=0;s<c.length;s++){var u=k.evaluate(o,w,c[s]);if(u!=false){for(var r=0;r<u.length;r++){q.push(u[r])}if(n){try{n(c[s])}catch(v){feedbro.log("RuleListener error",v)}}if(c[s].fallthrough!=undefined&&c[s].fallthrough==false){break}}}if(q&&q.length>0){var p;var t=false;var m=false;for(s=0;s<q.length;s++){p=q[s];if(p.type==feedbro.RuleEngine.ACTION_HIDEARTICLE){t=p}else{if(p.type==feedbro.RuleEngine.ACTION_DELETEARTICLE){m=p}}}if(t||m){q.length=0;if(t){q.push(t)}if(m){q.push(m)}}}};this.evaluate=function(n,x,v){if(!g){return false}if(!v.enabled){return false}if(v.trigger!=n){return false}if(v.contexttype==2&&(x.folderid!=v.contextvalue&&!h.inArray(String(x.folderid),v.contextvalue))){return false}if(v.contexttype==3&&(x.feedid!=v.contextvalue&&!h.inArray(String(x.feedid),v.contextvalue))){return false}var s=[];var y,u;for(var q=0;q<v.conditions.length;q++){u=v.conditions[q];y="";if(u.target==1){y=x.content}else{if(u.target==2){y=x.author}else{if(u.target==3){y=x.title}else{if(u.target==4){y=x.link}}}}var o=(u.casemode==2);if(u.mode==1){if(u.value==""||u.value==undefined){s.push(v)}else{if((u.regexp instanceof RegExp)==false){u.regexp=h.getRegexp(u.value,o?"gi":"g")}u.regexp.lastIndex=0;if(u.regexp.test(y)){s.push(v)}}}else{if(u.mode==2&&h.indexOf(y,u.value,0,o)!=-1){s.push(v)}else{if(u.mode==3&&h.indexOf(y,u.value,0,o)==-1){s.push(v)}else{if(u.mode==4&&h.equals(y,u.value,o)){s.push(v)}else{if(u.mode==5&&h.equals(y,u.value,o)==false){s.push(v)}else{if(u.mode==6&&h.startsWith(y,u.value,o)){s.push(v)}else{if(u.mode==7&&h.endsWith(y,u.value,o)){s.push(v)}else{if(u.mode==8){if(u.words==undefined){u.words=h.splitTrim(u.value,",").join(",")}if(h.containsWords(y,u.words,o)){s.push(v)}}else{if(u.mode==9){if(u.words==undefined){u.words=h.splitTrim(u.value,",").join(",")}if(h.doesNotContainWords(y,u.words,o)){s.push(v)}}else{if(u.mode==10){if(u.words==undefined){u.words=h.splitTrim(u.value,",").join(",")}if(h.containsAnyWord(y,u.words,o)){s.push(v)}}else{if(u.mode==11){if((u.regexp instanceof RegExp)==false){var r="(?:\\s|\\.|\\,|\\!|\\?|\\(|\\)|\\'|\\\"|\\t|>|:|;|^)";var m="(?:\\s|\\.|\\,|\\!|\\?|\\(|\\)|\\'|\\\"|\\t|<|:|;|$)";var w=u.value?u.value:"";w=w.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");var p=r+"("+h.splitTrim(w,",").join("|")+")\\S*"+m;u.regexp=h.getRegexp(p,o?"gi":"g")}u.regexp.lastIndex=0;if(u.regexp.test(y)){s.push(v)}}}}}}}}}}}}if(v.match==2&&s.length>0){break}if(v.match==3&&s.length>0){break}}var t=false;if(v.match==1&&s.length==v.conditions.length){t=true}else{if(v.match==2&&s.length>0){t=true}else{if(v.match==3&&s.length==0){t=true}}}if(!t){return false}d++;return v.actions};this.sortRules=function(){c.sort(function(n,m){if(n.order==undefined||m.order==undefined){return 0}return n.order-m.order})};this.deleteRules=function(){c=[]};this.saveRules=function(){feedbro.Persistence.saveValue("rules",JSON.stringify(c))};this.loadRules=function(){feedbro.Persistence.loadValue("rules",function(m){if(chrome.runtime.lastError==undefined){i=true;feedbro.log("Rules loaded successfully.")}else{feedbro.log("Failed to load Rules! ",chrome.runtime.lastError)}if(m!=undefined){c=JSON.parse(m)}})};this.isLoaded=function(){return i};this.getRules=function(){return c};this.getRule=function(n){for(var m=0;m<c.length;m++){if(c[m].id==n){return c[m]}}return{}};this.importRules=function(n){var m=JSON.parse(n);var s,p,o,r,t,q;var u=chrome.extension.getBackgroundPage().feedbrobg.getFeedTree();for(p=0;p<m.length;p++){s=m[p];if(!s.schema||!s.name){feedbro.log("Skipped invalid Rule: ",s);continue}if(s.contextvaluetext){if(s.contexttype=="2"){r=[];for(o=0;o<s.contextvaluetext.length;o++){q=u.searchNodes({name:s.contextvaluetext[o],type:2});if(q&&q.length>0){t=q[0];r.push(t.data.id+"")}}s.contextvalue=r}else{if(s.contexttype=="3"){r=[];for(o=0;o<s.contextvaluetext.length;o++){q=u.searchNodes({url:s.contextvaluetext[o],type:1});if(q&&q.length>0){t=q[0];r.push(t.data.id+"")}}s.contextvalue=r}}delete s.contextvaluetext}k.addRule(s);feedbro.log("Imported rule: ",s)}k.saveRules()};this.exportRules=function(){var u=chrome.extension.getBackgroundPage().feedbrobg.getFeedTree();var s,n,m,t,p,q;var v=[];for(var o=0;o<c.length;o++){s=c[o];if(s.contextvalue!=null){var r=[];for(n=0;n<s.contextvalue.length;n++){m=parseInt(s.contextvalue[n],10);q=parseInt(s.contexttype,10);if(q==3){q=1}p=u.searchNodes({id:m,type:q});if(p&&p.length>0){t=p[0];if(t.data.type==2){r.push(t.data.name)}else{if(t.data.type==1){r.push(t.data.url)}else{feedbro.log("Did not identify entry data type: "+t.data.type)}}}}s=JSON.parse(JSON.stringify(s));s.contextvaluetext=r}v.push(s)}return v};this.addRule=function(n){if(n.id==undefined){n.id=new Date().getTime()+j++}n=jQuery.extend(true,{},n);for(var m=0;m<c.length;m++){if(c[m].id==n.id){c[m]=n;return}}c.push(n)};this.deleteRule=function(n){for(var m=0;m<c.length;m++){if(c[m].id==n){c.splice(m,1);feedbro.log("RuleEngine: Removed rule with id "+n);return}}}};feedbro.RuleEngine.EVENT_ITEM_ARRIVED=1;feedbro.RuleEngine.EVENT_ITEM_VIEWED=2;feedbro.RuleEngine.ACTION_NOTIFICATION=1;feedbro.RuleEngine.ACTION_HIDEARTICLE=2;feedbro.RuleEngine.ACTION_DELETEARTICLE=3;feedbro.RuleEngine.ACTION_STAR=4;feedbro.RuleEngine.ACTION_MARKREAD=5;feedbro.RuleEngine.ACTION_PLAYSOUND=6;feedbro.RuleEngine.ACTION_HIGHLIGHTBORDER=7;feedbro.RuleEngine.ACTION_HIGHLIGHTREGEXP=8;feedbro.RuleEngine.ACTION_ADDTAG=9;feedbro.RuleEngine.ACTION_IFTTT_MAKERPOST=11;feedbro.RuleEngine.ACTION_ADD_POINTS=12;feedbro.RuleEngine.ACTION_PLAYSOUNDURL=13;feedbro.RuleEngine.ACTION_DISABLEAUTOPLAY=14;feedbro.RuleEngine.ACTION_DISCORD=15;feedbro.RuleEngine.ACTION_SLACK=16;feedbro.RuleEngine.IGNORE_ACTIONS_ARRIVE={2:true,7:true,8:true};feedbro.RuleEngine.IGNORE_ACTIONS_ARRIVE_FIRSTLOAD={1:true,2:true,6:true,7:true,8:true,13:true,15:true,16:true};feedbro.RuleEngine.IGNORE_ACTIONS_VIEW={1:true,9:true,11:true,12:true,13:true,14:true,15:true,16:true};feedbro.RuleEngine.IGNORE_ACTIONS_UPDATED={1:true,2:true,6:true,7:true,8:true,11:true,13:true};var feedbro=feedbro||{};feedbro.RuleEngineUI=function(){var b=this;var c=0;var f=0;var e=new feedbro.Strings();var d="div#feed";function a(){return chrome.extension.getBackgroundPage().feedbrobg}this.setContainerName=function(g){d=g};this.init=function(){$("div#ruleform #contexttype").change(function(){var g=$(this).val();b.setContextType(g)});$("div#ruleform a#delete").click(function(){var g=$("input#ruleid").val();if(g!=""){alertify.confirm(Locale.i18n("ruleview_delete_confirm",false),function(h){if(h){a().getRuleEngine().deleteRule(g);b.showForm(false);a().getRuleEngine().saveRules();b.printRuleList()}})}return false});$("div#ruleform a#save").click(function(){try{var h=b.formToRule();var i=a().getRuleEngine();i.addRule(h);i.saveRules();b.showForm(false);b.printRuleList()}catch(g){alertify.alert(g.message)}return false});$("div#ruleform a#addcondition").click(function(){b.addCondition();b.centerForm();return false});$("div#ruleform a#addaction").click(function(){b.addAction();b.centerForm();return false});$("div#ruleform a#reset").click(function(){b.resetForm();return false});$("div#ruleform a#cancel").click(function(){b.showForm(false);return false});$("div#rulesimulationform > nav > a#simulateClose").click(function(){b.showSimulateForm(false);return false});$("div#rulesimulationform > nav > a#simulateRun").click(function(){var i=parseInt($("select#simulationtrigger").val(),10);var k=$("select#simulationcontextvalue").val().split(":");var h=parseInt(k[0],10);var g=parseInt(k[1],10);var l={title:$("input#simulationTitle").val(),link:$("input#simulationURL").val(),content:$("textarea#simulationContent").val(),author:$("input#simulationAuthor").val(),feedid:h,folderid:g};var m=[];var j="";a().getRuleEngine().evaluateRulesForEntry(i,l,m,function(n){j+=e.escapeHtml(n.name)+"\n"});$("textarea#simulationResult").val(j!=""?j:Locale.i18n("ruleview_no_matches",true))})};this.setContextType=function(j){var h=$("select#contextvalue");var g;if(j==1){h.css({display:"none"})}if(j==2){g=a().getFeedTree();h.empty();h.append('<option value="-1">'+Locale.i18n("common_root",true)+"</option>");g.processNodes(g.getRoot(),function(k){if(k.data.type==feedbro.FeedTree.FOLDER){h.append('<option value="'+k.data.id+'">'+e.escapeHtml(k.data.name)+"</option>")}},feedbro.FeedTree.MODE_TOPNODES);h.css({display:"block"})}if(j==3){var i="";g=a().getFeedTree();g.processNodes(g.getRoot(),function(m){if(m.data.type==feedbro.FeedTree.FOLDER){i+='<optgroup label="'+e.escapeHtml(m.data.name)+'">';var l=m.children;for(var k=0;k<l.length;k++){i+='<option value="'+l[k].data.id+'">'+e.escapeHtml(l[k].data.name)+"</option>"}i+="</optgroup>"}else{i+='<option value="'+m.data.id+'">'+e.escapeHtml(m.data.name)+"</option>"}},feedbro.FeedTree.MODE_TOPNODES);h.html(i);h.css({display:"block"})}};this.addAction=function(){var g=$("tr#actiontemplate").clone();f++;g.attr("id","action-"+f);g.css({display:"table-row"});g.find("select.action-type").attr("id","action-type-"+f);g.find("select.action-type").data("value",f);g.find("input.action-value").attr("id","action-value-"+f);g.find("select.action-sound").attr("id","action-sound-"+f);g.find("input.action-color").attr("id","action-color-"+f);g.find("select.action-type").change(function(){var h=$(this);var i=h.val();if(i=="6"){g.find("input.action-value").css({display:"none"});g.find("input.action-color").css({display:"none"});g.find("select.action-sound").css({display:"inline-block"});g.find("select.action-sound").change(function(){var j=$(this).val();a().getSoundPlayer().play("sound/"+j)})}else{if(i=="7"){g.find("input.action-color").css({display:"inline-block"});g.find("input.action-value").css({display:"none"});g.find("select.action-sound").css({display:"none"})}else{if(i=="8"||i=="9"||i=="10"||i=="11"||i=="12"||i=="13"||i=="15"||i=="16"){g.find("input.action-value").css({display:"inline-block"});g.find("input.action-color").css({display:"none"});g.find("select.action-sound").css({display:"none"})}else{g.find("input.action-value").css({display:"none"});g.find("input.action-color").css({display:"none"});g.find("select.action-sound").css({display:"none"})}}}});g.find("a.action-remove").click(function(h){return function(i){$("tr#action-"+h).remove();i.stopPropagation();return false}}(f));g.insertBefore($("tr#actiontemplate"));return f};this.addCondition=function(){var g=$("tr#condtemplate").clone();c++;g.attr("id","condition-"+c);g.css({display:"table-row"});g.find("select.cond-target").attr("id","cond-target-"+c);g.find("select.cond-target").data("value",c);g.find("select.cond-mode").attr("id","cond-mode-"+c);g.find("input.cond-value").attr("id","cond-value-"+c);g.find("select.cond-casemode").attr("id","cond-casemode-"+c);g.find("a.cond-remove").click(function(h){return function(i){$("tr#condition-"+h).remove();i.stopPropagation();return false}}(c));g.insertBefore($("tr#condtemplate"));return c};this.formToRule=function(){var g={};g.id=$("input#ruleid").val();if(g.id==""){g.id=new Date().getTime()+""}g.schema=1;g.enabled=$("input#enabled").prop("checked");g.fallthrough=$("input#fallthrough").prop("checked");g.name=$("input#name").val().trim();g.trigger=$("select#trigger").val();g.contexttype=$("select#contexttype").val();g.contextvalue=$("#contextvalue").val();g.match=$("select#match").val();g.conditions=[];g.actions=[];if(g.name==""||g.name.length<1){throw new Error(Locale.i18n("ruleview_error_name_missing",true))}if(g.name.length>80){throw new Error(Locale.i18n("ruleview_error_name_toolong",true))}if(g.contexttype==2&&g.contextvalue==undefined){throw new Error(Locale.i18n("ruleview_error_folder_missing",true))}if(g.contexttype==3&&g.contextvalue==undefined){throw new Error(Locale.i18n("ruleview_error_feed_missing",true))}$("select.cond-target").each(function(k,l){var i=$(l);var h=i.data("value");if(!h){return}var j={};j.target=i.val();j.mode=$("select#cond-mode-"+h).val();j.value=$("input#cond-value-"+h).val();j.casemode=$("select#cond-casemode-"+h).val();if(j.mode==1){e.getRegexp(j.value)}g.conditions.push(j)});$("select.action-type").each(function(k,l){var i=$(l);var h=i.data("value");if(!h){return}var m=parseInt(i.val(),10);if(g.trigger=="1"){if(m==feedbro.RuleEngine.ACTION_HIDEARTICLE){throw new Error(Locale.i18n("ruleview_error_hidearticle",true))}if(m==feedbro.RuleEngine.ACTION_HIGHLIGHTBORDER){throw new Error(Locale.i18n("ruleview_error_highlightborder",true))}if(m==feedbro.RuleEngine.ACTION_HIGHLIGHTREGEXP){throw new Error(Locale.i18n("ruleview_error_highlightregexp",true))}}else{if(g.trigger=="2"){if(m==feedbro.RuleEngine.ACTION_NOTIFICATION){throw new Error(Locale.i18n("ruleview_error_notification",true))}if(m==feedbro.RuleEngine.ACTION_ADDTAG){throw new Error(Locale.i18n("ruleview_error_addtag",true))}if(m==feedbro.RuleEngine.ACTION_IFTTT_MAKERPOST){throw new Error(Locale.i18n("ruleview_error_ifttt",true))}if(m==feedbro.RuleEngine.ACTION_HIDEARTICLE&&g.conditions.length==0){throw new Error(Locale.i18n("ruleview_error_hidearticle_condition",true))}if(m==feedbro.RuleEngine.ACTION_DELETEARTICLE&&g.conditions.length==0){throw new Error(Locale.i18n("ruleview_error_delete_condition",true))}if(m==feedbro.RuleEngine.ACTION_ADD_POINTS){throw new Error(Locale.i18n("ruleview_error_addpoints",true))}if(m==feedbro.RuleEngine.ACTION_DISABLEAUTOPLAY){throw new Error(Locale.i18n("ruleview_error_disableautoplay",true))}}}var j={};j.type=i.val();if(j.type=="6"){j.value=$("select#action-sound-"+h).val()}else{if(j.type=="7"){j.value=$("input#action-color-"+h).val()}else{j.value=$("input#action-value-"+h).val()}}if(j.type=="8"){if(j.value==undefined||j.value.trim().length<1){throw new Error(Locale.i18n("ruleview_error_emptyregexp",true))}e.getRegexp(j.value)}if(j.type=="9"){if(j.value==undefined||j.value.trim().length<1){throw new Error(Locale.i18n("ruleview_error_emptytag",true))}}if(j.type=="12"){if(!e.isInt(j.value)){throw new Error(Locale.i18n("ruleview_error_invalidpoints",true))}}if(j.type=="11"){if(j.value==undefined||j.value.trim().length<1){throw new Error(Locale.i18n("ruleview_error_ifttt_emptyurl",true))}if((j.value+"").indexOf("https://maker.ifttt.com")!=0){throw new Error(Locale.i18n("ruleview_error_ifttt_invalidurl",true))}}if(j.type=="13"){if(j.value==undefined||j.value.trim().length<1){throw new Error(Locale.i18n("ruleview_error_emptyplayurl",true))}}g.actions.push(j)});if(g.actions.length<1){throw new Error(Locale.i18n("ruleview_error_noaction"))}return g};this.ruleToForm=function(l){var h,g,j,k;b.resetForm();$("a#delete").css({display:"inline-block"});$("input#ruleid").val(l.id);$("input#enabled").prop("checked",l.enabled);$("input#fallthrough").prop("checked",l.fallthrough==undefined||l.fallthrough==true);$("input#name").val(l.name);$("select#trigger").val(l.trigger);$("select#contexttype").val(l.contexttype);b.setContextType(l.contexttype);$("#contextvalue").val(l.contextvalue);$("select#match").val(l.match);if(jQuery.isArray(l.conditions)){for(h=0;h<l.conditions.length;h++){j=l.conditions[h];g=b.addCondition();$("select#cond-target-"+g).val(j.target);$("select#cond-mode-"+g).val(j.mode);$("input#cond-value-"+g).val(j.value);$("select#cond-casemode-"+g).val(j.casemode)}}if(jQuery.isArray(l.actions)){for(h=0;h<l.actions.length;h++){k=l.actions[h];g=b.addAction();$("select#action-type-"+g).val(k.type);if(k.type=="6"){$("select#action-sound-"+g).val(k.value);$("select#action-sound-"+g).css({display:"inline-block"});$("select#action-sound-"+g).change(function(){var i=$(this).val();a().getSoundPlayer().play("sound/"+i)})}else{if(k.type=="7"){$("input#action-color-"+g).val(k.value);$("input#action-color-"+g).css({display:"inline-block"})}else{if(k.type=="8"||k.type=="9"||k.type=="10"||k.type=="11"||k.type=="12"||k.type=="13"||k.type=="15"||k.type=="16"){$("input#action-value-"+g).val(k.value);$("input#action-value-"+g).css({display:"inline-block"})}}}}}};this.showForm=function(g){var h=$("div#ruleform");h.css({display:g?"block":"none",position:"absolute"});b.centerForm();h.find("input#name").focus()};this.centerForm=function(){var g=$("div#ruleform");g.css({top:Math.max(0,(($(window).height()-g.outerHeight())/2)+$(window).scrollTop())+"px",left:Math.max(0,(($(window).width()-g.outerWidth())/2)+$(window).scrollLeft())+"px"})};this.printRuleList=function(){var n="";if(a().getRuleEngine().isLoaded()==false){n+="<div class='info'><div class='info-message'>"+Locale.i18n("ruleview_error_loading",true)+"</div></div>";$(d).html(n);return}var q=a().getRuleEngine().getRules();var o="<center>";o+="<button id='addrule' class='alertify-button alertify-button-ok'>"+Locale.i18n("ruleview_action_addrule_body",true)+"</button>";o+="<button id='testrules' class='alertify-button alertify-button-ok'>"+Locale.i18n("ruleview_action_testrules_body",true)+"</button>";o+="</center>";if(q.length==0){n+="<div class='info'><div class='info-message'>"+Locale.i18n("ruleview_no_rules_yet_body",true)+"</div></div>";n+=o;$(d).html(n)}else{n+="<table id='rulelist' class='feedtable'>";n+="<thead><tr><th></th>";n+="<th>"+Locale.i18n("ruleview_name_body",true)+"</th>";n+="<th class='center'>"+Locale.i18n("ruleview_type_body",true)+"</th>";n+="<th class='center'>"+Locale.i18n("ruleview_enabled_body",true)+"</th>";n+="<th class='center'>"+Locale.i18n("ruleview_fallthrough_body",true)+"</th>";n+="</tr></thead><tbody id='rulelistbody'>";var h=Locale.i18n("ruleview_table_row_title",true);var j=Locale.i18n("ruleview_table_clickedit_title",true);var p=Locale.i18n("ruleview_table_arrive_title",true);var l=Locale.i18n("ruleview_table_view_title",true);var k=Locale.i18n("ruleview_table_inactive_title",true);var g=Locale.i18n("ruleview_table_fallthrough_title",true);for(var m=0;m<q.length;m++){n+="<tr class='feedtablerow' draggable='true' id='rule-"+q[m].id+"' style='cursor: move' title='"+h+"'>";n+="<td class='rownumber'>"+(m+1)+".</td>";n+="<td><a href='#' title='"+j+"' class='rulelink' style='cursor: hand'>"+e.escapeHtml(q[m].name)+"</a></td>";n+="<td class='center'><img width='16' class='ruletype-icon' src='images/"+(q[m].trigger=="1"?"email.png' title='"+p+"'":"eye.png' title='"+l+"'")+"></td>";n+="<td class='center' title='"+k+"'>"+(q[m].enabled?"&#x2714;":"")+"</td>";n+="<td class='center' title='"+g+"'>"+(q[m].fallthrough==false?"":"&#x2714;")+"</td>";n+="</tr>"}n+="</tbody></table>";n+=o;$(d).html(n);$("a.rulelink").click(function(){var r=$(this).parent().parent().attr("id").substring(5);var i=a().getRuleEngine().getRule(r);b.ruleToForm(i);b.showForm(true);return false});feedbro.dndTable.create("rulelist",b.updateTable)}$("button#addrule").click(function(){b.resetForm();b.showSimulateForm(false);b.showForm(true);return false});$("button#testrules").click(function(){b.showForm(false);b.showSimulateForm(true);return false})};this.showSimulateForm=function(i){var k=$("div#rulesimulationform");var l=$(window);k.css({display:i?"block":"none",position:"absolute",top:Math.max(0,((l.height()-k.outerHeight())/2)+l.scrollTop())+"px",left:Math.max(0,((l.width()-k.outerWidth())/2)+l.scrollLeft())+"px"});if(i){$("textarea#simulationResult").val("");var h=$("select#simulationcontextvalue");var j="";var g=a().getFeedTree();g.processNodes(g.getRoot(),function(o){if(o.data.type==feedbro.FeedTree.FOLDER){j+='<optgroup label="'+e.escapeHtml(o.data.name)+'">';var n=o.children;for(var m=0;m<n.length;m++){j+='<option value="'+n[m].data.id+":"+o.data.id+'">'+e.escapeHtml(n[m].data.name)+"</option>"}j+="</optgroup>"}else{j+='<option value="'+o.data.id+':-1">'+e.escapeHtml(o.data.name)+"</option>"}},feedbro.FeedTree.MODE_TOPNODES);h.html(j)}};this.updateTable=function(g){$("tbody#rulelistbody tr").each(function(h,j){var l=$(j);var i=l.attr("id").substring(5);l.find("td.rownumber").html((h+1)+".");l.attr("data-order",(h+1));var k=a().getRuleEngine().getRule(i);k.order=h+1});a().getRuleEngine().sortRules();a().getRuleEngine().saveRules()};this.resetForm=function(){$("a#delete").css({display:"none"});$("input#ruleid").val("");$("input#enabled").prop("checked",true);$("input#fallthrough").prop("checked",true);$("input#name").val("");$("select#trigger").val("1");$("select#contexttype").val(1);b.setContextType(1);$("select#match").val(1);$("tr.condition").each(function(g,i){var h=$(i);if(h.attr("id")!="condtemplate"){h.remove()}});$("tr.action").each(function(g,i){var h=$(i);if(h.attr("id")!="actiontemplate"){h.remove()}})}};var feedbro=feedbro||{};feedbro.RumblePlugin=function(){};feedbro.RumblePlugin.prototype.setDebug=function(a){this._debug=a};feedbro.RumblePlugin.prototype.canParse=function(a){return a&&a.indexOf("https://rumble.com/c/")==0};feedbro.RumblePlugin.prototype.parse=function(e,c,a,f){var b=this;var d=new XMLHttpRequest();d.onerror=function(){a.error={};a.error.message="Network error";a.error.code=398;a.status=398};d.onreadystatechange=function(h){var g=h.target;if(g.readyState==4){g.onreadystatechange=null;if(g.status!=0){g.onerror=null}var j="";if(g.status==200){try{j=b.toRSS(g.responseText,e.url)}catch(i){}}c(e.url,g,j,a,f,true)}};d.open("GET",e.url,true);d.timeout=e.timeout?(e.timeout+0):10000;d.send()};feedbro.RumblePlugin.prototype.toRSS=function(o,g){var n=new feedbro.Strings();var z,y,r;var t,l;t={stag:["<title>"],etag:"</title>"};n.findNext(o,t);r=t.match;t={stag:["<ol>"],etag:"</ol>"};n.findNext(o,t);l=t.match;var d=new DOMParser();var A=d.parseFromString(l,"text/html");var w,j,x,p,c,f,m,q,u,k=[],h=A.querySelectorAll("li.video-listing-entry");for(w=0;w<h.length;w++){j=h[w];f=j.querySelector(".video-item--img").getAttribute("src");c=f;c=c.replace(/(i|sp)\.rmbl\.ws\/(\w+)\/(\w+)\//,function(a,b,i,e){if((b=="i"&&e=="6")||(b=="i"&&e=="1")){m="1";b="sp"}else{m="1";b="sp"}return b+".rmbl.ws/"+i+"/2/"});z=c.lastIndexOf("/");z=c.indexOf(".",z);c=c.substring(0,z);p=c+".caa."+m+".mp4?u=3&b=0";u='<div><div class="youtubevideo" data-link="'+n.escapeHref(p)+'"><img src="'+n.escapeHref(f)+'" class="thumb"><div class="play"></div></div></div>';x={title:j.querySelector("h3").innerText,author:j.querySelector("a.video-item--by-a > div").innerText,publishedDate:new Date(j.querySelector("time").getAttribute("datetime")),link:"https://rumble.com"+j.querySelector("a.video-item--a").getAttribute("href"),content:u};k.push(x)}d=null;A=null;return feedbro.Strings.toRSS(r+" | Rumble",g,k)};var feedbro=feedbro||{};feedbro.Settings=function(){var a={timeout:25000,maxentries:20,polldelay:30,onlyunread:false,itemmaxage:-1,dateformat:"ddd mmm dd yyyy HH:MM:ss",itemsortorder:1,inactivefeedlimit:180,filteriframe:false,filterembed:false,showcontent:true,hidenounread:false,sound:true,notifications:true,notificationtimeout:8000,viewmode:0,winleftpane:270,wintitles:500,confirmmarkread:false,confirmmarkreadmode:2,startpageallitems:false,theme:"light",markreadmode:1,iconclick:1,articlebodyfontsize:110,articlefontfamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Cantarell", "Helvetica Neue", sans-serif',favicons:true,hideempty:false,popupclick:1,latestinpopup:true,mathjax:false,iconclickreloads:false,justifytext:false,faviconstitles:true,faviconfromline:false,qtag1:"",qtag2:"",qtag3:"",qtag4:"",qtag5:"",targetlanguage:"en",articlelink:1,lineheight:"1.45",updatethreads:4,disableautoscan:false,cookiemanagement:false,skipopmldupes:true,faviconprovider:"duckduckgo",truncatetitles:true,viewautoreload:0,articlewidth1:950,articlewidth2:900,articlewidth3:-1,articlewidth4:900,articlewidth5:900,articlewidth6:-1,titlefontsize:100,cardheight:450,disableautoselect:false,locale:"en_US",disableheaderlistener:false};this.getLocale=function(){return a.locale};this.setLocale=function(b){a.locale=b};this.getLocaleMeta=function(){return a.localemeta};this.setLocaleMeta=function(b){a.localemeta=b};this.getDisableAutoSelect=function(){return a.disableautoselect};this.setDisableAutoSelect=function(b){a.disableautoselect=b};this.setCardHeight=function(b){a.cardheight=parseInt(b,10)};this.getCardHeight=function(){return a.cardheight};this.setTitleFontSize=function(b){a.titlefontsize=parseInt(b,10)};this.getTitleFontSize=function(){return a.titlefontsize};this.getArticleWidth=function(b){return a["articlewidth"+b]};this.setArticleWidth=function(c,b){a["articlewidth"+c]=b};this.getDisableHeaderListener=function(){return a.disableheaderlistener};this.setDisableHeaderListener=function(b){a.disableheaderlistener=b};this.getIconClickReloads=function(){return a.iconclickreloads};this.setIconClickReloads=function(b){a.iconclickreloads=b};this.getTruncateTitles=function(){return a.truncatetitles};this.setTruncateTitles=function(b){a.truncatetitles=b};this.setQuickTag=function(b,c){if(b.indexOf("qtag")!=0){throw new Error("Invalid key: "+b)}a[b]=c};this.getQuickTag=function(b){return a[b]};this.setViewAutoReload=function(b){a.viewautoreload=parseInt(b,10)};this.getViewAutoReload=function(){return a.viewautoreload};this.setUpdateThreads=function(b){a.updatethreads=parseInt(b,10)};this.getUpdateThreads=function(){return a.updatethreads};this.setSkipOpmlDupes=function(b){a.skipopmldupes=b};this.getSkipOpmlDupes=function(){return a.skipopmldupes};this.setCookieManagement=function(b){a.cookiemanagement=b};this.getCookieManagement=function(){return a.cookiemanagement};this.setDisableAutoScan=function(b){a.disableautoscan=b};this.getDisableAutoScan=function(){return a.disableautoscan};this.setFaviconOnFromline=function(b){a.faviconfromline=b};this.getFaviconOnFromline=function(){return a.faviconfromline};this.setArticleLinkMode=function(b){a.articlelink=b};this.getArticleLinkMode=function(){return a.articlelink};this.setArticleLineHeight=function(b){a.lineheight=b};this.getArticleLineHeight=function(){return a.lineheight};this.setFavIconProvider=function(b){a.faviconprovider=b};this.getFavIconProvider=function(){return a.faviconprovider};this.setTargetLanguage=function(b){a.targetlanguage=b};this.getTargetLanguage=function(){return a.targetlanguage};this.setTheme=function(b){a.theme=b};this.getTheme=function(){return a.theme};this.setJustifyText=function(b){a.justifytext=b};this.getJustifyText=function(){return a.justifytext};this.setHideEmpty=function(b){a.hideempty=b};this.getHideEmpty=function(){return a.hideempty};this.setMathJaxEnabled=function(b){a.mathjax=b};this.getMathJaxEnabled=function(){return a.mathjax};this.setConfirmMarkReadMode=function(b){a.confirmmarkreadmode=parseInt(b,10)};this.getConfirmMarkReadMode=function(){return a.confirmmarkreadmode};this.setConfirmMarkRead=function(b){a.confirmmarkread=b};this.getConfirmMarkRead=function(){return a.confirmmarkread};this.setStartPageAllItems=function(b){a.startpageallitems=b};this.getStartPageAllItems=function(){return a.startpageallitems};this.setShowLatestInPopup=function(b){a.latestinpopup=b};this.getShowLatestInPopup=function(){return a.latestinpopup};this.setUseFavIcons=function(b){a.favicons=b};this.getUseFavIcons=function(){return a.favicons};this.setUseFavIconsTitles=function(b){a.faviconstitles=b};this.getUseFavIconsTitles=function(){return a.faviconstitles};this.setPopupClickMode=function(b){a.popupclick=parseInt(b,10)};this.getPopupClickMode=function(){return a.popupclick};this.setIconClickMode=function(b){a.iconclick=parseInt(b,10)};this.getIconClickMode=function(){return a.iconclick};this.setMarkReadMode=function(b){a.markreadmode=parseInt(b,10)};this.getMarkReadMode=function(){return a.markreadmode};this.setFeedTimeout=function(b){a.timeout=parseInt(b,10)};this.getFeedTimeout=function(){return a.timeout};this.setFeedMaxEntries=function(b){a.maxentries=parseInt(b,10)};this.getFeedMaxEntries=function(){return a.maxentries};this.setNavigatorWidth=function(b){a.winleftpane=parseInt(b,10)};this.getNavigatorWidth=function(){return a.winleftpane};this.setTitlesWidth=function(b){a.wintitles=parseInt(b,10)};this.getTitlesWidth=function(){return a.wintitles};this.setViewMode=function(b){a.viewmode=parseInt(b,10)};this.getViewMode=function(){return a.viewmode};this.setArticleFontFamily=function(b){a.articlefontfamily=b};this.getArticleFontFamily=function(){return a.articlefontfamily};this.setArticleBodyFontSize=function(b){a.articlebodyfontsize=parseInt(b,10)};this.getArticleBodyFontSize=function(){return a.articlebodyfontsize};this.setPollDelay=function(b){a.polldelay=parseInt(b,10)};this.getPollDelay=function(){return a.polldelay};this.setHideNoUnread=function(b){a.hidenounread=b};this.getHideNoUnread=function(){return a.hidenounread};this.setSoundEnabled=function(b){a.sound=b};this.getSoundEnabled=function(){return a.sound};this.setNotificationsEnabled=function(b){a.notifications=b};this.getNotificationsEnabled=function(){return a.notifications};this.setOnlyUnread=function(b){a.onlyunread=b};this.getOnlyUnread=function(){return a.onlyunread};this.setShowContent=function(b){a.showcontent=b};this.getShowContent=function(){return a.showcontent};this.setMaxItemAge=function(b){a.itemmaxage=parseInt(b,10)};this.getMaxItemAge=function(){return a.itemmaxage};this.setNotificationTimeout=function(b){a.notificationtimeout=parseInt(b,10)};this.getNotificationTimeout=function(){return a.notificationtimeout};this.setDateFormat=function(b){a.dateformat=b};this.getDateFormat=function(){return a.dateformat};this.setItemSortOrder=function(b){a.itemsortorder=b};this.getItemSortOrder=function(){return a.itemsortorder};this.setInactiveFeedLimit=function(b){a.inactivefeedlimit=b};this.getInactiveFeedLimit=function(){return a.inactivefeedlimit};this.setFilterIframe=function(b){a.filteriframe=b};this.getFilterIframe=function(){return a.filteriframe};this.setFilterEmbed=function(b){a.filterembed=b};this.getFilterEmbed=function(){return a.filterembed};this.toJson=function(){return JSON.stringify(a)};this.fromJson=function(b){$.extend(a,JSON.parse(b))}};var feedbro=feedbro||{};feedbro.SlidesharePlugin=function(){this._timeout=15000;this._strings=new feedbro.Strings();this._debug=false};feedbro.SlidesharePlugin.prototype.setDebug=function(a){this._debug=a};feedbro.SlidesharePlugin.prototype.canParse=function(a){return a&&a.indexOf("https://www.slideshare.net/search/slideshow?")!=-1};feedbro.SlidesharePlugin.prototype.parse=function(c,i,k,g){var j=this;var a={};try{a=this._strings.getQueryParams(c.url)}catch(e){}var h=new XMLHttpRequest();h.onerror=function(){k.error={};k.error.message="Network error";k.error.code=398;k.status=398};h.onreadystatechange=function(m){var l=m.target;if(l.readyState==4){l.onreadystatechange=null;if(l.status!=0){l.onerror=null}var o="";if(l.status==200){try{o=j.toRSS(l.responseText,c.url,a.q)}catch(n){}}i(c.url,l,o,k,g,true)}};var b=this.generateUUID();var f="**";var d="https://www.slideshare.net/search/slideshow_ajax?q="+encodeURIComponent(a.q)+"&qf=&qid="+b+"&escape=1&ud=week&ft=all&lang="+f;h.open("GET",d,true);h.timeout=c.timeout?(c.timeout+0):10000;h.setRequestHeader("Accept","application/json");h.send()};feedbro.SlidesharePlugin.prototype.generateUUID=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(d){var b=Math.random()*16|0,a=d=="x"?b:(b&3|8);return a.toString(16)})};feedbro.SlidesharePlugin.prototype.toRSS=function(e,b,a){var j=[];var c=a+" | SlideShare Search";var f,g;if(e&&e!=""){var h=JSON.parse(e);var d=h.search_results;for(f=0;f<d.length;f++){g={title:d[f].title,link:"https://www.slideshare.net/"+d[f].url,publishedDate:new Date(d[f].created_at*1000),author:d[f].user_login,content:""};g.content='<table class="slideshare-result"><tr><td class="slideshare-thumb"><img class="slideshare-thumb-img" src="https:'+this._strings.escapeHref(d[f].thumb_url)+'"></td><td class="slideshare-description">'+feedbro.Strings.linkify(d[f].description)+"</td></tr></table>";j.push(g)}}return feedbro.Strings.toRSS(c,b,j)};var feedbro=feedbro||{};feedbro.SoundPlayer=function(){var b=this;var d=new feedbro.Strings();var a={};var e=[];var c;this.setSettings=function(f){c=f};this.queue=function(f){e.push(f)};this.playQueueUniques=function(){var f,g=d.removeDuplicates(e);for(f=0;f<g.length;f++){b.play(g[f])}e.length=0};this.playQueue=function(){for(var f=0;f<e.length;f++){b.play(e[f])}e.length=0};this.play=function(g){if(c.getSoundEnabled()!=true){return}var h=a[g];try{if(h==undefined){h=new Audio(g);a[g]=h;h.addEventListener("canplaythrough",function(){h.play()},false)}else{h.pause();h.currentTime=0;h.play()}}catch(f){}}};var feedbro=feedbro||{};feedbro.Strings=function(){};feedbro.Strings.regexpCache={};feedbro.Strings.wordCache={};feedbro.Strings.prototype.createProxyURL=function(b,c){var a="";if(b==undefined||c==undefined||c==0){return b}if(c==1){a="feedly"}if(b.indexOf("?")!=-1){return b+"&feedsrc="+a}else{return b+"?feedsrc="+a}};feedbro.Strings.toRSS=function(b,c,a){var d,f,g=[];g.push('<?xml version="1.0" encoding="UTF-8"?>\n<rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/">\n<channel>\n');g.push("  <title><![CDATA[");g.push(b);g.push("]]></title>\n");g.push("  <link>");g.push((c||"").replace(/&/g,"&amp;"));g.push("</link>\n");g.push("  <description><![CDATA[");g.push(b);g.push("]]></description>\n");a.sort(function(h,e){if(h.publishedDate&&e.publishedDate){return e.publishedDate.getTime()-h.publishedDate.getTime()}else{return 0}});for(d=0;d<a.length;d++){f=a[d];g.push("  <item>\n");g.push("    <title><![CDATA[");g.push(f.title?f.title:"");g.push("]]></title>\n");g.push("    <link><![CDATA[");g.push(f.link);g.push("]]></link>\n");g.push("    <author><![CDATA[");g.push(f.author);g.push("]]></author>\n");if(f.guid){g.push("    <guid>");g.push(f.guid);g.push("</guid>\n")}g.push("    <content:encoded><![CDATA[");g.push(f.content);g.push("]]></content:encoded>\n");if(f.publishedDate&&!isNaN(f.publishedDate)){g.push("    <pubDate>");g.push(f.publishedDate+"");g.push("</pubDate>\n")}g.push("  </item>\n")}g.push("</channel>\n</rss>");return g.join("")};feedbro.Strings.convertHashtags=function(n,b){if(n==undefined||n==""){return n}var e,j,g=n.length;var o="";var k=0;var l=0;var a=false;var f;var d;var m;var h=false;for(e=0;e<g;e++){d=false;j=n.charAt(e);if(j=="<"){l++}else{if(j==">"){l--}else{if(j=="#"&&l==0){if(e>0&&n.charAt(e-1)=="&"){continue}else{a=true;h=true;f=e;continue}}}}if(a&&(j==" "||j=="<"||j=="!"||j==","||j=="."||j=='"'||j=="/"||j=="&"||j==">"||j=="?"||j==")"||j=="("||j=="]"||j=="["||j=="\n"||j=="\r")){d=true;a=false;if((e-f+1)>1){m=n.substring(f+1,e);o+=n.substring(k,f)+b(m);k=e}}}if(!h){return n}if(a){m=n.substring(f+1,e);o+=n.substring(k,f)+b(m)}else{o+=n.substring(k)}return o};feedbro.Strings.prototype.disableAutoplay=function(c){var b,a;return(c||"").replace(/<(video|iframe|audio)[^>]+?>/g,function(d,e){if(e=="video"||e=="audio"){if(!b){b=/(autoplay|preload|autostart)(="[^"]*")*/g}return d.replace(b,function(f,h,g){if(h=="autoplay"||h=="autostart"){return""}if(h=="preload"&&(g=='="auto"'||g=='=""'||g=="")){return'preload="meta"'}return f})}if(e=="iframe"){if(!a){a=/auto(play|start)/g}return d.replace(a,"enabled")}})};feedbro.Strings.linkify=function(e,c,b){if(e==undefined||e==""){return e}var d=/\b(?:https?|ftp):\/\/([a-z0-9-+&@#\/%?=~_|!:,.;]*[a-z0-9-+&@#\/%=~_|])/gim;var f=/(^|[^\/])(www\.[\S]+(\b|$))/gim;var a=/[\w.]+@[a-zA-Z_-]+?(?:\.[a-zA-Z]{2,6})+/gim;if(b==undefined){b=""}var g='<a rel="noopener noreferrer" class="'+b+'" target="_blank" href="$&">$&</a>';if(c){g='<a rel="noopener noreferrer" class="'+b+'" target="_blank" href="$&">$1</a>'}return e.replace(d,g).replace(f,'$1<a rel="noopener noreferrer" class="'+b+'" target="_blank" href="http://$2">$2</a>').replace(a,'<a class="'+b+'" href="mailto:$&">$&</a>')};feedbro.Strings.prototype.getAttributeMap=function(p,k){var g,h,l,d={},b=false,e=false,f=false;var m,o,n,j;if(p==undefined){return d}h=p.length;for(g=0;g<h;g++){l=p.charAt(g);if(l==" "&&!b){b=true;continue}if(b&&!e&&!f){e=true;m=g;continue}if(b&&l=="="&&e){e=false;f=true;o=p.substring(m,g);m=g+2;if(g+1<h){j=p.charAt(g+1);if(j!='"'&&j!="'"){j=" ";m=g+1}else{g++}}continue}if(b&&f&&(l==j||l==">")){n=p.substring(m,g);f=false;e=false;d[k?o.toLowerCase():o]=this.unescapeHtml(n);g++}}return d};feedbro.Strings.prototype.getDatestamp=function(b){if(b==undefined){b=new Date()}var i=b.getFullYear();var f=b.getMonth()+1;var g=b.getDate();var e=b.getHours();var a=b.getMinutes();var c=b.getSeconds();return i+""+(f<10?"0"+f:f)+(g<10?"0"+g:g)+"-"+(e<10?"0"+e:e)+(a<10?"0"+a:a)+(c<10?"0"+c:c)};feedbro.Strings.prototype.timeAgo=function(e,a){var d=(new Date()-new Date(e))/1000;if(d<5){return Locale.i18n("timeago_now",true)}var b=0,c=feedbro.Strings.timeunits[b++];while(c){if(d<c.limit||!c.limit){d=Math.floor(d/c.in_seconds);if(a==true){return d+" "+Locale.i18n("timeago_"+c.name+"_shortName",true)}else{return d+" "+(d>1?Locale.i18n("timeago_"+c.name+"_plural",true):Locale.i18n("timeago_"+c.name,true))}}c=feedbro.Strings.timeunits[b++]}};feedbro.Strings.prototype.getDateTag=function(b){var c=new Date();var a=c.getTime();var e=new Date(b);var k=a-b;var l,g,h,j,i="dd.mm.";var d=24*60*60*1000;c.setMilliseconds(0);if(k<0){l=Locale.i18n("datetag_future_tag",true);i="dd.mm"}else{if(k<d&&e.getDate()==c.getDate()){l=Locale.i18n("datetag_today_tag",true);i="HH:MM"}else{if(k<(2*d)){c.setDate(c.getDate()-1);if(e.getDate()==c.getDate()){l=Locale.i18n("datetag_yesterday_tag",true);i="HH:MM"}}}}if(!l){c.setTime(a);var f=c.getDay();if(f===0){f=7}f--;c.setDate(c.getDate()-f);c.setHours(0);c.setMinutes(0);c.setSeconds(0);j=e.getTime()-c.getTime();if(j>0&&j<(7*d)){l=Locale.i18n("datetag_thisweek_tag",true);i="dd.mm."}else{c.setDate(c.getDate()-7);j=e.getTime()-c.getTime();if(j>0&&j<(7*d)){l=Locale.i18n("datetag_lastweek_tag",true)}}}if(!l){c.setTime(a);if(k<(31*d)&&c.getMonth()==e.getMonth()&&c.getFullYear()==e.getFullYear()){l=Locale.i18n("datetag_thismonth_tag",true)}else{c.setMonth(c.getMonth()-1);j=e.getTime()-c.getTime();if(c.getFullYear()==e.getFullYear()&&c.getMonth()==e.getMonth()){l=Locale.i18n("datetag_lastmonth_tag",true)}}}if(!l){c.setTime(a);g=e.getMonth();h=["January","February","March","April","May","June","July","August","September","October","November","December"];l=h[g];l=Locale.i18n("datetag_month_"+l+"_tag",true);if(e.getFullYear()!=c.getFullYear()){l+=" "+e.getFullYear()}}return{tag:l,format:i}};feedbro.Strings.prototype.isTextRTL=function(m,j,l){if(m==undefined){return false}var e,h,g=m.length;var a=0;var b=0;var k=false;var d=0;var f=0.4;if(l==undefined){l=30}if(j==undefined){j=false}for(e=0;e<g;e++){h=m.charAt(e);if(j&&k&&h==">"){k=false}else{if(j&&!k&&h=="<"){k=true}else{if(k){d++}else{if((h>="\u0591"&&h<="\u07FF")||(h>="\uFB1D"&&h<="\uFDFD")||(h>="\uFE70"&&h<="\uFEFC")||h=="\u200F"||h=="\u202B"||h=="\u202E"){a++;b++}else{b++}}}}if(b>0&&(b%l==0)&&a/b>f){return true}}return(b>0&&a/b>f)};feedbro.Strings.prototype.escapeHtmlChar=function(a){return feedbro.Strings.htmlEscapes[a]};feedbro.Strings.prototype.escapeHtml=function(b){var a=this;if(typeof b!="string"){b=String(b)}return b.replace(/[&<>"']/g,a.escapeHtmlChar)};feedbro.Strings.prototype.escapeHref=function(b){var a=this;if(typeof b!="string"){b=String(b)}return b.replace(/[<>"']/g,a.escapeHtmlChar)};feedbro.Strings.prototype.unescapeHtml=function(l,h){if(l==undefined||l.length<1){return l}if(h==undefined){h=0}if(h<0||h>l.length-1){throw new Error("unescapeHtml: firstAmp parameter out of range: "+h)}var g="";var f=l.length;var m=0;for(var e=h;e<f;e++){var k=l.charAt(e);if(k=="&"){var o=e+1;var a=l.indexOf(";",o);if(a==-1){continue}var d=l.indexOf("&",e+1);if(d!=-1&&d<a){continue}var b=l.substring(o,a);var n=-1;var p=b.length;if(p>0){if(b.charAt(0)=="#"){if(p>1){var q=b.charAt(1);try{if(q=="X"||q=="x"){n=parseInt(b.substring(2),16)}else{n=parseInt(b.substring(1),10)}if(n>65535){n=-1}}catch(j){n=-1}if(isNaN(n)){n=-1}}}else{n=feedbro.Strings.HTML[b];if(n==undefined){n=-1}}}if(n!=-1){g+=l.substring(m,e);g+=String.fromCharCode(n);m=a+1}e=a}}if(m<f){g+=l.substring(m,f)}return g};feedbro.Strings.prototype.isInt=function(a){return(/^[-+]?\d+$/).test(String(a))};feedbro.Strings.prototype.toDate=function(a){var b=new Date();b.setTime(a);return b};feedbro.Strings.prototype.sortIgnoreCase=function(a){a.sort(function(d,c){if(d==undefined||c==undefined){return 0}d=String(d).toLowerCase();c=String(c).toLowerCase();if(d==c){return 0}return d>c?1:-1})};feedbro.Strings.prototype.truncate=function(c,b,d){var a=c.length;if(a<=b){return c}else{if(d==undefined){return c.substring(0,b)}else{return c.substring(0,b)+d}}};feedbro.Strings.prototype.fixTitle=function(k){if(k.content==undefined){return}try{if(k.title==undefined||(k.title.length<1||k.title.trim().length<1)){var d=k.content;var h=0;var e="";var a=false;var g;for(var b=0;b<d.length;b++){g=d.charAt(b);if(g=="<"){e+=d.substring(h,b)+" ";if(a&&e.trim().length>5){break}}if(g==">"){h=b+1}if(g=="?"||g=="!"||g=="."){a=true}}var l,j=0;if(e==""){l=k.content}else{l=e}for(;j<l.length;j++){g=l.charAt(j);if(j>5&&(g=="."||g=="!"||g=="?")){if(g=="!"||g=="?"){j++}break}}l=l.substring(0,j).trim();if(l==""||l.indexOf("http")==0){l="No title"}k.title=this.truncate(l,100,"...")}}catch(f){}};feedbro.Strings.htmlTextIgnore={script:true,svg:true,audio:true,video:true,head:true,iframe:true,figure:true,param:true,style:true,embed:true,object:true,canvas:true,applet:true,form:true,header:true,frameset:true,noscript:true,noframes:true,select:true,aside:true,h1:true,h2:true,h3:true,h4:true,h5:true,h6:true,ul:true,ol:true,dl:true};feedbro.Strings.htmlTextNewline={p:true,div:true,blockquote:true};feedbro.Strings.prototype.htmlText=function(p,d,r){var m=0,o,q,b=-1,g=false,s,n,l,k,f,e=false;if(p==undefined){return undefined}var h=[];var a=0;if(d==undefined){d=10000}o=p.length;for(m=0;m<o;m++){q=p.charAt(m);if(q=="<"&&!g){if(b!=m&&b>=0){f=p.substring(b,m);h.push(f);e=false;a+=f.length;if(a>=d){break}}g=true;n=m;continue}if((q==" "||q==">")&&g){s=p.substring(n+1,m).toLowerCase();g=false;if(feedbro.Strings.htmlTextIgnore[s]){l=this.getHtmlBlockEndPosition(p,n);if(l!=-1&&l>m){m=l-1}}else{if(feedbro.Strings.htmlTextNewline[s]&&!e){h.push(" ");e=true}if(q==" "){k=p.indexOf(">",m);if(k!=-1){m=k}else{g=true;break}}}b=m+1;continue}if(m==0){b=0}}if(h.length==0&&b==0){if(p.length<d){return p}if(r){return p.substring(0,d)+r}else{return p.substring(0,d)}}if(!g&&b<o&&a<d){h.push(p.substring(b,o))}f=h.join("");if(f.length>d){f=f.substring(0,d)}if(r){f=f+r}return f};feedbro.Strings.prototype.removeDuplicates=function(e){if(e==undefined){return e}var a={};var d=[];for(var c=0;c<e.length;c++){var b=e[c];if(a[b]){continue}a[b]=1;d.push(b)}return d};feedbro.Strings.prototype.getQueryParams=function(a){a=a.split("+").join(" ");var d={},c,b=/[?&]?([^=]+)=([^&]*)/g;c=b.exec(a);while(c){d[decodeURIComponent(c[1])]=decodeURIComponent(c[2]);c=b.exec(a)}return d};feedbro.Strings.prototype.findImages=function(o,g,b,m){var n=/ (width|height|src)=["']([^"']+)["']/gi;var e={spos:0,stag:["<img"],etag:">"};var p,f,h,k,l,a,j=[],d;if(b==undefined){b=300}if(m==undefined){m=1920}while(true){this.findNext(o,e);if(e.match==undefined){break}n.lastIndex=0;p=e.match.match(n);if(p){l={s:undefined,w:undefined,h:undefined,size:0};for(f=0;f<p.length;f++){h=p[f];k=h.charAt(1);l[k]=h.substring(h.indexOf("=")+2,h.length-1)}l.size=(l.w||1)*(l.h||1);if(g==3){return[l]}if((l.w>=b&&l.w<=m)){if(d==undefined||l.w>d.w){d=l}}j.push(l);if(j.length>30){break}}}if(g==6&&d){return[d]}if(g==1||g==4){j.sort(function(i,c){return c.size-i.size})}if(g==2||g==5){j.sort(function(i,c){return i.size-c.size})}if(g==4||g==5){return[j[0]]}return j};feedbro.Strings.prototype.stripQuotesAll=function(a){if(a==undefined){return a}while(true){a=this.stripQuotes(a);if(a.length==0||(a.charAt(0)!='"'&&a.charAt(0)!="'"&&a.charAt(a.length-1)!='"'&&a.charAt(a.length-1)!="'")){break}}return a};feedbro.Strings.prototype.stripQuotes=function(e){if(e==undefined||e.length<1){return e}var d=0,c=e.length;if((e.charAt(d)=='"'||e.charAt(d)=="'")){d=d+1}if(e.charAt(c-1)=='"'||e.charAt(c-1)=="'"){c=c-1}if(d==0&&c==e.length-1){return e}else{return e.substring(d,c)}};feedbro.Strings.prototype.findNext=function(d,a){var e=a.spos;if(e==undefined){e=0}if(d==undefined||a.stag==undefined||a.etag==undefined){throw new Error("Invalid probe parameters")}for(var b=0;b<a.stag.length;b++){e=d.indexOf(a.stag[b],e);if(e<0){a.match=undefined;a.epos=-1;return a}e+=a.stag[b].length}var c=d.indexOf(a.etag,e);if(c<0){a.match=undefined;a.epos=-1;return a}a.epos=c;a.spos=e;a.match="";if(a.prefix!=undefined){a.match=a.prefix}a.match+=d.substring(e,c);if(a.postfix!=undefined){a.match+=a.postfix}return a};feedbro.Strings.prototype.replaceTokens=function(j,a,c,b){if(j==undefined||j==""){return j}var h;if(b!=undefined){h=feedbro.Strings.wordCache["_RT."+b]}if(h==undefined){var g=Object.keys(a);h="";for(var d=0;d<g.length;d++){var f=g[d];h+=f.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");if(d+1<g.length){h+="|"}}if(b!=undefined){feedbro.Strings.wordCache["_RT."+b]=h}}var e=this.getRegexp(h,c?"gi":"g");return j.replace(e,function(k){var i=k;var l=a[c?i.toLowerCase():i];if(l){return l}else{return i}})};feedbro.Strings.prototype.stripTags=function(a){return a!=undefined?a.replace(/<[^>]+>/ig,""):""};feedbro.Strings.stripStyleAttributes=function(a){return a!=undefined?a.replace(/(<[^\/]*?)( style="[^"]+"| style='[^']+')([^>]*>)/gi,"$1$3"):""};feedbro.Strings.prototype.inArray=function(d,a,c){if(a==undefined||d==undefined){return false}for(var b=0;b<a.length;b++){if(this.equals(a[b],d,c)){return true}}return false};feedbro.Strings.prototype.highlightItemContent=function(e,g,d){var c=this.getCachedRegExp(g,false,"gi");if(e.content){var a,h=0,b=0,f=[];while((a=c.exec(e.content,h))){h=a.index+(a[0].length||1);if(!this.isInsideTagFast(e.content,a.index)){f.push(e.content.substring(b,a.index));f.push('<span class="'+d+'">'+a[0]+"</span>");b=h}}if(b!=0&&b!=e.content.length){f.push(e.content.substring(b,e.content.length))}if(b!=0){e.content=f.join("")}}};feedbro.Strings.prototype.isInsideTagFast=function(d,a){var b=a;for(;b>=0;b--){var e=d.charAt(b);if(e=="<"){return true}else{if(e==">"){return false}}}return false};feedbro.Strings.prototype.endsWith=function(c,b,a){if(c==undefined||b==undefined){return false}if(b.length>c.length){return false}if(b==""){return true}if(a==true){return c.substring(c.length-b.length).toLowerCase()==b.toLowerCase()}else{return c.indexOf(b,c.length-b.length)!==-1}};feedbro.Strings.prototype.startsWith=function(e,d,c){if(e==undefined||d==undefined){return false}if(d.length>e.length){return false}if(d==""){return true}if(c==true){return e.substring(0,d.length).toLowerCase()==d.toLowerCase()}else{var a=e.length;for(var b=0;b<d.length&&b<a;b++){if(e.charAt(b)!=d.charAt(b)){return false}}return true}};feedbro.Strings.prototype.getExtensionBaseUrl=function(){var a=new URL(document.location.href);return a.protocol+"//"+a.host};feedbro.Strings.prototype.beginsWith=function(e,d){if(e==undefined||d==undefined){return false}var b,c=d.length,a=e.length;if(c>a){return false}for(b=c-1;b>=0;b--){if(e.charAt(b)!=d.charAt(b)){return false}}return true};feedbro.Strings.prototype.switchTags=function(b,e,a){if(b==undefined||e==undefined){return undefined}if(a!=undefined&&a.indexOf("-")==-1){throw new Error("Invalid prefix: "+a+". It must contain a hyphen")}var d=Object.keys(e);var c=d.join("|");return b.replace(new RegExp("(<|</)("+c+")","gi"),function(f,h,g){if(a){return h+a+g}else{return h+e[g]}})};feedbro.Strings.prototype.reverseMap=function(f){var d=Object.keys(f);var e={};var b,c=d.length,g,a;for(b=0;b<c;b++){a=d[b];g=f[a];e[g]=a}return e};feedbro.Strings.prototype.containsWords=function(h,g,e){if(h==undefined||g==undefined){return false}if(g==""||g.length==0){return false}var f=this.getWordsRegexp(g,e);var d=f.regexp;var b;var a={};var c=0;while(true){b=d.exec(h);if(b==undefined||b.index<0){break}a[e?b[1].toLowerCase():b[1]]=1;d.lastIndex--;c++;if(c>1000){break}if(this.hashSize(a)==f.count){return true}}return this.hashSize(a)==f.count};feedbro.Strings.prototype.hashSize=function(b){var c,d=0;for(c in b){if(b.hasOwnProperty(c)){d++}}return d};feedbro.Strings.prototype.containsAnyWord=function(e,d,b){if(e==undefined||d==undefined){return false}if(d==""||d.length==0){return false}var c=this.getWordsRegexp(d,b);var a=c.regexp.exec(e);return(a!=undefined&&a.index>=0)};feedbro.Strings.prototype.doesNotContainWords=function(e,d,b){if(e==undefined||d==undefined){return true}if(d==""||d.length==0){return false}var c=this.getWordsRegexp(d,b);var a=c.regexp.exec(e);return(a==undefined||a.index<0)};feedbro.Strings.prototype.decodeHtmlEntities=function(a){if(a==undefined||a.length==0){return a}return a.replace(feedbro.Strings.REGEXDECODE,function(c,b,i,h,g,f,e){var d;if(b){d=b}else{if(h){d=parseInt(h,16)}else{if(f){d=feedbro.Strings.HTML[f];if(d!=undefined){d=parseInt(d,10)}}}}if(d!=undefined&&!isNaN(d)&&d>20){return String.fromCharCode(d)}else{return c}})};feedbro.Strings.prototype.getWordsRegexp=function(h,d){var k=h+"-"+d;var l=feedbro.Strings.wordCache[k];if(l==undefined){var c="(?:^|\\s|\\.|,)";var g="(?:\\s|\\.|\\,|\\!|\\?|\\(|\\)|\\'|\\\"|\\t|>|:|;|^)";var b="(?:\\s|\\.|\\,|\\!|\\?|\\(|\\)|\\'|\\\"|\\t|<|:|;|$)";var i=h.split(",");var f="";var a={};f+=g+"(";for(var e=0;e<i.length;e++){a[i[e]]=1;f+=i[e].replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");if(e+1<i.length){f+="|"}}f+=")"+b;l={regexp:new RegExp(f,d?"gi":"g"),count:this.hashSize(a)};feedbro.Strings.wordCache[k]=l}l.regexp.lastIndex=0;return l};feedbro.Strings.prototype.equals=function(c,b,a){if(c==undefined||b==undefined){return false}if(a==true){return(c.length==b.length&&c.toLowerCase()==b.toLowerCase())}else{return(c.length==b.length&&c==b)}};feedbro.Strings.prototype.splitTrim=function(d,c){if(d==undefined||c==undefined){return[d]}var a=d.split(c);for(var b=0;b<a.length;b++){a[b]=a[b].trim()}return a};feedbro.Strings.prototype.indexOf=function(c,d,b,a){if(c==undefined||d==undefined){return -1}if(d==""){return 0}if(d.length>c.length){return -1}if(a==true){return this.indexOfIgnoreCase(c,d,b,true)}else{return c.indexOf(d,b)}};feedbro.Strings.prototype.indexOfIgnoreCase=function(d,e,c){if(d==undefined||e==undefined){return -1}if(e==""){return 0}if(e.length>d.length){return -1}var b=this.getCachedRegExp(e,true);if(c!=undefined){b.lastIndex=c}var a=b.exec(d);return a?a.index:-1};feedbro.Strings.prototype.getProtocol=function(a){if(!a){return"http"}var b=a.indexOf(":");return b>0?a.substring(0,b):"http"};feedbro.Strings.prototype.parseDate=function(b){if(typeof b=="string"&&b.charAt(14)==" "&&b.charAt(11)==" "){b=b.substring(0,12)+"20"+b.substring(12)}var e=new Date(b);if(!isNaN(e)){return e}var c=b.split(" ");if(c[c.length-1].charAt(0)=="("){c.pop()}var a=c[c.length-1];if(feedbro.Strings.TIMEZONES[a]){c[c.length-1]=feedbro.Strings.TIMEZONES[a]}b=c.join(" ");return new Date(b)};feedbro.Strings.prototype.validateRegexp=function(b){try{this.getRegexp(b);return true}catch(a){return a.message}};feedbro.Strings.prototype.getRegexp=function(b,a){return this.getCachedRegExp(b,false,a?a:"g")};feedbro.Strings.prototype.getCachedRegExp=function(d,c,a){var b=feedbro.Strings.regexpCache[d+"-"+c+"-"+a];if(b==undefined){b=new RegExp(c?d.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"):d,a?a:"gi");feedbro.Strings.regexpCache[d]=b}else{b.lastIndex=0}return b};feedbro.Strings.prototype.stripHtmlBlock=function(e,f,g){var d=e.indexOf(f,g?g:0);if(d!=-1){var c=this.getHtmlBlockEndPosition(e,d);return e.substring(0,d)+e.substring(c)}else{return e}};feedbro.Strings.prototype.getHtmlBlockString=function(e,f,g){var d=e.indexOf(f,g?g:0);if(d!=-1){var c=this.getHtmlBlockEndPosition(e,d);return c!=-1?e.substring(d,c):""}else{return""}};feedbro.Strings.prototype.getHtmlBlockEndPosition=function(l,j){var d=j,f=l.length,g,b=false,e,m,h={},a,k;while(d<f){g=l.charAt(d);if(!b&&g=="<"){b=true;d++;e=d;continue}else{if(b&&(g==" "||g==">")){b=false;m=l.substring(e,d);if(k==undefined){k=m}if(m.charAt(0)=="/"){a=true;m=m.substring(1)}else{a=false}if(h[m]==undefined){h[m]=0}if(a){h[m]--}else{h[m]++}if(m==k&&h[m]==0){return d+1}}else{d++}}}return -1};feedbro.Strings.htmlEscapes={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};feedbro.Strings.timeunits=[{name:"second",shortName:"s",limit:60,in_seconds:1},{name:"minute",shortName:"min",limit:3600,in_seconds:60},{name:"hour",shortName:"h",limit:86400,in_seconds:3600},{name:"day",shortName:"d",limit:604800,in_seconds:86400},{name:"week",shortName:"w",limit:2629743,in_seconds:604800},{name:"month",shortName:"mo",limit:31556926,in_seconds:2629743},{name:"year",shortName:"y",limit:null,in_seconds:31556926}];feedbro.Strings.TIMEZONES={A:"GMT+0100",ACDT:"GMT+1030",ACST:"GMT+0930",ACT:"GMT+1030",ACWST:"GMT+0845",ADT:"GMT-0300",AEDT:"GMT+1100",AEST:"GMT+1000",AET:"GMT+1100",AFT:"GMT+0430",AKDT:"GMT-0800",AKST:"GMT-0900",ALMT:"GMT+0600",AMST:"GMT+0500",AMT:"GMT+0400",ANAST:"GMT+1200",ANAT:"GMT+1200",AQTT:"GMT+0500",ART:"GMT-0300",AST:"GMT-0400",AT:"GMT-0400",AWDT:"GMT+0900",AWST:"GMT+0800",AZOST:"GMT+0000",AZOT:"GMT-0100",AZST:"GMT+0500",AZT:"GMT+0400",AoE:"GMT-1200",B:"GMT+0200",BNT:"GMT+0800",BOT:"GMT-0400",BRST:"GMT-0200",BRT:"GMT-0300",BST:"GMT+0100",BTT:"GMT+0600",C:"GMT+0300",CAST:"GMT+0800",CAT:"GMT+0200",CCT:"GMT+0630",CDT:"GMT-0400",CEST:"GMT+0200",CET:"GMT+0100",CHADT:"GMT+1345",CHAST:"GMT+1245",CHOT:"GMT+0800",CHUT:"GMT+1000",CKT:"GMT-1000",CLST:"GMT-0300",CLT:"GMT-0300",COT:"GMT-0500",CST:"GMT-0500",CT:"GMT-0600",CVT:"GMT-0100",CXT:"GMT+0700",ChST:"GMT+1000",D:"GMT+0400",DAVT:"GMT+0700",DDUT:"GMT+1000",E:"GMT+0500",EASST:"GMT-0500",EAST:"GMT-0500",EAT:"GMT+0300",ECT:"GMT-0500",EDT:"GMT-0400",EEST:"GMT+0300",EET:"GMT+0200",EGST:"GMT+0000",EGT:"GMT-0100",EST:"GMT-0500",ET:"GMT-0500",F:"GMT+0600",FET:"GMT+0300",FJST:"GMT+1300",FJT:"GMT+1200",FKST:"GMT-0300",FKT:"GMT-0400",FNT:"GMT-0200",G:"GMT+0700",GALT:"GMT-0600",GAMT:"GMT-0900",GET:"GMT+0400",GFT:"GMT-0300",GILT:"GMT+1200",GMT:"GMT+0000",GST:"GMT-0200",GYT:"GMT-0400",H:"GMT+0800",HADT:"GMT-0900",HAST:"GMT-1000",HKT:"GMT+0800",HOVT:"GMT+0700",I:"GMT+0900",ICT:"GMT+0700",IDT:"GMT+0300",IOT:"GMT+0600",IRDT:"GMT+0430",IRKST:"GMT+0900",IRKT:"GMT+0800",IRST:"GMT+0330",IST:"GMT+0200",JST:"GMT+0900",K:"GMT+1000",KGT:"GMT+0600",KOST:"GMT+1100",KRAST:"GMT+0800",KRAT:"GMT+0700",KST:"GMT+0900",KUYT:"GMT+0400",L:"GMT+1100",LHDT:"GMT+1100",LHST:"GMT+1030",LINT:"GMT+1400",M:"GMT+1200",MAGST:"GMT+1200",MAGT:"GMT+1000",MART:"GMT-0930",MAWT:"GMT+0500",MDT:"GMT-0600",MHT:"GMT+1200",MMT:"GMT+0630",MSD:"GMT+0400",MSK:"GMT+0300",MST:"GMT-0700",MT:"GMT-0700",MUT:"GMT+0400",MVT:"GMT+0500",MYT:"GMT+0800",N:"GMT-0100",NCT:"GMT+1100",NDT:"GMT-0230",NFT:"GMT+1130",NOVST:"GMT+0700",NOVT:"GMT+0600",NPT:"GMT+0545",NRT:"GMT+1200",NST:"GMT-0330",NUT:"GMT-1100",NZDT:"GMT+1300",NZST:"GMT+1200",O:"GMT-0200",OMSST:"GMT+0700",OMST:"GMT+0600",ORAT:"GMT+0500",P:"GMT-0300",PDT:"GMT-0700",PET:"GMT-0500",PETST:"GMT+1200",PETT:"GMT+1200",PGT:"GMT+1000",PHOT:"GMT+1300",PHT:"GMT+0800",PKT:"GMT+0500",PMDT:"GMT-0200",PMST:"GMT-0300",PONT:"GMT+1100",PST:"GMT-0800",PT:"GMT-0800",PWT:"GMT+0900",PYST:"GMT-0300",PYT:"GMT-0400",Q:"GMT-0400",QYZT:"GMT+0600",R:"GMT-0500",RET:"GMT+0400",ROTT:"GMT-0300",S:"GMT-0600",SAKT:"GMT+1000",SAMT:"GMT+0400",SAST:"GMT+0200",SBT:"GMT+1100",SCT:"GMT+0400",SGT:"GMT+0800",SRET:"GMT+1100",SRT:"GMT-0300",SST:"GMT-1100",SYOT:"GMT+0300",T:"GMT-0700",TAHT:"GMT-1000",TFT:"GMT+0500",TJT:"GMT+0500",TKT:"GMT+1300",TLT:"GMT+0900",TMT:"GMT+0500",TOT:"GMT+1300",TVT:"GMT+1200",U:"GMT-0800",ULAT:"GMT+0800",UTC:"GMT+0000",UYST:"GMT-0200",UYT:"GMT-0300",UZT:"GMT+0500",V:"GMT-0900",VET:"GMT-0430",VLAST:"GMT+1100",VLAT:"GMT+1000",VOST:"GMT+0600",VUT:"GMT+1100",W:"GMT-1000",WAKT:"GMT+1200",WARST:"GMT-0300",WAST:"GMT+0200",WAT:"GMT+0100",WEST:"GMT+0100",WET:"GMT+0000",WFT:"GMT+1200",WGST:"GMT-0200",WGT:"GMT-0300",WIB:"GMT+0700",WIT:"GMT+0900",WITA:"GMT+0800",WST:"GMT+0100",WT:"GMT+0000",X:"GMT-1100",Y:"GMT-1200",YAKST:"GMT+1000",YAKT:"GMT+0900",YAPT:"GMT+1000",YEKST:"GMT+0600",YEKT:"GMT+0500",Z:"GMT+0000"};feedbro.Strings.REGEXDECODE=/&#([0-9]+)(;?)|&#[xX]([a-fA-F0-9]+)(;?)|&(Aacute|iacute|Uacute|otilde|Otilde|Agrave|agrave|yacute|Yacute|oslash|Oslash|Atilde|atilde|Ccedil|ccedil|ograve|curren|divide|Eacute|eacute|Ograve|oacute|Egrave|egrave|ugrave|Ugrave|Oacute|Iacute|ntilde|Ntilde|uacute|middot|Igrave|igrave|iquest|aacute|THORN|micro|iexcl|icirc|Icirc|Acirc|ucirc|ecirc|Ocirc|ocirc|Ecirc|Ucirc|aring|Aring|aelig|AElig|acute|pound|acirc|thorn|szlig|cedil|Auml|ordf|ordm|uuml|macr|Uuml|auml|Ouml|ouml|para|nbsp|Euml|quot|QUOT|euml|yuml|cent|sect|Iuml|iuml|shy|eth|not|yen|ETH)(;?)/g;feedbro.Strings.HTML={quot:"34",amp:"38",lt:"60",gt:"62",apos:"39",nbsp:"160",iexcl:"161",cent:"162",pound:"163",curren:"164",yen:"165",brvbar:"166",sect:"167",uml:"168",copy:"169",ordf:"170",laquo:"171",not:"172",shy:"173",reg:"174",macr:"175",deg:"176",plusmn:"177",sup2:"178",sup3:"179",acute:"180",micro:"181",para:"182",middot:"183",cedil:"184",sup1:"185",ordm:"186",raquo:"187",frac14:"188",frac12:"189",frac34:"190",iquest:"191",Agrave:"192",Aacute:"193",Acirc:"194",Atilde:"195",Auml:"196",Aring:"197",AElig:"198",Ccedil:"199",Egrave:"200",Eacute:"201",Ecirc:"202",Euml:"203",Igrave:"204",Iacute:"205",Icirc:"206",Iuml:"207",ETH:"208",Ntilde:"209",Ograve:"210",Oacute:"211",Ocirc:"212",Otilde:"213",Ouml:"214",times:"215",Oslash:"216",Ugrave:"217",Uacute:"218",Ucirc:"219",Uuml:"220",Yacute:"221",THORN:"222",szlig:"223",agrave:"224",aacute:"225",acirc:"226",atilde:"227",auml:"228",aring:"229",aelig:"230",ccedil:"231",egrave:"232",eacute:"233",ecirc:"234",euml:"235",igrave:"236",iacute:"237",icirc:"238",iuml:"239",eth:"240",ntilde:"241",ograve:"242",oacute:"243",ocirc:"244",otilde:"245",ouml:"246",divide:"247",oslash:"248",ugrave:"249",uacute:"250",ucirc:"251",uuml:"252",yacute:"253",thorn:"254",yuml:"255",fnof:"402",Alpha:"913",Beta:"914",Gamma:"915",Delta:"916",Epsilon:"917",Zeta:"918",Eta:"919",Theta:"920",Iota:"921",Kappa:"922",Lambda:"923",Mu:"924",Nu:"925",Xi:"926",Omicron:"927",Pi:"928",Rho:"929",Sigma:"931",Tau:"932",Upsilon:"933",Phi:"934",Chi:"935",Psi:"936",Omega:"937",alpha:"945",beta:"946",gamma:"947",delta:"948",epsilon:"949",zeta:"950",eta:"951",theta:"952",iota:"953",kappa:"954",lambda:"955",mu:"956",nu:"957",xi:"958",omicron:"959",pi:"960",rho:"961",sigmaf:"962",sigma:"963",tau:"964",upsilon:"965",phi:"966",chi:"967",psi:"968",omega:"969",thetasym:"977",upsih:"978",piv:"982",bull:"8226",hellip:"8230",prime:"8242",Prime:"8243",oline:"8254",frasl:"8260",weierp:"8472",image:"8465",real:"8476",trade:"8482",alefsym:"8501",larr:"8592",uarr:"8593",rarr:"8594",darr:"8595",harr:"8596",crarr:"8629",lArr:"8656",uArr:"8657",rArr:"8658",dArr:"8659",hArr:"8660",forall:"8704",part:"8706",exist:"8707",empty:"8709",nabla:"8711",isin:"8712",notin:"8713",ni:"8715",prod:"8719",sum:"8721",minus:"8722",lowast:"8727",radic:"8730",prop:"8733",infin:"8734",ang:"8736",and:"8743",or:"8744",cap:"8745",cup:"8746","int":"8747",there4:"8756",sim:"8764",cong:"8773",asymp:"8776",ne:"8800",equiv:"8801",le:"8804",ge:"8805",sub:"8834",sup:"8835",sube:"8838",supe:"8839",oplus:"8853",otimes:"8855",perp:"8869",sdot:"8901",lceil:"8968",rceil:"8969",lfloor:"8970",rfloor:"8971",lang:"9001",rang:"9002",loz:"9674",spades:"9824",clubs:"9827",hearts:"9829",diams:"9830",OElig:"338",oelig:"339",Scaron:"352",scaron:"353",Yuml:"376",circ:"710",tilde:"732",ensp:"8194",emsp:"8195",thinsp:"8201",zwnj:"8204",zwj:"8205",lrm:"8206",rlm:"8207",ndash:"8211",mdash:"8212",lsquo:"8216",rsquo:"8217",sbquo:"8218",ldquo:"8220",rdquo:"8221",bdquo:"8222",dagger:"8224",Dagger:"8225",permil:"8240",lsaquo:"8249",rsaquo:"8250",euro:"8364"};var feedbro=feedbro||{};feedbro.TagFilter=function(){var a={"<object":'<span style="display: none" ',"object>":"span>","<script":'<span style="display: none" ',"script>":"span>","<applet":'<span style="display: none" ',"applet>":"span>","<style":'<span style="display: none" ',"style>":"span>","<link":'<span style="display: none" ',"link>":"span>"};this.addTagFilter=function(b){a["<"+b]='<span style="display: none" ';a[b+">"]="span>"};this.filter=function(b){return b.replace(/(<object|object>|<script|script>|<applet|applet>|<iframe|iframe>|<embed|embed>|<link|link>|<style|style>)/gi,function(c){var d=a[c.toLowerCase()];if(d){return d}else{return c}})}};var feedbro=feedbro||{};feedbro.TagSelect=function(){var k;var j=new feedbro.Strings();this.configure=function(o){k=o};this.createSelector=function(p,o){g(p,o)};this.destroy=function(){k=undefined};function g(p,o){p.attr("data-mode","view");p.append("<img src='../images/tagicon.png' class='tagicon'><div class='taglist'></div><div class='taginput hidden'><input type='text' class='taginputfield' spellcheck='false'><div class='tagadd'>+</div></div><div class='autocomplete hidden'></div>");p.click(e);m(p,o)}function e(o){switch(o.target.className){case"tagicon":a(o);break;case"removetag":i(o);break;case"tagadd":b(o);break;case"tagname":f(o);break;case"autocomplete-option":n(o);break;default:break}o.stopPropagation()}function d(p){if(p.keyCode==13){p.target.parentElement.querySelector(".tagadd").click()}else{if(p.keyCode==38||p.keyCode==40){var s=p.target.parentElement.parentElement.querySelector(".autocomplete");var t=s.querySelector(".autocomplete-option.active");var r;if(t==undefined){if(p.keyCode==38){r=s.lastChild}else{if(p.keyCode==40){r=s.firstChild}}}else{t.classList.remove("active");if(p.keyCode==38){r=t.previousSibling;if(r==undefined){r=s.lastChild}}else{if(p.keyCode==40){r=t.nextSibling;if(r==undefined){r=s.firstChild}}}}r.classList.add("active");r.scrollIntoView();p.target.parentElement.parentElement.querySelector("input").value=r.innerText;p.preventDefault()}else{var u=p.target.value;var o=$(p.target.parentElement.parentElement);if(u.length>=3){var q=k.autocomplete(u);if(q){l(q,o)}}else{l(undefined,o)}}}}function l(q,o){var t=o.find(".autocomplete");t.empty();if(q&&q.length>0){q.sort();var p=o.find("input");var u=p.position();var s,r="";for(s=0;s<q.length;s++){r+="<div class='autocomplete-option'>"+j.escapeHtml(q[s])+"</div>"}t.html(r);t.css({top:u.top+22,left:u.left});t.removeClass("hidden")}else{t.addClass("hidden")}}function n(p){var r=p.target.innerText;var o=p.target.parentElement.parentElement;var q=p.target.parentElement;q.classList.add("hidden");o.querySelector("input").value=r;o.querySelector(".tagadd").click()}function b(p){var q=(p.target.parentElement).querySelector("input");var u=q.value;if(u.trim()==""){return}var o=$(p.target.parentElement.parentElement);var t=o.find(".taglist");var r,s=t.find(".tagname");for(r=0;r<s.length;r++){if(s[r].innerText==u){q.value="";return}}t.append("<div class='tag'><span class='tagname'>"+j.escapeHtml(u)+"</span><span class='removetag'>x</span></div>");c(p);q.value="";k.add(o.attr("data-id"),u)}function i(p){var q=p.target.parentElement;var r=q.querySelector(".tagname").innerText;var o=$(q.parentElement.parentElement);q.remove();h(o,o.find(".taglist"));k.remove(o.attr("data-id"),r)}function m(r,o){var q,s,p="";if(o&&o.length>0){s=r.find(".taglist");s.empty();for(q=0;q<o.length;q++){p+="<div class='tag'><span class='tagname'>"+j.escapeHtml(o[q])+"</span><span class='removetag'>x</span></div>"}}if(p!=""){s.html(p)}}function f(o){k.search(o.target.innerText)}function c(p){var o=$(p.currentTarget);o.find(".taglist").removeClass("vertical");o.find(".taginput").addClass("hidden");o.find(".autocomplete").addClass("hidden");o.attr("data-mode","view")}function a(p){var r=$(p.target);var o=r.parent();if(o.attr("data-mode")=="view"){var s=o.find(".taglist");var q=o.find(".taginput input");h(o,s);o.find(".taginput").removeClass("hidden");q.focus();o.attr("data-mode","edit");if(q.attr("data-handler")!="true"){q.keyup(d);q.attr("data-handler","true");o.on("mouseleave",c)}}else{c(p)}}function h(o,p){var q=o.position();p.addClass("vertical");p.css({top:q.top-p.outerHeight(),left:q.left})}};var feedbro=feedbro||{};feedbro.TePlugin=function(){};feedbro.TePlugin.prototype.canParse=function(a){return a&&a.indexOf("https://t.me/s/")==0};feedbro.TePlugin.prototype.parse=function(e,c,a,f){var b=this;var d=new XMLHttpRequest();d.onerror=function(){a.error={};a.error.message="Network error";a.error.code=398;a.status=398};d.onreadystatechange=function(h){var g=h.target;if(g.readyState==4){g.onreadystatechange=null;if(g.status!=0){g.onerror=null}if(g.status==200){var i="";try{i=b.toRSS(g.responseText,e.url)}catch(j){feedbro.log("Failed to parse: "+e.url)}if(c){c(e.url,g,i,a,f,true)}}else{c(e.url,g,"",a,f,true)}}};d.open("GET",e.url,true);d.timeout=20000;d.setRequestHeader("Cache-Control","no-cache");d.send()};feedbro.TePlugin.prototype.toRSS=function(k,h){var c=new DOMParser();var j=new feedbro.Strings();var u={audio:"x-audio",video:"x-video",source:"x-source",svg:"x-svg",style:"x-style",canvas:"x-canvas",script:"x-script"};k=j.switchTags(k,u);var w=c.parseFromString(k,"text/html");var q,r,t=w.querySelectorAll(".tgme_widget_message_wrap");var s,l=[];var g,p,m,f,o,b,v,d,a;var n=w.querySelector("title").innerText;for(q=0;q<t.length;q++){r=t[q];d=undefined;a=undefined;g=r.querySelector(".tgme_widget_message_owner_name > span");p=r.querySelector(".tgme_widget_message_text");v=r.querySelector(".tgme_widget_message_photo_wrap");m=r.querySelector(".tgme_widget_message_date > time");f=r.querySelector(".tgme_widget_message_date");o=r.querySelector(".tgme_widget_message_video_wrap");b=r.querySelector(".tgme_widget_message_video_thumb");if(v){d=this.getUrl(v)}if(b){a=this.getUrl(b)}if(p){p="<div class='telegram-post'>"+p.innerHTML+"</div>"}if(d){p="<div class='telegram-image'><img src='"+d+"'></div>"+(p||"")}if(o){o=o.querySelector("x-video");if(o&&a){p="<div class='telegram-video'><div class='youtubevideo' data-link='"+o.getAttribute("src")+"'><img src='"+a+"' class='thumb'><div class='play'></div></div></div>"+(p||"")}}p="<div class='telegram'>"+p+"</div>";if(m&&f){s={author:g?g.innerText:"",content:p,publishedDate:new Date(m.getAttribute("datetime")),link:f.getAttribute("href")};l.push(s)}}w=null;c=null;return feedbro.Strings.toRSS(n,h,l)};feedbro.TePlugin.prototype.getUrl=function(h){var g,d,f,c;g=h.getAttribute("style");d="background-image:url('";f=g.indexOf(d);c=g.indexOf("'",f+d.length+1);return g.substring(f+d.length,c)};var feedbro=feedbro||{};feedbro.TwPlugin=function(){this._strings=new feedbro.Strings()};feedbro.TwPlugin.authToken="AAAAAAAAAAAAAAAAAAAAANRILgAAAAAAnNwIzUejRCOuH5E6I8xnZz4puTs%3D1Zv7ttfk8LF81IUq16cHjhLTvJu4FA33AGWWjCpTnA";feedbro.TwPlugin.cachedToken=null;feedbro.TwPlugin.prototype.canParse=function(b){if(b==undefined||b==""){return false}var c=b.substring(0,20);var a=b.substring(20);return c=="https://twitter.com/"&&a!="notifications"&&a!="home"&&a.indexOf("messages")!=0&&a.indexOf("i/bookmarks")!=0};feedbro.TwPlugin.prototype.parse=function(d,c,a,e){var b=this;this.getCachedGuestToken(function(f){b.doParse(d,c,a,e)})};feedbro.TwPlugin.prototype.getCachedGuestToken=function(a){if(feedbro.TwPlugin.cachedToken==null||this.isTokenExpired(feedbro.TwPlugin.cachedToken)){this.getGuestToken(function(b){if(b&&b.token){feedbro.TwPlugin.cachedToken=b}else{feedbro.TwPlugin.cachedToken={remaining:0,init:0}}a(b)})}else{feedbro.TwPlugin.cachedToken.lastUse=new Date().getTime();a(feedbro.TwPlugin.cachedToken)}};feedbro.TwPlugin.prototype.getGuestToken=function(a){fetchTimeout("https://api.twitter.com/1.1/guest/activate.json",20000,{method:"POST",credentials:"omit",headers:{authorization:"Bearer "+feedbro.TwPlugin.authToken,"accept-language":"en-US,en;q=0.5",accept:"text/html,application/json,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8"}}).then(function(b){return b.json()}).then(function(c){var b=new Date().getTime();if(c==null){c={}}a({token:c.guest_token,remaining:187,init:b,reset:b+(15*60*1000),lastUse:b})})["catch"](a)};feedbro.TwPlugin.prototype.isTokenExpired=function(b){var d=2*60*60*1000;var c=1*60*60*1000;var a=new Date().getTime();return b==null||b.init<(a-d)||b.remaining<10||a>b.reset||b.lastUse<(a-c)};feedbro.TwPlugin.prototype.doParse=function(f,d,a,g){var b=this;try{this.getUrl(f.url,a,function(k,i,h,j){d(f.url,k,b.parseTweets(i,h,j),a,g,true)})}catch(c){var e=new feedbro.FetchWrapper(500);a.error={};a.error.message="Internal Server Error";a.error.code=500;a.status=500;d(f.url,e,"",a,g,true)}};feedbro.TwPlugin.prototype.getUserProfile=function(c,a,e){var d=c.match(/^https:\/\/twitter\.com\/(\w+)/)[1];var b="https://api.twitter.com/graphql/-xfUfZsnR_zqjFd-IfrN5A/UserByScreenName?variables=%7B%22screen_name%22%3A%22"+d+"%22%2C%22withHighlightedLabel%22%3Atrue%7D";this.loadJson(b,a,function(g,f){e(f,c)})};feedbro.TwPlugin.prototype.loadUserTweets=function(c,e,a,f){var d=0;if(e&&e.data&&e.data.user){d=e.data.user.rest_id}var b="https://api.twitter.com/2/timeline/profile/"+d+".json?include_profile_interstitial_type=1&include_blocking=1&include_blocked_by=1&include_followed_by=1&include_want_retweets=1&include_mute_edge=1&include_can_dm=1&include_can_media_tag=1&skip_status=1&cards_platform=Web-12&include_cards=1&include_ext_alt_text=true&include_reply_count=1&tweet_mode=extended&include_entities=true&include_user_entities=true&include_ext_media_color=true&include_ext_media_availability=true&send_error_codes=true&simple_quoted_tweet=true&include_tweet_replies=false&userId="+d+"&count=20&ext=mediaStats%2ChighlightedLabel%2CcameraMoment&include_quote_count=true";this.loadJson(b,a,function(h,g){if(e&&e.data&&e.data.user&&e.data.user.legacy){f(h,g,c,d!=0?(e.data.user.legacy.name+" (@"+e.data.user.legacy.screen_name+")"):"")}else{f(h,g,c,"Suspended")}})};feedbro.TwPlugin.prototype.getUserTweets=function(c,a,d){var b=this;this.getUserProfile(c,a,function(f,e){b.loadUserTweets(e,f,a,d)})};feedbro.TwPlugin.prototype.getListTweets=function(d,a,e){var b=d.match(/^https:\/\/twitter\.com\/i\/lists\/(\d+)/)[1];var c="https://api.twitter.com/2/timeline/list.json?include_profile_interstitial_type=1&include_blocking=1&include_blocked_by=1&include_followed_by=1&include_want_retweets=1&include_mute_edge=1&include_can_dm=1&include_can_media_tag=1&skip_status=1&cards_platform=Web-12&include_cards=1&include_ext_alt_text=true&include_reply_count=1&tweet_mode=extended&include_entities=true&include_user_entities=true&include_ext_media_color=true&include_ext_media_availability=true&send_error_codes=true&simple_quoted_tweet=true&list_id="+b+"&ranking_mode=reverse_chronological&count=20&ext=mediaStats%2ChighlightedLabel%2CcameraMoment&include_quote_count=true";this.loadJson(c,a,function(g,f){e(g,f,d,"List "+b)})};feedbro.TwPlugin.prototype.getHashtagTweets=function(c,a,e){var d=c.match(/^https:\/\/twitter\.com\/hashtag\/(\w+)/)[1];var b="https://api.twitter.com/2/search/adaptive.json?include_profile_interstitial_type=1&include_blocking=1&include_blocked_by=1&include_followed_by=1&include_want_retweets=1&include_mute_edge=1&include_can_dm=1&include_can_media_tag=1&skip_status=1&cards_platform=Web-12&include_cards=1&include_ext_alt_text=true&include_reply_count=1&tweet_mode=extended&include_entities=true&include_user_entities=true&include_ext_media_color=true&include_ext_media_availability=true&send_error_codes=true&simple_quoted_tweet=true&q=%23"+d+"&count=20&query_source=hashtag_click&pc=1&spelling_corrections=1&ext=mediaStats%2ChighlightedLabel%2CcameraMoment&include_quote_count=true";if(c.indexOf("&f=live")!=-1){b=b+"&tweet_search_mode=live"}this.loadJson(b,a,function(g,f){e(g,f,c,"#"+d+" - Search")})};feedbro.TwPlugin.prototype.getSearchTweets=function(c,a,e){var d=c.match(/q=([\w%]+)/)[1];var b="https://api.twitter.com/2/search/adaptive.json?include_profile_interstitial_type=1&include_blocking=1&include_blocked_by=1&include_followed_by=1&include_want_retweets=1&include_mute_edge=1&include_can_dm=1&include_can_media_tag=1&skip_status=1&cards_platform=Web-12&include_cards=1&include_ext_alt_text=true&include_reply_count=1&tweet_mode=extended&include_entities=true&include_user_entities=true&include_ext_media_color=true&include_ext_media_availability=true&send_error_codes=true&simple_quoted_tweet=true&q="+d+"&count=20&query_source=typed_query&pc=1&spelling_corrections=1&ext=mediaStats%2ChighlightedLabel%2CcameraMoment&include_quote_count=true";if(c.indexOf("&f=live")!=-1){b=b+"&tweet_search_mode=live"}this.loadJson(b,a,function(g,f){e(g,f,c,decodeURIComponent(d)+" - Search")})};feedbro.TwPlugin.prototype.getExploreTweets=function(c,a,d){var b="https://api.twitter.com/2/guide.json?include_profile_interstitial_type=1&include_blocking=1&include_blocked_by=1&include_followed_by=1&include_want_retweets=1&include_mute_edge=1&include_can_dm=1&include_can_media_tag=1&skip_status=1&cards_platform=Web-12&include_cards=1&include_ext_alt_text=true&include_reply_count=1&tweet_mode=extended&include_entities=true&include_user_entities=true&include_ext_media_color=true&include_ext_media_availability=true&send_error_codes=true&simple_quoted_tweet=true&include_page_configuration=true&count=20&ext=mediaStats%2ChighlightedLabel%2CcameraMoment&include_quote_count=true";this.loadJson(b,a,function(f,e){d(f,e,c,"Explore")})};feedbro.TwPlugin.prototype.loadJson=function(c,b,d){var a=new feedbro.FetchWrapper(500);fetchTimeout(c,20000,{method:"GET",credentials:"omit",headers:{authorization:"Bearer "+feedbro.TwPlugin.authToken,"accept-language":"en-US,en;q=0.5",accept:"*/*","x-guest-token":feedbro.TwPlugin.cachedToken?feedbro.TwPlugin.cachedToken.token:"","x-twitter-client-language":"en","x-twitter-active-user":"yes","cache-control":"no-cache"}}).then(function(e){a.status=e.status+0;if(e.status==200){if(feedbro.TwPlugin.cachedToken){feedbro.TwPlugin.cachedToken.remaining=parseInt(e.headers.get("x-rate-limit-remaining")||"0",10);feedbro.TwPlugin.cachedToken.reset=parseInt(e.headers.get("x-rate-limit-reset"),10)*1000}return e.json()}else{throw new Error(e.status+0)}}).then(function(e){d(a,e)})["catch"](function(e){if(e.name=="AbortError"){b.error={};b.error.message="Network error";b.error.code=398;b.status=398;a.status=0}d(a,null)})};feedbro.TwPlugin.prototype.getUrl=function(c,a,d){var b=c.substring(20);if(b.indexOf("i/lists/")==0){this.getListTweets(c,a,d)}else{if(b.indexOf("hashtag/")==0){this.getHashtagTweets(c,a,d)}else{if(b.indexOf("search?")==0){this.getSearchTweets(c,a,d)}else{if(b.indexOf("explore")==0){this.getExploreTweets(c,a,d)}else{if(b!="notifications"&&b.indexOf("messages")!=0&&b.indexOf("i/bookmarks")!=0){this.getUserTweets(c,a,d)}else{d(undefined)}}}}}};feedbro.TwPlugin.prototype.parseTweets=function(B,c,C){var t='<?xml version="1.0" encoding="UTF-8"?>\n<rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/">\n<channel>\n';if(B!=undefined){var j=/#(\w+)/g;var g=/@(\w+)/g;var r=/\b(?:https?|ftp):\/\/[a-z0-9-+&@#\/%?=~_|!:,.;]*[a-z0-9-+&@#\/%=~_|]/gim;var k=[];var b;var q=B.globalObjects.tweets;var n=B.globalObjects.users;var u,a,D,m=Object.keys(q);var y;var w;var p;var e;var s;var o;var f;var x;var A;var l;var h;var v;var z;m.sort(function(E,i){return new Date(q[i].created_at).getTime()-new Date(q[E].created_at).getTime()});try{for(u=0;u<m.length;u++){a=q[m[u]];x=a;if(a.source==0){continue}D=n[a.user_id_str];o=D;f=a.id_str;s=a.created_at;if(a.retweeted_status_id_str!=undefined){z=a.retweeted_status_id_str;a=q[z];D=n[a.user_id_str];q[z].source=0}A=undefined;e=undefined;if(a.is_quote_status){A=a.full_text;if(q[a.quoted_status_id_str]!=undefined){e=q[a.quoted_status_id_str];q[a.quoted_status_id_str].source=0}}y=undefined;w=undefined;v=this.getContent(a);y=v.card;w=v.media;p="<header>";if(x.retweeted_status_id_str!=undefined){p+="<div class='twitter-retweet-header'>"+o.name+" Retweeted</div>"}p+="<a target='_blank' href='https://twitter.com/"+D.screen_name+"' rel='noopener noreferrer'>";p+="<img class='twitter-authorimage' src='"+D.profile_image_url_https+"'>";p+="</a><span class='twitter-fullname'>"+D.name+"</span>";p+="</a><span>";p+="<a target='_blank' class='twitter-username' href='https://twitter.com/"+D.screen_name+"' rel='noopener noreferrer'>@"+D.screen_name+"</a></span>";p+="</header>";b={author:o.name+" (@"+o.screen_name+")",publishedDate:new Date(s),guid:o.screen_name+"-"+f,link:"https://twitter.com/"+o.screen_name+"/status/"+f,content:a.full_text,title:this._strings.truncate((A||a.full_text).replace(r,""),128,"&#x2026;")};b.content="<p class='tweet-text'>"+b.content+"</p>";b.content=feedbro.Strings.linkify(b.content,true,"twitter-tweet-link");b.content=b.content.replace(j,this.hashtagMapper);b.content=b.content.replace(g,this.usernameMapper);if(w&&!y){b.content+=w}if(y){b.content+=y}if(e){h="";D=n[e.user_id_str];v=this.getContent(e);l=e.full_text;l=feedbro.Strings.linkify(l,true,"twitter-tweet-link");l=l.replace(j,this.hashtagMapper);l=l.replace(g,this.usernameMapper);h+="<div class='twitter-quoted-tweet'>";h+="<div class='twitter-quoted-author'>";h+="<img class='twitter-authorimage-quoted' src='"+D.profile_image_url_https+"'>";h+="<span class='twitter-author-name-quoted'>"+D.name+"</span>";h+="<span class='twitter-author-username-quoted'><a target='_blank' class='twitter-username' href='https://twitter.com/"+D.screen_name+"' rel='noopener noreferrer'>@"+D.screen_name+"</a></span>";h+="</div>";h+="<a target='_blank' class='twitter-quote-link' href='https://twitter.com/"+D.screen_name+"/status/"+e.id_str+"' rel='noopener noreferrer'>";h+="<div class='twitter-quoted-content'>"+l+"</div>";h+="</a>";if(v.media&&!v.card){h+=v.media}else{if(v.card){h+=v.card}}h+="</div>";b.content+=h}b.content=p+b.content;if(A){b.content+="</div>"}k.push(b)}}catch(d){}return feedbro.Strings.toRSS(C+" | Twitter",c,k)}else{t+="	<title>No Content Found</title>\n";t+="	<link>"+c.replace(/&/g,"&amp;")+"</link>\n"}t+="</channel>\n</rss>";return t};feedbro.TwPlugin.prototype.getSizeAttribute=function(a){if(a&&a.original_info){return"width='"+a.original_info.width+"' height='"+a.original_info.height+"' "}else{return""}};feedbro.TwPlugin.prototype.getContent=function(l){var f,d,a,h,g,b,m,c,k,i;if(l.extended_entities&&l.extended_entities.media){a=l.extended_entities.media[0];if(a.type=="photo"){k=this.getSizeAttribute(a);d="<div class='twitter-media-photo'><img class='twitter-media-photo' "+k+"src='"+a.media_url_https+"'></div>"}else{if(a.type=="video"&&a.video_info&&a.video_info.variants&&a.video_info.variants.length>0){h=a.video_info.variants;g=h[0];if(g.bitrate==undefined){g.bitrate=0}for(c=1;c<h.length;c++){if(h[c].bitrate>g.bitrate){g=h[c]}}k=this.getSizeAttribute(a);d="<div>";d+='<div class="youtubevideo" data-link="'+g.url+'"><img src="'+a.media_url_https+'" '+k+' class="thumb"><div class="play"></div></div>';d+="</div>"}}}if(l.card&&l.card.binding_values&&l.card.name!="promo_website"){b=l.card.binding_values;f="<div class='twitter-card'>";f+="<a target='_blank' rel='noopener noreferrer' class='twitter-card-url' href='"+l.card.url+"'>";if(b.photo_image_full_size){i=b.photo_image_full_size.image_value;m=i.url}else{if(b.photo_image_full_size_large){i=b.photo_image_full_size_large.image_value;m=i.url}else{if(b.photo_image_full_size_small){i=b.photo_image_full_size_small.image_value;m=i.url}}}if(m){k="width='"+i.width+"' height='"+i.height+"'";f+="<div class='twitter-card-image'><img src='"+m+"' "+k+"></div>"}if(b.title&&b.title.string_value){f+="<div class='twitter-card-title'>"+this._strings.escapeHtml(b.title.string_value)+"</div>"}if(b.description&&b.description.string_value){f+="<div class='twitter-card-description'>"+this._strings.escapeHtml(b.description.string_value)+"</div>"}if(b.domain){f+="<div class='twitter-card-url'>"+b.domain.string_value+"</div>"}f+="</a></div>"}return{card:f,media:d}};feedbro.TwPlugin.prototype.linkMapper=function(b,a){return"<a target='_blank' class='twitter-tweet-link' rel='noopener noreferrer' href='"+b+"'>"+a+"</a>"};feedbro.TwPlugin.prototype.hashtagMapper=function(a,b){return"<a target='_blank' class='twitter-hashtag' rel='noopener noreferrer' href='https://twitter.com/hashtag/"+b+"?src=hashtag_click'>#"+b+"</a>"};feedbro.TwPlugin.prototype.usernameMapper=function(b,a){return"<a target='_blank' class='twitter-username' rel='noopener noreferrer' href='https://twitter.com/"+a+"'>"+b+"</a>"};var feedbro=feedbro||{};feedbro.VkPlugin=function(){};feedbro.VkPlugin.prototype.setDebug=function(a){this._debug=a};feedbro.VkPlugin.prototype.canParse=function(a){return a&&a.indexOf("https://vk.com")==0};feedbro.VkPlugin.prototype.parse=function(e,c,a,f){var b=this;var d=new XMLHttpRequest();d.onerror=function(){a.error={};a.error.message="Network error";a.error.code=398;a.status=398};d.onreadystatechange=function(h){var g=h.target;if(g.readyState==4){g.onreadystatechange=null;if(g.status!=0){g.onerror=null}var j="";if(g.status==200){try{j=b.toRSS(g.responseText,e.url)}catch(i){}}c(e.url,g,j,a,f,true)}};d.open("GET",e.url,true);d.timeout=e.timeout?(e.timeout+0):10000;d.setRequestHeader("Cache-Control","no-cache");d.send()};feedbro.VkPlugin.prototype.toRSS=function(p,g){var u={stag:['<div class="_post_content">'],etag:'<div class="like_cont',postfix:'"></div></div></div>'};var o=new feedbro.Strings();var d=new DOMParser();var B,e,h,D,x,j,q,E,t,A,w;var a="https://vk.com";var c=/(yesterday|today) at (\d{1,2}):(\d{2}) (\w{2})/;var l=/(\d{1,2}) (\w{3}) at (\d{1,2}):(\d{2}) (\w{2})/;var f=/(\d{1,2}) (\w{3}) (\d{4})/;var k=/(onclick|onmouseover)="[^"]+"/g;var z=/(href|src)="\//g;var C=/<a /g;var i={Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11};var n=[];var r="VK";var y=new XMLSerializer();var m;while(true){o.findNext(p,u);if(u.match==undefined){break}m=u.match;m=m.replace(new RegExp(" (src|srcset|rel|onload|preload|autoplay)=","gi")," data-$1=");m=o.switchTags(m,feedbro.ClearBody.tagFlipMap);B=d.parseFromString(m,"text/html");e=B.querySelector("h5.post_author > a.author");t=B.querySelector("div.post_header > a.post_image");E=B.querySelector("div.post_header > a.post_image > img");h=B.querySelector("a.post_link");A=B.querySelector("div.post_date .rel_date");w=A.getAttribute("time");D=A.innerText;x=B.querySelector("div.wall_text");if(t){t=a+t.getAttribute("href")}if(E){E=E.getAttribute("src")}r=e.innerText+" | VK";var b={author:e.innerText,link:a+h.getAttribute("href")};try{b.content=y.serializeToString(x)}catch(v){b.content=x.innerHTML+""}b.content=b.content.replace(new RegExp(" data-(src|srcset|rel|onload|preload|autoplay)=","gi")," $1=");b.content=o.switchTags(b.content,o.reverseMap(feedbro.ClearBody.tagFlipMap));b.content=b.content.replace(k,"");b.content=b.content.replace(C,"<a target='_blank' rel='noopener noreferrer' ");b.content=b.content.replace(z,'$1="'+a+"/");b.content="<div class='vk-content'>"+b.content+"</div>";q=new Date();j=c.exec(D);if(w!=undefined&&w!=""){q.setTime(parseInt(w,10)*1000);q.setSeconds(0);q.setMilliseconds(0);b.publishedDate=q}else{if(j){if(j[1]=="yesterday"){q.setDate(q.getDate()-1)}q.setHours(parseInt(j[2],10));q.setMinutes(parseInt(j[3],10));q.setSeconds(0);q.setMilliseconds(0);b.publishedDate=q}else{j=l.exec(D);if(j){q.setDate(parseInt(j[1],10));q.setMonth(i[j[2]]);q.setHours(parseInt(j[3],10));q.setMinutes(parseInt(j[4],10));q.setSeconds(0);q.setMilliseconds(0);if(j[5]=="pm"){q.setHours(q.getHours()+12)}b.publishedDate=q}else{j=f.exec(D);if(j){q.setDate(parseInt(j[1],10));q.setMonth(i[j[2]]);q.setFullYear(parseInt(j[3],10));q.setHours(0);q.setMinutes(0);q.setSeconds(0);q.setMilliseconds(0);b.publishedDate=q}}}}n.push(b)}d=null;y=null;return feedbro.Strings.toRSS(r,g,n)};var feedbro=feedbro||{};feedbro.XmlDocumentWrapper=function(){};feedbro.XmlDocumentWrapper.prototype.trash=function(){this.xmldoc=null;this.domParser=null;this.nsResolver=null;this.nsReverseResolver=null};feedbro.XmlDocumentWrapper.prototype.createNSResolvers=function(){var b=this.getRootNode();var a=b.attributes;var d,e=a.length,f,c;this.nsResolver={};this.nsReverseResolver={};for(d=0;d<e;d++){if(a[d].name.indexOf("xmlns")==0){c=a[d].nodeValue+"";f=a[d].name.substring(6);this.nsResolver[f]=c;this.nsReverseResolver[c]=f}}};feedbro.XmlDocumentWrapper.reverseResolver={"http://www.w3.org/2005/Atom":"atom","http://purl.org/dc/elements/1.1/":"dc","http://purl.org/rss/1.0/modules/content/":"content","http://www.w3.org/1998/Math/MathML":"mathml","http://search.yahoo.com/mrss/":"media","http://www.w3.org/1999/02/22-rdf-syntax-ns#":"rdf","http://webns.net/mvcb/":"admin","http://purl.org/rss/1.0/":"rss10","http://purl.oclc.org/net/rss_2.0/enc#":"enc","http://prismstandard.org/namespaces/basic/2.0/":"prism","http://www.w3.org/1999/xhtml":"xhtml","http://purl.org/atom/ns#":"atom03","http://www.youtube.com/xml/schemas/2015":"yt","http://my.netscape.com/rdf/simple/0.9/":"rss09"};feedbro.XmlDocumentWrapper.prototype.translateNodeName=function(d){var b=d.indexOf(":");var c="";if(b!=0){c=d.substring(0,b)}var a=this.nsReverseResolver[this.standardNSResolver(c)];return a!=undefined?a+(a.length>0?":":"")+d.substring(b+1):d};feedbro.XmlDocumentWrapper.prototype.mapNodeName=function(d){var b=d.indexOf(":");var c="";if(b!=0){c=d.substring(0,b)}var a=feedbro.XmlDocumentWrapper.reverseResolver[this.nsResolver[c]];return a?a+":"+d.substring(b+1):d};feedbro.XmlDocumentWrapper.prototype.parse=function(a){if(this.domParser==undefined){this.domParser=new DOMParser()}this.setDocument(this.domParser.parseFromString(a,"text/xml"));var b=this.xmldoc.getElementsByTagName("parsererror");if(b&&b.length>0){throw b[0].innerText+""}return this.xmldoc};feedbro.XmlDocumentWrapper.prototype.setDocument=function(a){this.xmldoc=a;this.createNSResolvers()};feedbro.XmlDocumentWrapper.prototype.standardNSResolver=function(a){switch(a){case"atom":return"http://www.w3.org/2005/Atom";case"atom03":return"http://purl.org/atom/ns#";case"dc":return"http://purl.org/dc/elements/1.1/";case"content":return"http://purl.org/rss/1.0/modules/content/";case"mathml":return"http://www.w3.org/1998/Math/MathML";case"media":return"http://search.yahoo.com/mrss/";case"rdf":return"http://www.w3.org/1999/02/22-rdf-syntax-ns#";case"admin":return"http://webns.net/mvcb/";case"rss10":return"http://purl.org/rss/1.0/";case"rss09":return"http://my.netscape.com/rdf/simple/0.9/";case"enc":return"http://purl.oclc.org/net/rss_2.0/enc#";case"prism":return"http://prismstandard.org/namespaces/basic/2.0/";case"xhtml":return"http://www.w3.org/1999/xhtml";case"yt":return"http://www.youtube.com/xml/schemas/2015";default:return null}};feedbro.XmlDocumentWrapper.prototype.getRootNode=function(){return this.xmldoc.documentElement};feedbro.XmlDocumentWrapper.prototype.getNode=function(c,b){var a;try{a=this.xmldoc.evaluate(c,b?b:this.xmldoc,this.standardNSResolver,XPathResult.FIRST_ORDERED_NODE_TYPE,null)}catch(d){}return a?a.singleNodeValue:undefined};feedbro.XmlDocumentWrapper.prototype.getNodeListIterator=function(b,a){try{return this.xmldoc.evaluate(b,a?a:this.xmldoc,this.standardNSResolver,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null)}catch(c){return undefined}};feedbro.XmlDocumentWrapper.prototype.getAttribute=function(b,a,c){var d=this.getNode(b,a);if(!d){return undefined}return d.getAttribute(c)};feedbro.XmlDocumentWrapper.prototype.getString=function(c,b){var a;try{a=this.xmldoc.evaluate(c,b?b:this.xmldoc,this.standardNSResolver,XPathResult.STRING_TYPE,null)}catch(d){}if(a){return a.stringValue}else{return undefined}};feedbro.XmlDocumentWrapper.prototype.getChildString=function(c,a){var b=this.getChild(c,a);return b?(b.textContent+""):undefined};feedbro.XmlDocumentWrapper.prototype.getChild=function(d,a){if(d.indexOf("/")==-1){return this.getChildSingle(d,a)}else{var c,b=d.split("/");for(c=0;c<b.length;c++){a=this.getChildSingle(b[c],a);if(a==undefined){return undefined}}return a}};feedbro.XmlDocumentWrapper.prototype.getChildSingle=function(d,a){if(a==undefined){a=this.xmldoc}var c=a.firstElementChild;var b=this.translateNodeName(d);while(c!=undefined){if(c.nodeName==b){return c}c=c.nextElementSibling}return undefined};feedbro.XmlDocumentWrapper.prototype.getAll=function(e,a){if(a==undefined){a=this.xmldoc}var d=a.firstElementChild,b=[];var c=this.translateNodeName(e);while(d!=undefined){if(d.nodeName==c){b.push(d)}d=d.nextElementSibling}return b};var feedbro=feedbro||{};feedbro.YammerPlugin=function(){this._strings=new feedbro.Strings()};feedbro.YammerPlugin.prototype.canParse=function(a){return a&&a.indexOf("https://www.yammer.com/")==0};feedbro.YammerPlugin.prototype.parse=function(f,d,a,g){var b=this;var e=new XMLHttpRequest();var c=this.getURL(f.url,20);e.onerror=function(){a.error={};a.error.message="Network error";a.error.code=398;a.status=398};e.onreadystatechange=function(i){var h=i.target;if(h.readyState==4){h.onreadystatechange=null;if(h.status!=0){h.onerror=null}var k="";if(h.status==200){try{k=b.toRSS(h.responseText,f.datelimit,f.url)}catch(j){}}d(f.url,h,k,a,g,true)}};e.withCredentials=true;e.open("GET",c,true);e.timeout=f.timeout?(f.timeout+0):30000;e.send()};feedbro.YammerPlugin.prototype.toRSS=function(e,c,b){var d=JSON.parse(e);var a=this.processJson(d);return feedbro.Strings.toRSS((d.meta?d.meta.feed_name:"Group")+" | Yammer",b,a)};feedbro.YammerPlugin.prototype.getURL=function(c,e){var b,a,d;c=(c||"");if(!a&&c.includes("?type=following")){a="messages/following"}if(!a&&c.includes("?type=my_all")){a="messages/my_feed"}if(!a&&c.includes("?type=algo")){a="messages/algo"}b=c.match(/feedId=(\d+)/);if(!a&&b&&c.includes("/inGroup")){d=b[1];a="messages/in_group/"+d}if(!a&&b&&c.includes("/AboutTopic")){d=b[1];a="messages/about_topic/"+d}if(!a&&c.includes("/home")){a="messages/my_feed"}if(a==null){return null}return"https://www.yammer.com/api/v1/"+a+".json?threaded=true&limit="+e};feedbro.YammerPlugin.prototype.processJson=function(m){var f,e,b,a,c=m.messages,l,d,g=[],k={},h;if(m.references){for(f=0;f<m.references.length;f++){b=m.references[f];k[b.id]=b}}if(c==undefined){return g}for(f=0;f<c.length;f++){a=c[f];d=k[a.sender_id];l={link:a.web_url,publishedDate:new Date(a.created_at),author:d?d.full_name:"",title:a.body?a.body.plain:"",content:this.getPostHeader(d)};if(a.body&&a.body.rich!=""){l.content+="<div class='yammer-update'>"+(a.body?a.body.rich:"")+"</div>"}if(a.attachments&&a.attachments.length>0){for(e=0;e<a.attachments.length;e++){h=a.attachments[e];if(h.message_type=="update"){l.content+="<div class='yammer-shared-update'>"+this.getPostHeader(k[h.sender_id])+"<div class='yammer-shared-content'>"+(h.body?h.body.rich:"")+"</div></div>";l.title=h.body?h.body.plain:""}else{if(h.content_class=="Image"){l.content+="<div class='yammer-attachment-image'><a target='_blank' rel='noreferrer noopener' href='"+h.download_url+"'><img src='"+h.image.url+"'></a></div>"}else{if(h.content_class=="Video"){l.content+="<div class='yammer-attachment-video'><a target='_blank' rel='noopener noreferrer' href='"+h.web_url+"'><img class='yammer-attachment-video-thumbnail' src='"+h.thumbnail_url+"'></a></div>"}else{if(h.object_type=="page"){l.content+="<div class='yammer-attachment-page'>"+h.inline_html+"</div>"}}}}}}this._strings.stripTags(l.title);if(l.title.length>128){l.title=l.title.substring(0,128)+"..."}g.push(l)}g.sort(function(j,i){return i.publishedDate.getTime()-j.publishedDate.getTime()});return g};feedbro.YammerPlugin.prototype.getPostHeader=function(c){var a="";var b="";if(c){a="<img class='yammer-mugshot-img' src='"+this.escapeHtml(c.mugshot_url)+"'>";b=c.full_name;if(c.job_title){b=b+"<span class='yammer-jobtitle'>, "+c.job_title+"</span>"}}return"<div class='yammer-mugshot'>"+a+"</div><div class='yammer-author'>"+this.escapeHtml(b)+"</div>"};feedbro.YammerPlugin.prototype.escapeHtml=function(a){return a?String(a).replace(/[&<>"'`]/g,function(b){return"&#"+b.charCodeAt(0)+";"}):a};var feedbro=feedbro||{};feedbro.YoPlugin=function(){this._strings=new feedbro.Strings()};feedbro.YoPlugin.prototype.canParse=function(a){return a&&a.indexOf("https://www.youtube.com/results?")==0};feedbro.YoPlugin.prototype.parse=function(e,c,a,f){var b=this;var d=new XMLHttpRequest();d.onerror=function(){a.error={};a.error.message="Network error";a.error.code=398;a.status=398};d.onreadystatechange=function(h){var g=h.target;if(g.readyState==4){g.onreadystatechange=null;if(g.status!=0){g.onerror=null}var j="";if(g.status==200){try{j=b.toRSS(g.responseText,e.url)}catch(i){}}c(e.url,g,j,a,f,true)}};d.open("GET",e.url,true);d.timeout=20000;d.send()};feedbro.YoPlugin.prototype.toRSS=function(g,d){var m;m={stag:['"PQ"','"'],etag:'"'};this._strings.findNext(g,m);var l="YouTube Search | "+(m.match?m.match:"");var h=[];var q='<?xml version="1.0" encoding="UTF-8"?>\n<feed xmlns:yt="http://www.youtube.com/xml/schemas/2015" xmlns:media="http://search.yahoo.com/mrss/" xmlns="http://www.w3.org/2005/Atom">\n';q+="	<title><![CDATA["+l+"]]></title>\n";q+="	<link>"+d.replace(/&/g,"&#038;")+"</link>\n";q+="	<description><![CDATA["+l+"]]></description>\n";m={stag:['"videoRenderer"','"videoId"','"'],etag:'"'};var c={stag:['"thumbnails"','"url"','"'],etag:'"'};var f={stag:['"title"','"text"','"'],etag:'"}'};var r={stag:['"ownerText"','"text"','"'],etag:'"'};var n=/\\u(\d{4})/g;var k=/\\"/g;while(true){this._strings.findNext(g,m);if(m.match==undefined){break}var e="";var o="";var a={};var j=m.match;a.link="https://youtube.com/watch?v="+j;c.spos=m.spos;this._strings.findNext(g,c);if(c.match){e=c.match.replace("\\u0026","&#038;")}f.spos=c.spos;this._strings.findNext(g,f);if(f.match){a.title=f.match.replace(n,function(t,i){return"&#x"+parseInt(i,10)+";"});a.title=a.title.replace(k,'"')}r.spos=f.spos;this._strings.findNext(g,r);if(r.match){a.author=r.match}var b="";b+="<entry>\n";b+="<title><![CDATA["+a.title+"]]></title>\n";b+="<yt:videoId>"+j+"</yt:videoId>\n";b+='<link type="text/html" rel="alternate" href="'+a.link+'"/>\n';b+="<author><name><![CDATA["+(a.author||"")+"]]></name></author>\n";b+="<media:group>\n";b+='<media:thumbnail url="'+e+'"/>\n';b+="<media:description><![CDATA["+o+"]]></media:description>\n";b+="</media:group>\n";b+="</entry>\n";var s={};s.element=b;h.push(s)}for(var p=0;p<h.length;p++){q+=h[p].element}q+="</feed>";return q};var feedbro=feedbro||{};feedbro.Youtube=function(){};feedbro.Youtube.process=function(){$("div.youtubevideo:not([data-processed])").each(function(a,b){b.setAttribute("data-processed","true");b.onclick=function(){var d=document.createElement("div");d.setAttribute("class","youtubevideocontainer");var c=document.createElement("iframe");c.setAttribute("class","youtubevideoiframe");var e=this.getAttribute("data-link");if(e&&e!=""){c.setAttribute("src",e)}else{c.setAttribute("src","https://www.youtube.com/embed/"+this.id+"?autoplay=1&autohide=1")}c.setAttribute("allowfullscreen","true");c.setAttribute("frameborder","0");d.appendChild(c);this.parentNode.replaceChild(d,this)}})};